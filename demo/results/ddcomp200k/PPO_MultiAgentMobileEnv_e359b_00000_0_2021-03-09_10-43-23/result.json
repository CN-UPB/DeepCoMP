{"episode_reward_max": 53.98871496273538, "episode_reward_min": 6.699681695561878, "episode_reward_mean": 34.15556027944344, "episode_len_mean": 100.0, "episodes_this_iter": 40, "policy_reward_min": {"ue": 0.09857088442945283}, "policy_reward_max": {"ue": 36.10110724556147}, "policy_reward_mean": {"ue": 17.07778013972171}, "custom_metrics": {"sum_utility_mean": 1.3528601172476435, "sum_utility_min": -40.0, "sum_utility_max": 21.310345226162607, "eps_sum_utility_mean": 107.68633864861931, "eps_sum_utility_min": -393.99271890190164, "eps_sum_utility_max": 418.38341683913364}, "hist_stats": {"episode_reward": [28.416892038798736, 43.443805383609245, 26.60886304395755, 32.370523230491145, 31.80789310102805, 51.8780796978287, 32.36345992021354, 42.74589915712833, 36.67402592754516, 26.020817329781934, 39.08549908681423, 14.757673867066181, 42.6142369950102, 42.766681532759314, 50.04277971641642, 30.930141432418754, 10.012235833690271, 45.23860849336731, 29.539230706339445, 51.32692098197032, 53.98871496273538, 30.776785099203572, 31.418457305579132, 38.1818036507139, 23.83465971659927, 32.58876758448244, 21.285991723475746, 23.00582044632351, 41.235106502323454, 16.071596812302452, 48.46662938940029, 40.28533595701594, 36.36751776539175, 22.184110235369253, 44.02139812540842, 38.54265771391025, 39.69113886043445, 6.699681695561878, 31.84090674823753, 37.091063407034284], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_ue_reward": [17.938694344896838, 10.478197693901905, 22.758139160080667, 20.685666223528546, 15.08346102915094, 11.525402014806613, 8.146056693451701, 24.224466537039433, 19.823853942491674, 11.984039158536376, 17.07478173489842, 34.8032979629302, 18.611853095673062, 13.751606824540483, 30.788497367416195, 11.95740178971206, 16.08084939203418, 20.59317653551097, 14.543167295545025, 11.4776500342369, 16.92687370579742, 22.15862538101672, 8.2722950740085, 6.485378793057691, 19.017711622882377, 23.5965253721278, 36.10110724556147, 6.665574287197824, 26.071263762279465, 23.971515954136933, 10.794483511556956, 20.135657920861746, 9.666974050139144, 0.34526178355112946, 25.020090443802406, 20.21851804956482, 18.43536509485062, 11.103865611488805, 29.426952119366902, 21.899968862603327, 33.30531999910571, 20.6833949636296, 17.02279943139355, 13.753985667810028, 16.094371492671495, 15.324085812907631, 18.177837817792405, 20.003965832921427, 12.458888461777429, 11.375771254821846, 19.87212271857964, 12.716644865902783, 4.453287462226629, 16.832704261249123, 16.599770344359037, 6.406050101964475, 20.998789726606823, 20.236316775716617, 10.837426945804234, 5.2341698664982195, 20.045612216630545, 28.42101717276973, 18.834730059703105, 21.450605897312762, 12.60010767047897, 23.767410094912783, 6.728331008930061, 15.455779226439189, 22.460340486402604, 21.561057639005647, 18.9584973297634, 19.584160384146855, 21.56798712735148, 18.123151733082985, 6.601110811132432, 0.09857088442945283, 8.843111541053677, 22.997795207183852, 10.803458806262709, 26.287604600771566]}, "sampler_perf": {"mean_env_wait_ms": 13.087511181238279, "mean_raw_obs_processing_ms": 0.6008319000699627, "mean_inference_ms": 9.016938707721767, "mean_action_processing_ms": 0.11920982332371952}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 4000, "timers": {"sample_time_ms": 5088.25, "sample_throughput": 786.125, "load_time_ms": 203.52, "load_throughput": 19654.128, "learn_time_ms": 10542.911, "learn_throughput": 379.402, "update_time_ms": 9.826}, "info": {"learner": {"ue": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 28.202716827392578, "policy_loss": -0.029508480802178383, "vf_loss": 28.2272891998291, "vf_explained_var": 0.0004390420508570969, "kl": 0.024693580344319344, "entropy": 1.0749188661575317, "entropy_coeff": 0.0, "model": {}}}, "num_steps_sampled": 4000, "num_steps_trained": 4000}, "done": false, "episodes_total": 40, "training_iteration": 1, "experiment_id": "f0134eced79d425ca17ebe3d2d0a9c1b", "date": "2021-03-09_10-44-01", "timestamp": 1615283041, "time_this_iter_s": 16.371222734451294, "time_total_s": 16.371222734451294, "pid": 4108, "hostname": "ray02", "node_ip": "131.234.28.177", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "env_config": {"episode_length": 100, "seed": null, "map": "150x100map", "bs_list": ["A", "B"], "ue_list": ["1", "2"], "rand_episodes": false, "new_ue_interval": null, "reward": "sum", "log_metrics": true}, "env": "MultiAgentMobileEnv", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": true, "log_level": "WARN", "callbacks": "<class 'deepcomp.util.callbacks.CustomMetricCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"ue": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Dict(connected:MultiBinary(2), dr:Box(0.0, 1.0, (2,), float32), ues_at_bs:Box(0.0, 1.0, (2,), float32), utility:Box(-1.0, 1.0, (1,), float32))", "Discrete(3)", {}]}, "policy_mapping_fn": "<function create_env_config.<locals>.<lambda> at 0x7f6bbc4d0f70>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 16.371222734451294, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 20.065217391304344, "ram_util_percent": 4.765217391304347}, "trial_id": "e359b_00000"}
{"episode_reward_max": 101.04828230887479, "episode_reward_min": 6.699681695561878, "episode_reward_mean": 54.853020953798634, "episode_len_mean": 100.0, "episodes_this_iter": 40, "policy_reward_min": {"ue": 0.09857088442945283}, "policy_reward_max": {"ue": 52.475774105496065}, "policy_reward_mean": {"ue": 27.426510476899303}, "custom_metrics": {"sum_utility_mean": 4.405830692083875, "sum_utility_min": -40.0, "sum_utility_max": 21.310345226162607, "eps_sum_utility_mean": 389.0748239965522, "eps_sum_utility_min": -393.99271890190164, "eps_sum_utility_max": 1026.3056028889541}, "hist_stats": {"episode_reward": [77.98941643730222, 67.29028950450281, 79.35651438253653, 55.79017168975433, 98.24571178201373, 101.04828230887479, 69.77645598441325, 60.8322825905555, 92.98490870016903, 73.60877107766946, 79.9584187280619, 65.32928211295557, 67.83966062083591, 87.29690798564826, 65.99968472149084, 94.31989142820132, 70.807136743331, 84.48241890248552, 79.96888590991475, 63.15936431661022, 80.5898626321456, 82.51386961851509, 87.14535377775941, 69.65771928118028, 71.28130199874792, 70.94651087650897, 69.98766812469864, 65.33712862322565, 75.28390297177165, 87.42604027013311, 78.68240255384876, 68.54179925848693, 49.206941106545884, 74.27903981214664, 97.97566990721037, 80.89586746518503, 67.02921064018302, 52.429996455482026, 76.96224862021884, 79.76227520483224, 28.416892038798736, 43.443805383609245, 26.60886304395755, 32.370523230491145, 31.80789310102805, 51.8780796978287, 32.36345992021354, 42.74589915712833, 36.67402592754516, 26.020817329781934, 39.08549908681423, 14.757673867066181, 42.6142369950102, 42.766681532759314, 50.04277971641642, 30.930141432418754, 10.012235833690271, 45.23860849336731, 29.539230706339445, 51.32692098197032, 53.98871496273538, 30.776785099203572, 31.418457305579132, 38.1818036507139, 23.83465971659927, 32.58876758448244, 21.285991723475746, 23.00582044632351, 41.235106502323454, 16.071596812302452, 48.46662938940029, 40.28533595701594, 36.36751776539175, 22.184110235369253, 44.02139812540842, 38.54265771391025, 39.69113886043445, 6.699681695561878, 31.84090674823753, 37.091063407034284], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_ue_reward": [49.21194069257162, 28.777475744730598, 41.10372306076157, 26.186566443741164, 49.36756849750621, 29.988945885030347, 29.105281876981103, 26.6848898127732, 45.769937676517664, 52.475774105496065, 49.82616678736375, 51.22211552151108, 29.01135111988703, 40.76510486452611, 31.407341322453988, 29.424941268101435, 45.28225831798056, 47.70265038218846, 39.8014978518895, 33.80727322577998, 44.09850689384719, 35.85991183421475, 35.22184301719242, 30.10743909576309, 33.82208842371704, 34.017572197118795, 39.089246110667794, 48.20766187498044, 29.793608838493654, 36.20607588299707, 43.87933881230165, 50.44055261589963, 36.38503732748336, 34.42209941584757, 32.61057202189981, 51.87184688058567, 40.58076907089335, 39.38811683902145, 31.872907818407683, 31.286456498202455, 41.755378634036624, 38.8344839981089, 42.760356501464145, 39.75351311705101, 43.76816066228143, 43.37719311547794, 28.16599758585444, 41.49172169532578, 35.793160398532976, 35.4881416002149, 37.10375595560942, 33.84275492089954, 28.77088235995369, 41.21678576474484, 35.23549734368584, 30.101631279539742, 37.90974657197776, 37.374156399793875, 44.50873638884107, 42.917303881292014, 36.24634707716872, 42.436055476679975, 40.9337616839791, 27.608037574507755, 27.287751339135916, 21.919189767409872, 35.293929748227455, 38.98511006391905, 51.40432065337621, 46.57134925383406, 38.47135838516156, 42.424509080023526, 30.771650657333442, 36.257559982849486, 28.856304639361298, 23.573691816120654, 47.218303598976966, 29.743945021241878, 39.68174746457753, 40.080527740254674, 17.938694344896838, 10.478197693901905, 22.758139160080667, 20.685666223528546, 15.08346102915094, 11.525402014806613, 8.146056693451701, 24.224466537039433, 19.823853942491674, 11.984039158536376, 17.07478173489842, 34.8032979629302, 18.611853095673062, 13.751606824540483, 30.788497367416195, 11.95740178971206, 16.08084939203418, 20.59317653551097, 14.543167295545025, 11.4776500342369, 16.92687370579742, 22.15862538101672, 8.2722950740085, 6.485378793057691, 19.017711622882377, 23.5965253721278, 36.10110724556147, 6.665574287197824, 26.071263762279465, 23.971515954136933, 10.794483511556956, 20.135657920861746, 9.666974050139144, 0.34526178355112946, 25.020090443802406, 20.21851804956482, 18.43536509485062, 11.103865611488805, 29.426952119366902, 21.899968862603327, 33.30531999910571, 20.6833949636296, 17.02279943139355, 13.753985667810028, 16.094371492671495, 15.324085812907631, 18.177837817792405, 20.003965832921427, 12.458888461777429, 11.375771254821846, 19.87212271857964, 12.716644865902783, 4.453287462226629, 16.832704261249123, 16.599770344359037, 6.406050101964475, 20.998789726606823, 20.236316775716617, 10.837426945804234, 5.2341698664982195, 20.045612216630545, 28.42101717276973, 18.834730059703105, 21.450605897312762, 12.60010767047897, 23.767410094912783, 6.728331008930061, 15.455779226439189, 22.460340486402604, 21.561057639005647, 18.9584973297634, 19.584160384146855, 21.56798712735148, 18.123151733082985, 6.601110811132432, 0.09857088442945283, 8.843111541053677, 22.997795207183852, 10.803458806262709, 26.287604600771566]}, "sampler_perf": {"mean_env_wait_ms": 13.04555773125696, "mean_raw_obs_processing_ms": 0.6420777261281575, "mean_inference_ms": 8.565883867731845, "mean_action_processing_ms": 0.13528870458947573}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 8000, "timers": {"sample_time_ms": 4750.349, "sample_throughput": 842.043, "load_time_ms": 103.303, "load_throughput": 38721.016, "learn_time_ms": 8890.889, "learn_throughput": 449.899, "update_time_ms": 10.086}, "info": {"learner": {"ue": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 4.999999873689376e-05, "total_loss": 63.84706115722656, "policy_loss": -0.014041692018508911, "vf_loss": 63.85725021362305, "vf_explained_var": -0.00012508418876677752, "kl": 0.01283989753574133, "entropy": 1.0348941087722778, "entropy_coeff": 0.0, "model": {}}}, "num_steps_sampled": 8000, "num_steps_trained": 8000}, "done": false, "episodes_total": 80, "training_iteration": 2, "experiment_id": "f0134eced79d425ca17ebe3d2d0a9c1b", "date": "2021-03-09_10-44-14", "timestamp": 1615283054, "time_this_iter_s": 12.044577836990356, "time_total_s": 28.41580057144165, "pid": 4108, "hostname": "ray02", "node_ip": "131.234.28.177", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "env_config": {"episode_length": 100, "seed": null, "map": "150x100map", "bs_list": ["A", "B"], "ue_list": ["1", "2"], "rand_episodes": false, "new_ue_interval": null, "reward": "sum", "log_metrics": true}, "env": "MultiAgentMobileEnv", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": true, "log_level": "WARN", "callbacks": "<class 'deepcomp.util.callbacks.CustomMetricCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"ue": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Dict(connected:MultiBinary(2), dr:Box(0.0, 1.0, (2,), float32), ues_at_bs:Box(0.0, 1.0, (2,), float32), utility:Box(-1.0, 1.0, (1,), float32))", "Discrete(3)", {}]}, "policy_mapping_fn": "<function create_env_config.<locals>.<lambda> at 0x7f6a94b53670>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 28.41580057144165, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 24.23125, "ram_util_percent": 4.8}, "trial_id": "e359b_00000"}
{"episode_reward_max": 113.6067063159876, "episode_reward_min": 6.699681695561878, "episode_reward_mean": 75.20037408611901, "episode_len_mean": 100.0, "episodes_this_iter": 40, "policy_reward_min": {"ue": 0.09857088442945283}, "policy_reward_max": {"ue": 60.11329699824025}, "policy_reward_mean": {"ue": 37.60018704305949}, "custom_metrics": {"sum_utility_mean": 8.80377175651053, "sum_utility_min": -40.0, "sum_utility_max": 21.310345226162607, "eps_sum_utility_mean": 658.8725043235636, "eps_sum_utility_min": -393.99271890190164, "eps_sum_utility_max": 1184.400994478821}, "hist_stats": {"episode_reward": [97.83007017479827, 104.57820696740629, 98.23897960757456, 99.20992446771459, 93.24240449494548, 77.29820169686619, 103.68179337416214, 92.9157594337222, 105.52820256081944, 102.50835109545835, 101.88129969256396, 70.73387895847645, 105.94968458233032, 90.92644730282203, 91.9020192437286, 113.6067063159876, 96.89973542413347, 104.57438801390089, 93.96164923444238, 95.36805655350287, 99.35711484672575, 97.35285544867807, 104.28413299714222, 105.46978863880807, 89.52465984088371, 97.20958856815813, 84.72400105518062, 98.06176652522404, 98.43216040335288, 78.31318009545714, 87.07584529584965, 106.44700833365222, 84.75337963840023, 90.07527523174761, 100.67326705075776, 101.71311179565643, 102.20851605777423, 97.02862948739507, 85.9621884467054, 90.93777083133973, 53.98871496273538, 30.776785099203572, 31.418457305579132, 38.1818036507139, 23.83465971659927, 32.58876758448244, 21.285991723475746, 23.00582044632351, 41.235106502323454, 16.071596812302452, 48.46662938940029, 40.28533595701594, 36.36751776539175, 22.184110235369253, 44.02139812540842, 38.54265771391025, 39.69113886043445, 6.699681695561878, 31.84090674823753, 37.091063407034284, 77.98941643730222, 67.29028950450281, 79.35651438253653, 55.79017168975433, 98.24571178201373, 101.04828230887479, 69.77645598441325, 60.8322825905555, 92.98490870016903, 73.60877107766946, 79.9584187280619, 65.32928211295557, 67.83966062083591, 87.29690798564826, 65.99968472149084, 94.31989142820132, 70.807136743331, 84.48241890248552, 79.96888590991475, 63.15936431661022, 80.5898626321456, 82.51386961851509, 87.14535377775941, 69.65771928118028, 71.28130199874792, 70.94651087650897, 69.98766812469864, 65.33712862322565, 75.28390297177165, 87.42604027013311, 78.68240255384876, 68.54179925848693, 49.206941106545884, 74.27903981214664, 97.97566990721037, 80.89586746518503, 67.02921064018302, 52.429996455482026, 76.96224862021884, 79.76227520483224], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_ue_reward": [48.81729320069824, 49.012776974099985, 50.69767097615416, 53.88053599125228, 50.96507996163306, 47.27389964594146, 45.65571790343213, 53.55420656428244, 51.46390471837332, 41.77849977657222, 31.820091958743134, 45.478109738122996, 50.02073710324596, 53.66105627091621, 47.097180207039756, 45.8185792266824, 51.47186286425716, 54.05633969656224, 55.656967666289624, 46.85138342916872, 52.75690306568025, 49.12439662688366, 39.18910498451499, 31.544773973961384, 53.16059499320847, 52.78908958912176, 44.62843938783058, 46.2980079149914, 54.71361948474254, 37.188399758986094, 60.11329699824025, 53.49340931774729, 58.52432185818659, 38.37541356594685, 54.42991618933568, 50.1444718245652, 49.09420986115891, 44.86743937328342, 48.577486417226815, 46.790570136275996, 49.678557423362875, 49.67855742336286, 42.29706025834759, 55.05579519033047, 53.29358865378012, 50.99054434336217, 52.73489431940401, 52.73489431940402, 39.43674272295852, 50.08791711792522, 51.9147381243256, 45.29485044383264, 45.47255422999822, 39.25144682518239, 54.839355186678205, 43.22241133854589, 46.18963095017416, 52.24252945317867, 48.03654766439671, 30.2766324310603, 39.803767957990516, 47.27207733785912, 55.767068691745585, 50.67993964190668, 48.68374597250137, 36.06963366589886, 51.671162732161974, 38.40411249958563, 56.07279413675484, 44.60047291400291, 53.37078348430022, 48.34232831135631, 44.47073291259893, 57.73778314517529, 50.87212656657357, 46.156502920821396, 40.453229201085506, 45.50895924561984, 46.845228282728065, 44.09254254861165, 33.30531999910571, 20.6833949636296, 17.02279943139355, 13.753985667810028, 16.094371492671495, 15.324085812907631, 18.177837817792405, 20.003965832921427, 12.458888461777429, 11.375771254821846, 19.87212271857964, 12.716644865902783, 4.453287462226629, 16.832704261249123, 16.599770344359037, 6.406050101964475, 20.998789726606823, 20.236316775716617, 10.837426945804234, 5.2341698664982195, 20.045612216630545, 28.42101717276973, 18.834730059703105, 21.450605897312762, 12.60010767047897, 23.767410094912783, 6.728331008930061, 15.455779226439189, 22.460340486402604, 21.561057639005647, 18.9584973297634, 19.584160384146855, 21.56798712735148, 18.123151733082985, 6.601110811132432, 0.09857088442945283, 8.843111541053677, 22.997795207183852, 10.803458806262709, 26.287604600771566, 49.21194069257162, 28.777475744730598, 41.10372306076157, 26.186566443741164, 49.36756849750621, 29.988945885030347, 29.105281876981103, 26.6848898127732, 45.769937676517664, 52.475774105496065, 49.82616678736375, 51.22211552151108, 29.01135111988703, 40.76510486452611, 31.407341322453988, 29.424941268101435, 45.28225831798056, 47.70265038218846, 39.8014978518895, 33.80727322577998, 44.09850689384719, 35.85991183421475, 35.22184301719242, 30.10743909576309, 33.82208842371704, 34.017572197118795, 39.089246110667794, 48.20766187498044, 29.793608838493654, 36.20607588299707, 43.87933881230165, 50.44055261589963, 36.38503732748336, 34.42209941584757, 32.61057202189981, 51.87184688058567, 40.58076907089335, 39.38811683902145, 31.872907818407683, 31.286456498202455, 41.755378634036624, 38.8344839981089, 42.760356501464145, 39.75351311705101, 43.76816066228143, 43.37719311547794, 28.16599758585444, 41.49172169532578, 35.793160398532976, 35.4881416002149, 37.10375595560942, 33.84275492089954, 28.77088235995369, 41.21678576474484, 35.23549734368584, 30.101631279539742, 37.90974657197776, 37.374156399793875, 44.50873638884107, 42.917303881292014, 36.24634707716872, 42.436055476679975, 40.9337616839791, 27.608037574507755, 27.287751339135916, 21.919189767409872, 35.293929748227455, 38.98511006391905, 51.40432065337621, 46.57134925383406, 38.47135838516156, 42.424509080023526, 30.771650657333442, 36.257559982849486, 28.856304639361298, 23.573691816120654, 47.218303598976966, 29.743945021241878, 39.68174746457753, 40.080527740254674]}, "sampler_perf": {"mean_env_wait_ms": 12.623933747987557, "mean_raw_obs_processing_ms": 0.5832975338649073, "mean_inference_ms": 8.051499407137163, "mean_action_processing_ms": 0.1413174714047335}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 12000, "timers": {"sample_time_ms": 4329.169, "sample_throughput": 923.965, "load_time_ms": 69.916, "load_throughput": 57211.438, "learn_time_ms": 8327.64, "learn_throughput": 480.328, "update_time_ms": 10.039}, "info": {"learner": {"ue": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 4.999999873689376e-05, "total_loss": 87.58868408203125, "policy_loss": -0.01099385879933834, "vf_loss": 87.59586334228516, "vf_explained_var": 0.0023991772904992104, "kl": 0.012738265097141266, "entropy": 0.9847350120544434, "entropy_coeff": 0.0, "model": {}}}, "num_steps_sampled": 12000, "num_steps_trained": 12000}, "done": false, "episodes_total": 120, "training_iteration": 3, "experiment_id": "f0134eced79d425ca17ebe3d2d0a9c1b", "date": "2021-03-09_10-44-25", "timestamp": 1615283065, "time_this_iter_s": 10.974609136581421, "time_total_s": 39.39040970802307, "pid": 4108, "hostname": "ray02", "node_ip": "131.234.28.177", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "env_config": {"episode_length": 100, "seed": null, "map": "150x100map", "bs_list": ["A", "B"], "ue_list": ["1", "2"], "rand_episodes": false, "new_ue_interval": null, "reward": "sum", "log_metrics": true}, "env": "MultiAgentMobileEnv", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": true, "log_level": "WARN", "callbacks": "<class 'deepcomp.util.callbacks.CustomMetricCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"ue": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Dict(connected:MultiBinary(2), dr:Box(0.0, 1.0, (2,), float32), ues_at_bs:Box(0.0, 1.0, (2,), float32), utility:Box(-1.0, 1.0, (1,), float32))", "Discrete(3)", {}]}, "policy_mapping_fn": "<function create_env_config.<locals>.<lambda> at 0x7f6bbc4d05e0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 39.39040970802307, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 24.206666666666667, "ram_util_percent": 4.799999999999999}, "trial_id": "e359b_00000"}
{"episode_reward_max": 132.09488854863815, "episode_reward_min": 49.206941106545884, "episode_reward_mean": 98.3529868193586, "episode_len_mean": 100.0, "episodes_this_iter": 40, "policy_reward_min": {"ue": 21.919189767409872}, "policy_reward_max": {"ue": 67.13695943066051}, "policy_reward_mean": {"ue": 49.1764934096793}, "custom_metrics": {"sum_utility_mean": 9.648885925551397, "sum_utility_min": -40.0, "sum_utility_max": 21.310345226162607, "eps_sum_utility_mean": 955.567566624815, "eps_sum_utility_min": 321.4337182520183, "eps_sum_utility_max": 1407.8424008596978}, "hist_stats": {"episode_reward": [117.37553345323346, 131.54431681660748, 111.80930678120384, 112.49214957217464, 114.00671196975287, 125.20313535249068, 112.10836948721253, 112.10395777222546, 102.35563827633345, 104.57167949527962, 110.97010555436412, 118.74121721771365, 129.24546368837719, 107.79774858143915, 112.28237564550325, 109.38042711776026, 116.78439325696631, 104.69190273276948, 111.12281653089953, 100.43447053941802, 108.21605954432901, 95.33724780764268, 105.50176790586768, 103.72521682678499, 112.32637596953799, 117.47627940322619, 129.85639371615102, 106.49845327666891, 109.86793411309964, 121.37451235381235, 101.10574378033073, 93.3594624515336, 122.31307638438481, 116.0131362782669, 114.1195988623754, 107.32369906642437, 113.64164576524959, 126.17946289800258, 107.5711981587394, 132.09488854863815, 80.5898626321456, 82.51386961851509, 87.14535377775941, 69.65771928118028, 71.28130199874792, 70.94651087650897, 69.98766812469864, 65.33712862322565, 75.28390297177165, 87.42604027013311, 78.68240255384876, 68.54179925848693, 49.206941106545884, 74.27903981214664, 97.97566990721037, 80.89586746518503, 67.02921064018302, 52.429996455482026, 76.96224862021884, 79.76227520483224, 97.83007017479827, 104.57820696740629, 98.23897960757456, 99.20992446771459, 93.24240449494548, 77.29820169686619, 103.68179337416214, 92.9157594337222, 105.52820256081944, 102.50835109545835, 101.88129969256396, 70.73387895847645, 105.94968458233032, 90.92644730282203, 91.9020192437286, 113.6067063159876, 96.89973542413347, 104.57438801390089, 93.96164923444238, 95.36805655350287, 99.35711484672575, 97.35285544867807, 104.28413299714222, 105.46978863880807, 89.52465984088371, 97.20958856815813, 84.72400105518062, 98.06176652522404, 98.43216040335288, 78.31318009545714, 87.07584529584965, 106.44700833365222, 84.75337963840023, 90.07527523174761, 100.67326705075776, 101.71311179565643, 102.20851605777423, 97.02862948739507, 85.9621884467054, 90.93777083133973], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_ue_reward": [55.81773323871033, 61.55780021452313, 65.7428214698562, 65.8014953467512, 57.62316472329943, 54.186142057904576, 59.34092898584302, 53.151220586331746, 53.46468506834385, 60.542026901408946, 65.02778444737473, 60.1753509051158, 53.02773549210402, 59.08063399510853, 57.51633256851343, 54.58762520371206, 48.210043763559476, 54.145594512774004, 53.94567720344225, 50.62600229183737, 53.440072481497666, 57.530033072866395, 54.680415537115245, 64.06080168059827, 67.13695943066051, 62.108504257716596, 51.371009268452376, 56.4267393129867, 54.28196022911064, 58.00041541639264, 48.18376726774032, 61.19665985001991, 56.77142718248658, 60.01296607447969, 52.4730301915331, 52.218872541236365, 51.797916637068, 59.32489989383159, 51.80866777725803, 48.62580276215992, 56.651594297083925, 51.564465247245025, 44.315705689332184, 51.02154211831058, 50.305061314715275, 55.196706591152434, 51.00821828272296, 52.71699854406201, 54.8552500659642, 57.471125903573856, 55.10172689837968, 62.37455250484653, 66.20679783843286, 63.64959587771818, 55.294206934018796, 51.204246342650066, 54.324003504818684, 55.54393060828103, 65.52995864780664, 55.84455370600552, 49.08851820776462, 52.01722557256599, 45.8253410950973, 47.534121356436344, 60.5759115789088, 61.73716480547615, 57.36726764895475, 58.645868629312076, 59.29053242891544, 54.82906643346, 53.56410764651134, 53.759591419913086, 58.35358151327884, 55.28806425197071, 59.877529495455704, 66.30193340254692, 52.98988282559515, 54.58131533314422, 66.94090241479448, 65.15398613384367, 41.755378634036624, 38.8344839981089, 42.760356501464145, 39.75351311705101, 43.76816066228143, 43.37719311547794, 28.16599758585444, 41.49172169532578, 35.793160398532976, 35.4881416002149, 37.10375595560942, 33.84275492089954, 28.77088235995369, 41.21678576474484, 35.23549734368584, 30.101631279539742, 37.90974657197776, 37.374156399793875, 44.50873638884107, 42.917303881292014, 36.24634707716872, 42.436055476679975, 40.9337616839791, 27.608037574507755, 27.287751339135916, 21.919189767409872, 35.293929748227455, 38.98511006391905, 51.40432065337621, 46.57134925383406, 38.47135838516156, 42.424509080023526, 30.771650657333442, 36.257559982849486, 28.856304639361298, 23.573691816120654, 47.218303598976966, 29.743945021241878, 39.68174746457753, 40.080527740254674, 48.81729320069824, 49.012776974099985, 50.69767097615416, 53.88053599125228, 50.96507996163306, 47.27389964594146, 45.65571790343213, 53.55420656428244, 51.46390471837332, 41.77849977657222, 31.820091958743134, 45.478109738122996, 50.02073710324596, 53.66105627091621, 47.097180207039756, 45.8185792266824, 51.47186286425716, 54.05633969656224, 55.656967666289624, 46.85138342916872, 52.75690306568025, 49.12439662688366, 39.18910498451499, 31.544773973961384, 53.16059499320847, 52.78908958912176, 44.62843938783058, 46.2980079149914, 54.71361948474254, 37.188399758986094, 60.11329699824025, 53.49340931774729, 58.52432185818659, 38.37541356594685, 54.42991618933568, 50.1444718245652, 49.09420986115891, 44.86743937328342, 48.577486417226815, 46.790570136275996, 49.678557423362875, 49.67855742336286, 42.29706025834759, 55.05579519033047, 53.29358865378012, 50.99054434336217, 52.73489431940401, 52.73489431940402, 39.43674272295852, 50.08791711792522, 51.9147381243256, 45.29485044383264, 45.47255422999822, 39.25144682518239, 54.839355186678205, 43.22241133854589, 46.18963095017416, 52.24252945317867, 48.03654766439671, 30.2766324310603, 39.803767957990516, 47.27207733785912, 55.767068691745585, 50.67993964190668, 48.68374597250137, 36.06963366589886, 51.671162732161974, 38.40411249958563, 56.07279413675484, 44.60047291400291, 53.37078348430022, 48.34232831135631, 44.47073291259893, 57.73778314517529, 50.87212656657357, 46.156502920821396, 40.453229201085506, 45.50895924561984, 46.845228282728065, 44.09254254861165]}, "sampler_perf": {"mean_env_wait_ms": 12.14504832203487, "mean_raw_obs_processing_ms": 0.5593545370577025, "mean_inference_ms": 7.402498610406747, "mean_action_processing_ms": 0.13800244734977582}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 16000, "timers": {"sample_time_ms": 4164.375, "sample_throughput": 960.528, "load_time_ms": 53.208, "load_throughput": 75177.18, "learn_time_ms": 8010.531, "learn_throughput": 499.343, "update_time_ms": 9.124}, "info": {"learner": {"ue": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 4.999999873689376e-05, "total_loss": 114.25251770019531, "policy_loss": -0.006581402383744717, "vf_loss": 114.2568588256836, "vf_explained_var": 0.00017528956232126802, "kl": 0.007481287233531475, "entropy": 0.9556161165237427, "entropy_coeff": 0.0, "model": {}}}, "num_steps_sampled": 16000, "num_steps_trained": 16000}, "done": false, "episodes_total": 160, "training_iteration": 4, "experiment_id": "f0134eced79d425ca17ebe3d2d0a9c1b", "date": "2021-03-09_10-44-36", "timestamp": 1615283076, "time_this_iter_s": 11.015432596206665, "time_total_s": 50.405842304229736, "pid": 4108, "hostname": "ray02", "node_ip": "131.234.28.177", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "env_config": {"episode_length": 100, "seed": null, "map": "150x100map", "bs_list": ["A", "B"], "ue_list": ["1", "2"], "rand_episodes": false, "new_ue_interval": null, "reward": "sum", "log_metrics": true}, "env": "MultiAgentMobileEnv", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": true, "log_level": "WARN", "callbacks": "<class 'deepcomp.util.callbacks.CustomMetricCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"ue": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Dict(connected:MultiBinary(2), dr:Box(0.0, 1.0, (2,), float32), ues_at_bs:Box(0.0, 1.0, (2,), float32), utility:Box(-1.0, 1.0, (1,), float32))", "Discrete(3)", {}]}, "policy_mapping_fn": "<function create_env_config.<locals>.<lambda> at 0x7f6b55482ee0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 50.405842304229736, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 26.019999999999996, "ram_util_percent": 4.799999999999999}, "trial_id": "e359b_00000"}
{"episode_reward_max": 135.16266447392553, "episode_reward_min": 78.31318009545714, "episode_reward_mean": 113.02672913966303, "episode_len_mean": 100.0, "episodes_this_iter": 40, "policy_reward_min": {"ue": 30.2766324310603}, "policy_reward_max": {"ue": 69.14342780606432}, "policy_reward_mean": {"ue": 56.51336456983151}, "custom_metrics": {"sum_utility_mean": 11.330259773805452, "sum_utility_min": -14.42798039285342, "sum_utility_max": 21.310345226162607, "eps_sum_utility_mean": 1138.5886238250991, "eps_sum_utility_min": 711.6064611098456, "eps_sum_utility_max": 1420.42745377813}, "hist_stats": {"episode_reward": [123.8210497098284, 126.46742106014662, 130.07882183082552, 125.19148647628447, 117.77629255921158, 119.91203149898448, 130.5008380661146, 118.30442690993333, 122.0961443025005, 132.6214029423595, 116.0130969521457, 135.16266447392553, 117.32275785677729, 104.98451378826587, 123.29828246641347, 122.4405351559626, 118.1987674437936, 122.58586674069511, 132.0775699160668, 115.80524685804602, 120.28399106201972, 117.43536496440717, 126.02437209050424, 118.35958670966795, 125.84825881888105, 123.89021764599444, 130.60986777533856, 134.78976562772658, 126.88623046391265, 116.09916661892322, 118.14261078091371, 123.16122243552934, 123.03669647433352, 112.00543476273207, 120.74897300104166, 126.6466559186902, 106.259175485757, 118.96881270083259, 119.5471607880401, 130.74201929109694, 99.35711484672575, 97.35285544867807, 104.28413299714222, 105.46978863880807, 89.52465984088371, 97.20958856815813, 84.72400105518062, 98.06176652522404, 98.43216040335288, 78.31318009545714, 87.07584529584965, 106.44700833365222, 84.75337963840023, 90.07527523174761, 100.67326705075776, 101.71311179565643, 102.20851605777423, 97.02862948739507, 85.9621884467054, 90.93777083133973, 117.37553345323346, 131.54431681660748, 111.80930678120384, 112.49214957217464, 114.00671196975287, 125.20313535249068, 112.10836948721253, 112.10395777222546, 102.35563827633345, 104.57167949527962, 110.97010555436412, 118.74121721771365, 129.24546368837719, 107.79774858143915, 112.28237564550325, 109.38042711776026, 116.78439325696631, 104.69190273276948, 111.12281653089953, 100.43447053941802, 108.21605954432901, 95.33724780764268, 105.50176790586768, 103.72521682678499, 112.32637596953799, 117.47627940322619, 129.85639371615102, 106.49845327666891, 109.86793411309964, 121.37451235381235, 101.10574378033073, 93.3594624515336, 122.31307638438481, 116.0131362782669, 114.1195988623754, 107.32369906642437, 113.64164576524959, 126.17946289800258, 107.5711981587394, 132.09488854863815], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_ue_reward": [61.271224364735545, 62.54982534509288, 64.21517948589118, 62.25224157425541, 64.55652618882993, 65.52229564199554, 62.59574323814217, 62.59574323814217, 63.54509604846297, 54.23119651074859, 60.751732003266746, 59.160299495717695, 65.88971952323593, 64.6111185428786, 59.62146074575424, 58.682966164179064, 65.48020120825818, 56.615943094242276, 67.84346010183376, 64.77794284052561, 61.79937704290212, 54.21371990924356, 69.14342780606432, 66.0192366678612, 63.09350798539658, 54.229249871380674, 48.18720666227336, 56.79730712599253, 64.87107425811071, 58.42720820830273, 60.19582424792068, 62.24471090804188, 55.52164479555837, 62.67712264823524, 61.96157079897376, 60.624295941721435, 67.60088052713495, 64.47668938893185, 53.92404216015036, 61.881204697895654, 64.06190292298754, 56.22208813903224, 59.45472485908311, 57.98064010532404, 61.42075353770299, 64.60361855280111, 56.09467022643673, 62.26491648323122, 60.66405947326529, 65.18419934561572, 60.383013253895605, 63.50720439209873, 66.10065014144378, 64.50921763389474, 68.2199360060853, 66.56982962164126, 62.64739897818172, 64.23883148573078, 62.677196139871285, 53.4219704790519, 59.554190117039695, 58.588420663874096, 62.44473241979258, 60.716490015736774, 61.51834823716677, 61.51834823716677, 55.67624841837908, 56.32918634435296, 63.52801457717143, 57.220958423870194, 65.80821860736957, 60.838437311320654, 53.895967058205514, 52.363208427551456, 58.688690096641764, 60.28012260419083, 60.69637547294291, 58.85078531509713, 66.29380472447136, 64.44821456662557, 49.678557423362875, 49.67855742336286, 42.29706025834759, 55.05579519033047, 53.29358865378012, 50.99054434336217, 52.73489431940401, 52.73489431940402, 39.43674272295852, 50.08791711792522, 51.9147381243256, 45.29485044383264, 45.47255422999822, 39.25144682518239, 54.839355186678205, 43.22241133854589, 46.18963095017416, 52.24252945317867, 48.03654766439671, 30.2766324310603, 39.803767957990516, 47.27207733785912, 55.767068691745585, 50.67993964190668, 48.68374597250137, 36.06963366589886, 51.671162732161974, 38.40411249958563, 56.07279413675484, 44.60047291400291, 53.37078348430022, 48.34232831135631, 44.47073291259893, 57.73778314517529, 50.87212656657357, 46.156502920821396, 40.453229201085506, 45.50895924561984, 46.845228282728065, 44.09254254861165, 55.81773323871033, 61.55780021452313, 65.7428214698562, 65.8014953467512, 57.62316472329943, 54.186142057904576, 59.34092898584302, 53.151220586331746, 53.46468506834385, 60.542026901408946, 65.02778444737473, 60.1753509051158, 53.02773549210402, 59.08063399510853, 57.51633256851343, 54.58762520371206, 48.210043763559476, 54.145594512774004, 53.94567720344225, 50.62600229183737, 53.440072481497666, 57.530033072866395, 54.680415537115245, 64.06080168059827, 67.13695943066051, 62.108504257716596, 51.371009268452376, 56.4267393129867, 54.28196022911064, 58.00041541639264, 48.18376726774032, 61.19665985001991, 56.77142718248658, 60.01296607447969, 52.4730301915331, 52.218872541236365, 51.797916637068, 59.32489989383159, 51.80866777725803, 48.62580276215992, 56.651594297083925, 51.564465247245025, 44.315705689332184, 51.02154211831058, 50.305061314715275, 55.196706591152434, 51.00821828272296, 52.71699854406201, 54.8552500659642, 57.471125903573856, 55.10172689837968, 62.37455250484653, 66.20679783843286, 63.64959587771818, 55.294206934018796, 51.204246342650066, 54.324003504818684, 55.54393060828103, 65.52995864780664, 55.84455370600552, 49.08851820776462, 52.01722557256599, 45.8253410950973, 47.534121356436344, 60.5759115789088, 61.73716480547615, 57.36726764895475, 58.645868629312076, 59.29053242891544, 54.82906643346, 53.56410764651134, 53.759591419913086, 58.35358151327884, 55.28806425197071, 59.877529495455704, 66.30193340254692, 52.98988282559515, 54.58131533314422, 66.94090241479448, 65.15398613384367]}, "sampler_perf": {"mean_env_wait_ms": 11.831167990733038, "mean_raw_obs_processing_ms": 0.5174927170593406, "mean_inference_ms": 6.996990710072253, "mean_action_processing_ms": 0.1352439792722104}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 20000, "timers": {"sample_time_ms": 4106.947, "sample_throughput": 973.959, "load_time_ms": 43.205, "load_throughput": 92582.033, "learn_time_ms": 7900.946, "learn_throughput": 506.269, "update_time_ms": 9.594}, "info": {"learner": {"ue": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 4.999999873689376e-05, "total_loss": 131.87203979492188, "policy_loss": -0.006849184632301331, "vf_loss": 131.8769073486328, "vf_explained_var": 0.0029309026431292295, "kl": 0.006647128611803055, "entropy": 0.9389936327934265, "entropy_coeff": 0.0, "model": {}}}, "num_steps_sampled": 20000, "num_steps_trained": 20000}, "done": false, "episodes_total": 200, "training_iteration": 5, "experiment_id": "f0134eced79d425ca17ebe3d2d0a9c1b", "date": "2021-03-09_10-44-47", "timestamp": 1615283087, "time_this_iter_s": 11.638067722320557, "time_total_s": 62.04391002655029, "pid": 4108, "hostname": "ray02", "node_ip": "131.234.28.177", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "env_config": {"episode_length": 100, "seed": null, "map": "150x100map", "bs_list": ["A", "B"], "ue_list": ["1", "2"], "rand_episodes": false, "new_ue_interval": null, "reward": "sum", "log_metrics": true}, "env": "MultiAgentMobileEnv", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": true, "log_level": "WARN", "callbacks": "<class 'deepcomp.util.callbacks.CustomMetricCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"ue": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Dict(connected:MultiBinary(2), dr:Box(0.0, 1.0, (2,), float32), ues_at_bs:Box(0.0, 1.0, (2,), float32), utility:Box(-1.0, 1.0, (1,), float32))", "Discrete(3)", {}]}, "policy_mapping_fn": "<function create_env_config.<locals>.<lambda> at 0x7f6b554829d0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 62.04391002655029, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 24.44375, "ram_util_percent": 4.8}, "trial_id": "e359b_00000"}
{"episode_reward_max": 143.89115726347035, "episode_reward_min": 93.3594624515336, "episode_reward_mean": 122.24865930397443, "episode_len_mean": 100.0, "episodes_this_iter": 40, "policy_reward_min": {"ue": 44.315705689332184}, "policy_reward_max": {"ue": 72.74129488550966}, "policy_reward_mean": {"ue": 61.1243296519872}, "custom_metrics": {"sum_utility_mean": 11.716908727531312, "sum_utility_min": -14.42798039285342, "sum_utility_max": 21.310345226162607, "eps_sum_utility_mean": 1254.8535329893411, "eps_sum_utility_min": 883.4160234252266, "eps_sum_utility_max": 1504.81781959704}, "hist_stats": {"episode_reward": [127.04135195128242, 130.4039211715994, 122.11117873968763, 124.22461966311143, 127.15089832775246, 119.5289548348328, 118.1411885126458, 120.86909851834724, 120.72272571336907, 126.13884517695367, 123.60701818502972, 139.8326172793695, 124.00479890553021, 129.27064949536185, 132.90385515880246, 132.27584106733403, 128.4846636118738, 143.89115726347035, 131.9977049510396, 125.89019633442271, 125.67437502951495, 132.2890981868784, 137.91264009343593, 132.5825069797144, 133.0716838758056, 131.80121962873446, 113.51161193454325, 119.24770113685771, 104.03555752761096, 140.61055414036377, 131.9969030072761, 129.76831197817367, 115.69222793608405, 126.50599792412135, 123.70007025404684, 131.8717520736229, 119.98916665324174, 132.1503388354646, 123.04638008070359, 132.86959472374394, 108.21605954432901, 95.33724780764268, 105.50176790586768, 103.72521682678499, 112.32637596953799, 117.47627940322619, 129.85639371615102, 106.49845327666891, 109.86793411309964, 121.37451235381235, 101.10574378033073, 93.3594624515336, 122.31307638438481, 116.0131362782669, 114.1195988623754, 107.32369906642437, 113.64164576524959, 126.17946289800258, 107.5711981587394, 132.09488854863815, 123.8210497098284, 126.46742106014662, 130.07882183082552, 125.19148647628447, 117.77629255921158, 119.91203149898448, 130.5008380661146, 118.30442690993333, 122.0961443025005, 132.6214029423595, 116.0130969521457, 135.16266447392553, 117.32275785677729, 104.98451378826587, 123.29828246641347, 122.4405351559626, 118.1987674437936, 122.58586674069511, 132.0775699160668, 115.80524685804602, 120.28399106201972, 117.43536496440717, 126.02437209050424, 118.35958670966795, 125.84825881888105, 123.89021764599444, 130.60986777533856, 134.78976562772658, 126.88623046391265, 116.09916661892322, 118.14261078091371, 123.16122243552934, 123.03669647433352, 112.00543476273207, 120.74897300104166, 126.6466559186902, 106.259175485757, 118.96881270083259, 119.5471607880401, 130.74201929109694], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_ue_reward": [65.14144542163773, 61.899906529644625, 60.76983152879176, 69.63408964280764, 55.09070168218182, 67.02047705750583, 64.65587435647517, 59.568745306636266, 63.60478610232374, 63.54611222542876, 63.20150008281121, 56.32745475202153, 63.346307549734995, 54.794880962910824, 65.7894733951045, 55.079625123242835, 57.931239721118246, 62.79148599225082, 59.71650437398765, 66.42234080296602, 58.137759350833896, 65.46925883419573, 69.91630863968473, 69.91630863968476, 64.3602112756411, 59.64458762988893, 68.58456907810607, 60.68608041725578, 70.08834038263466, 62.81551477616779, 63.11147128216474, 69.16436978516927, 64.24233180593686, 64.24233180593686, 72.74129488550966, 71.14986237796059, 63.67037759109118, 68.32732735994838, 62.30579767703269, 63.584398657390025, 62.51071855177048, 63.163656477744354, 69.90804072182094, 62.38105746505736, 69.23981463546217, 68.6728254579737, 62.371346097879524, 70.21116088183484, 69.43521236425661, 63.63647151154884, 64.33851424526559, 67.46270538346872, 58.28856459792568, 55.22304733661754, 61.08820425082953, 58.159496886028144, 52.14485758895389, 51.89069993865714, 68.89959726467613, 71.71095687568751, 66.6084150553692, 65.38848795190687, 69.57044269639147, 60.197869281782104, 55.64471790876178, 60.04751002732223, 57.995816712830695, 68.51018121129066, 64.3349257750479, 59.365144478999, 63.98863762782793, 67.88311444579492, 58.246735055475874, 61.742431597765716, 65.53361081425447, 66.61672802121006, 62.22116440742544, 60.825215673278116, 64.84336485432289, 68.02622986942102, 56.651594297083925, 51.564465247245025, 44.315705689332184, 51.02154211831058, 50.305061314715275, 55.196706591152434, 51.00821828272296, 52.71699854406201, 54.8552500659642, 57.471125903573856, 55.10172689837968, 62.37455250484653, 66.20679783843286, 63.64959587771818, 55.294206934018796, 51.204246342650066, 54.324003504818684, 55.54393060828103, 65.52995864780664, 55.84455370600552, 49.08851820776462, 52.01722557256599, 45.8253410950973, 47.534121356436344, 60.5759115789088, 61.73716480547615, 57.36726764895475, 58.645868629312076, 59.29053242891544, 54.82906643346, 53.56410764651134, 53.759591419913086, 58.35358151327884, 55.28806425197071, 59.877529495455704, 66.30193340254692, 52.98988282559515, 54.58131533314422, 66.94090241479448, 65.15398613384367, 61.271224364735545, 62.54982534509288, 64.21517948589118, 62.25224157425541, 64.55652618882993, 65.52229564199554, 62.59574323814217, 62.59574323814217, 63.54509604846297, 54.23119651074859, 60.751732003266746, 59.160299495717695, 65.88971952323593, 64.6111185428786, 59.62146074575424, 58.682966164179064, 65.48020120825818, 56.615943094242276, 67.84346010183376, 64.77794284052561, 61.79937704290212, 54.21371990924356, 69.14342780606432, 66.0192366678612, 63.09350798539658, 54.229249871380674, 48.18720666227336, 56.79730712599253, 64.87107425811071, 58.42720820830273, 60.19582424792068, 62.24471090804188, 55.52164479555837, 62.67712264823524, 61.96157079897376, 60.624295941721435, 67.60088052713495, 64.47668938893185, 53.92404216015036, 61.881204697895654, 64.06190292298754, 56.22208813903224, 59.45472485908311, 57.98064010532404, 61.42075353770299, 64.60361855280111, 56.09467022643673, 62.26491648323122, 60.66405947326529, 65.18419934561572, 60.383013253895605, 63.50720439209873, 66.10065014144378, 64.50921763389474, 68.2199360060853, 66.56982962164126, 62.64739897818172, 64.23883148573078, 62.677196139871285, 53.4219704790519, 59.554190117039695, 58.588420663874096, 62.44473241979258, 60.716490015736774, 61.51834823716677, 61.51834823716677, 55.67624841837908, 56.32918634435296, 63.52801457717143, 57.220958423870194, 65.80821860736957, 60.838437311320654, 53.895967058205514, 52.363208427551456, 58.688690096641764, 60.28012260419083, 60.69637547294291, 58.85078531509713, 66.29380472447136, 64.44821456662557]}, "sampler_perf": {"mean_env_wait_ms": 11.745961340462882, "mean_raw_obs_processing_ms": 0.5073112514481036, "mean_inference_ms": 6.829682022679008, "mean_action_processing_ms": 0.1380792494289196}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 24000, "timers": {"sample_time_ms": 4120.564, "sample_throughput": 970.741, "load_time_ms": 36.826, "load_throughput": 108618.282, "learn_time_ms": 7940.01, "learn_throughput": 503.778, "update_time_ms": 10.593}, "info": {"learner": {"ue": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 4.999999873689376e-05, "total_loss": 142.63514709472656, "policy_loss": -0.009481044486165047, "vf_loss": 142.64175415039062, "vf_explained_var": 0.006970904301851988, "kl": 0.009584158658981323, "entropy": 0.9159846901893616, "entropy_coeff": 0.0, "model": {}}}, "num_steps_sampled": 24000, "num_steps_trained": 24000}, "done": false, "episodes_total": 240, "training_iteration": 6, "experiment_id": "f0134eced79d425ca17ebe3d2d0a9c1b", "date": "2021-03-09_10-45-00", "timestamp": 1615283100, "time_this_iter_s": 12.69148850440979, "time_total_s": 74.73539853096008, "pid": 4108, "hostname": "ray02", "node_ip": "131.234.28.177", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "env_config": {"episode_length": 100, "seed": null, "map": "150x100map", "bs_list": ["A", "B"], "ue_list": ["1", "2"], "rand_episodes": false, "new_ue_interval": null, "reward": "sum", "log_metrics": true}, "env": "MultiAgentMobileEnv", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": true, "log_level": "WARN", "callbacks": "<class 'deepcomp.util.callbacks.CustomMetricCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"ue": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Dict(connected:MultiBinary(2), dr:Box(0.0, 1.0, (2,), float32), ues_at_bs:Box(0.0, 1.0, (2,), float32), utility:Box(-1.0, 1.0, (1,), float32))", "Discrete(3)", {}]}, "policy_mapping_fn": "<function create_env_config.<locals>.<lambda> at 0x7f6b55482430>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 74.73539853096008, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 25.644444444444442, "ram_util_percent": 4.8}, "trial_id": "e359b_00000"}
{"episode_reward_max": 144.07382869696238, "episode_reward_min": 104.03555752761096, "episode_reward_mean": 127.60094508122167, "episode_len_mean": 100.0, "episodes_this_iter": 40, "policy_reward_min": {"ue": 51.89069993865714}, "policy_reward_max": {"ue": 72.74129488550966}, "policy_reward_mean": {"ue": 63.800472540610805}, "custom_metrics": {"sum_utility_mean": 12.32789390480794, "sum_utility_min": -14.42798039285342, "sum_utility_max": 21.310345226162607, "eps_sum_utility_mean": 1320.557563446464, "eps_sum_utility_min": 1034.2877436433307, "eps_sum_utility_max": 1523.3803376324038}, "hist_stats": {"episode_reward": [142.247855658594, 128.88643834261845, 128.0622341866239, 137.54640329380743, 140.44699716216132, 128.21358450319664, 131.13509917028594, 131.99335243217985, 124.93615174849512, 133.4100996010169, 128.49737692507676, 122.70196880494112, 132.48942911884282, 107.95805513944319, 138.76581276337612, 132.3197936002515, 123.91011485957463, 124.1870471747327, 131.67401305529157, 126.11773609241115, 123.02807297515143, 116.44363577755229, 133.1135524543855, 144.07382869696238, 129.20987980228074, 136.04745122607926, 130.6288551351143, 130.0611644136343, 116.31707869723539, 130.97207142471063, 139.07415327488684, 138.42044866293372, 142.26903947114693, 136.3884686976392, 140.58273623894164, 141.54548697778284, 120.54877071252646, 128.90911290852557, 134.5948886958796, 126.06168796777862, 120.28399106201972, 117.43536496440717, 126.02437209050424, 118.35958670966795, 125.84825881888105, 123.89021764599444, 130.60986777533856, 134.78976562772658, 126.88623046391265, 116.09916661892322, 118.14261078091371, 123.16122243552934, 123.03669647433352, 112.00543476273207, 120.74897300104166, 126.6466559186902, 106.259175485757, 118.96881270083259, 119.5471607880401, 130.74201929109694, 127.04135195128242, 130.4039211715994, 122.11117873968763, 124.22461966311143, 127.15089832775246, 119.5289548348328, 118.1411885126458, 120.86909851834724, 120.72272571336907, 126.13884517695367, 123.60701818502972, 139.8326172793695, 124.00479890553021, 129.27064949536185, 132.90385515880246, 132.27584106733403, 128.4846636118738, 143.89115726347035, 131.9977049510396, 125.89019633442271, 125.67437502951495, 132.2890981868784, 137.91264009343593, 132.5825069797144, 133.0716838758056, 131.80121962873446, 113.51161193454325, 119.24770113685771, 104.03555752761096, 140.61055414036377, 131.9969030072761, 129.76831197817367, 115.69222793608405, 126.50599792412135, 123.70007025404684, 131.8717520736229, 119.98916665324174, 132.1503388354646, 123.04638008070359, 132.86959472374394], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_ue_reward": [72.71536033684605, 69.53249532174793, 65.87823591526238, 63.00820242735598, 64.67041758349063, 63.39181660313331, 69.56891790067823, 67.97748539312919, 70.40925128312396, 70.03774587903723, 65.15666615566958, 63.05691834752706, 62.28694268334399, 68.84815648694196, 62.87248507788681, 69.12086735429305, 63.873755679753245, 61.06239606874185, 66.60730791380756, 66.80279168720931, 63.45297220876383, 65.0444047163129, 61.50740016606642, 61.194568638874685, 67.67973130337457, 64.80969781546817, 52.387595062172565, 55.57046007727068, 68.74360589150938, 70.0222068718667, 68.6741243865977, 63.64566921365378, 62.14081013183068, 61.76930472774396, 64.45133541024246, 59.735711764490276, 65.19770603746714, 66.47630701782448, 60.18883455829917, 65.92890153411196, 63.96959019715263, 59.0584827779987, 59.65683463272932, 56.78680114482293, 68.85591417317382, 64.25763828121161, 72.0369143484812, 72.0369143484812, 65.08782462772318, 64.12205517455757, 65.53883496501517, 70.50861626106406, 64.54804825223006, 66.08080688288412, 62.8291861475369, 67.23197826609736, 55.63067432635053, 60.68640437088486, 67.04813128145686, 63.92394014325374, 71.12850914499248, 67.94564412989436, 66.18377507996453, 72.23667358296903, 72.72595224312246, 69.54308722802438, 68.86287177744573, 67.52559692019342, 71.8534636885724, 68.72927255036929, 70.89982231403974, 70.64566466374299, 58.81003167386253, 61.738739038663915, 65.03518306754643, 63.87392984097908, 67.1116916458964, 67.48319704998312, 63.18725974748515, 62.87442822029342, 64.06190292298754, 56.22208813903224, 59.45472485908311, 57.98064010532404, 61.42075353770299, 64.60361855280111, 56.09467022643673, 62.26491648323122, 60.66405947326529, 65.18419934561572, 60.383013253895605, 63.50720439209873, 66.10065014144378, 64.50921763389474, 68.2199360060853, 66.56982962164126, 62.64739897818172, 64.23883148573078, 62.677196139871285, 53.4219704790519, 59.554190117039695, 58.588420663874096, 62.44473241979258, 60.716490015736774, 61.51834823716677, 61.51834823716677, 55.67624841837908, 56.32918634435296, 63.52801457717143, 57.220958423870194, 65.80821860736957, 60.838437311320654, 53.895967058205514, 52.363208427551456, 58.688690096641764, 60.28012260419083, 60.69637547294291, 58.85078531509713, 66.29380472447136, 64.44821456662557, 65.14144542163773, 61.899906529644625, 60.76983152879176, 69.63408964280764, 55.09070168218182, 67.02047705750583, 64.65587435647517, 59.568745306636266, 63.60478610232374, 63.54611222542876, 63.20150008281121, 56.32745475202153, 63.346307549734995, 54.794880962910824, 65.7894733951045, 55.079625123242835, 57.931239721118246, 62.79148599225082, 59.71650437398765, 66.42234080296602, 58.137759350833896, 65.46925883419573, 69.91630863968473, 69.91630863968476, 64.3602112756411, 59.64458762988893, 68.58456907810607, 60.68608041725578, 70.08834038263466, 62.81551477616779, 63.11147128216474, 69.16436978516927, 64.24233180593686, 64.24233180593686, 72.74129488550966, 71.14986237796059, 63.67037759109118, 68.32732735994838, 62.30579767703269, 63.584398657390025, 62.51071855177048, 63.163656477744354, 69.90804072182094, 62.38105746505736, 69.23981463546217, 68.6728254579737, 62.371346097879524, 70.21116088183484, 69.43521236425661, 63.63647151154884, 64.33851424526559, 67.46270538346872, 58.28856459792568, 55.22304733661754, 61.08820425082953, 58.159496886028144, 52.14485758895389, 51.89069993865714, 68.89959726467613, 71.71095687568751, 66.6084150553692, 65.38848795190687, 69.57044269639147, 60.197869281782104, 55.64471790876178, 60.04751002732223, 57.995816712830695, 68.51018121129066, 64.3349257750479, 59.365144478999, 63.98863762782793, 67.88311444579492, 58.246735055475874, 61.742431597765716, 65.53361081425447, 66.61672802121006, 62.22116440742544, 60.825215673278116, 64.84336485432289, 68.02622986942102]}, "sampler_perf": {"mean_env_wait_ms": 11.743134404993068, "mean_raw_obs_processing_ms": 0.5120732336340114, "mean_inference_ms": 6.692685639170813, "mean_action_processing_ms": 0.14460329460584054}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 28000, "timers": {"sample_time_ms": 4085.277, "sample_throughput": 979.126, "load_time_ms": 32.265, "load_throughput": 123974.462, "learn_time_ms": 7783.818, "learn_throughput": 513.887, "update_time_ms": 10.945}, "info": {"learner": {"ue": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 4.999999873689376e-05, "total_loss": 144.91578674316406, "policy_loss": -0.004027409944683313, "vf_loss": 144.91839599609375, "vf_explained_var": 0.004554052371531725, "kl": 0.004749868996441364, "entropy": 0.8987213969230652, "entropy_coeff": 0.0, "model": {}}}, "num_steps_sampled": 28000, "num_steps_trained": 28000}, "done": false, "episodes_total": 280, "training_iteration": 7, "experiment_id": "f0134eced79d425ca17ebe3d2d0a9c1b", "date": "2021-03-09_10-45-11", "timestamp": 1615283111, "time_this_iter_s": 11.07378339767456, "time_total_s": 85.80918192863464, "pid": 4108, "hostname": "ray02", "node_ip": "131.234.28.177", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "env_config": {"episode_length": 100, "seed": null, "map": "150x100map", "bs_list": ["A", "B"], "ue_list": ["1", "2"], "rand_episodes": false, "new_ue_interval": null, "reward": "sum", "log_metrics": true}, "env": "MultiAgentMobileEnv", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": true, "log_level": "WARN", "callbacks": "<class 'deepcomp.util.callbacks.CustomMetricCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"ue": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Dict(connected:MultiBinary(2), dr:Box(0.0, 1.0, (2,), float32), ues_at_bs:Box(0.0, 1.0, (2,), float32), utility:Box(-1.0, 1.0, (1,), float32))", "Discrete(3)", {}]}, "policy_mapping_fn": "<function create_env_config.<locals>.<lambda> at 0x7f6b554824c0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 85.80918192863464, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 27.09333333333333, "ram_util_percent": 4.799999999999999}, "trial_id": "e359b_00000"}
{"episode_reward_max": 144.86757840106128, "episode_reward_min": 104.03555752761096, "episode_reward_mean": 130.88924236261929, "episode_len_mean": 100.0, "episodes_this_iter": 40, "policy_reward_min": {"ue": 51.89069993865714}, "policy_reward_max": {"ue": 73.20016851585758}, "policy_reward_mean": {"ue": 65.44462118130963}, "custom_metrics": {"sum_utility_mean": 13.322176870704135, "sum_utility_min": -8.171349849018874, "sum_utility_max": 21.310345226162607, "eps_sum_utility_mean": 1355.098347174163, "eps_sum_utility_min": 1034.2877436433307, "eps_sum_utility_max": 1535.3056374301611}, "hist_stats": {"episode_reward": [141.34087765477696, 132.05755538990311, 132.1913178762715, 123.36269838723462, 140.25824444441918, 142.4345147732942, 121.905692315934, 122.04040509259892, 130.25533149172497, 134.79572549348887, 128.14972918506763, 133.12749025533918, 137.28065271377994, 117.04686953443255, 132.53568812915103, 144.86757840106128, 139.78882435269384, 133.40664340457218, 128.61118057735044, 127.7411733687394, 143.3472093359032, 140.28887409105585, 121.65524530112461, 137.95071734869157, 127.80502327145506, 134.982452130895, 138.16262456857157, 132.65314172614165, 138.4423671432018, 135.0407819161856, 131.60508094798837, 132.551244787926, 138.13479915676413, 136.9542240944316, 131.3163392468494, 143.40402989655115, 133.6409485303907, 117.93512428213248, 127.53295394959483, 130.2052218502347, 125.67437502951495, 132.2890981868784, 137.91264009343593, 132.5825069797144, 133.0716838758056, 131.80121962873446, 113.51161193454325, 119.24770113685771, 104.03555752761096, 140.61055414036377, 131.9969030072761, 129.76831197817367, 115.69222793608405, 126.50599792412135, 123.70007025404684, 131.8717520736229, 119.98916665324174, 132.1503388354646, 123.04638008070359, 132.86959472374394, 142.247855658594, 128.88643834261845, 128.0622341866239, 137.54640329380743, 140.44699716216132, 128.21358450319664, 131.13509917028594, 131.99335243217985, 124.93615174849512, 133.4100996010169, 128.49737692507676, 122.70196880494112, 132.48942911884282, 107.95805513944319, 138.76581276337612, 132.3197936002515, 123.91011485957463, 124.1870471747327, 131.67401305529157, 126.11773609241115, 123.02807297515143, 116.44363577755229, 133.1135524543855, 144.07382869696238, 129.20987980228074, 136.04745122607926, 130.6288551351143, 130.0611644136343, 116.31707869723539, 130.97207142471063, 139.07415327488684, 138.42044866293372, 142.26903947114693, 136.3884686976392, 140.58273623894164, 141.54548697778284, 120.54877071252646, 128.90911290852557, 134.5948886958796, 126.06168796777862], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_ue_reward": [72.26187133493752, 69.07900631983941, 67.74728902764895, 64.3102663622541, 63.73784711525967, 68.45347076101184, 63.145702876018035, 60.21699551121666, 68.53768971466047, 71.72055472975858, 69.62582487909799, 72.8086898941961, 62.99782645365132, 58.90786586228259, 59.102301075763506, 62.9381040168355, 66.02112388633785, 64.23420760538707, 68.0371632369231, 66.75856225656578, 65.50988133648697, 62.639847848580594, 64.23527024324102, 68.89222001209822, 67.20530961293672, 70.07534310084311, 57.60063968829339, 59.446229846139175, 66.42425982817137, 66.11142830097965, 73.20016851585758, 71.66740988520351, 69.00095403587143, 70.78787031682225, 68.32409114828272, 65.0825522562896, 64.30559028867525, 64.30559028867525, 64.05633938641307, 63.684833982326346, 72.43998398327861, 70.90722535262452, 71.55011685103358, 68.73875724002218, 56.3661566551069, 65.2890886460178, 68.17964242057121, 69.77107492812027, 61.67177863799979, 66.13324463345523, 68.28694231922199, 66.69550981167293, 69.90636547650779, 68.25625909206373, 65.65793343444466, 66.995208291697, 68.26905155423047, 70.17331558897126, 69.05314958874688, 65.98763232743873, 65.80254047399417, 65.80254047399417, 68.78984998043495, 63.76139480749102, 66.70958775550596, 71.42521140125814, 69.853454914274, 67.1007691801576, 63.91032135227979, 67.40601789456964, 70.26699820432229, 73.13703169222866, 66.82047426519534, 66.82047426519534, 57.98609318524836, 59.94903109688415, 66.92000505144804, 60.61294889814681, 65.61483259014767, 64.59038926008708, 62.51071855177048, 63.163656477744354, 69.90804072182094, 62.38105746505736, 69.23981463546217, 68.6728254579737, 62.371346097879524, 70.21116088183484, 69.43521236425661, 63.63647151154884, 64.33851424526559, 67.46270538346872, 58.28856459792568, 55.22304733661754, 61.08820425082953, 58.159496886028144, 52.14485758895389, 51.89069993865714, 68.89959726467613, 71.71095687568751, 66.6084150553692, 65.38848795190687, 69.57044269639147, 60.197869281782104, 55.64471790876178, 60.04751002732223, 57.995816712830695, 68.51018121129066, 64.3349257750479, 59.365144478999, 63.98863762782793, 67.88311444579492, 58.246735055475874, 61.742431597765716, 65.53361081425447, 66.61672802121006, 62.22116440742544, 60.825215673278116, 64.84336485432289, 68.02622986942102, 72.71536033684605, 69.53249532174793, 65.87823591526238, 63.00820242735598, 64.67041758349063, 63.39181660313331, 69.56891790067823, 67.97748539312919, 70.40925128312396, 70.03774587903723, 65.15666615566958, 63.05691834752706, 62.28694268334399, 68.84815648694196, 62.87248507788681, 69.12086735429305, 63.873755679753245, 61.06239606874185, 66.60730791380756, 66.80279168720931, 63.45297220876383, 65.0444047163129, 61.50740016606642, 61.194568638874685, 67.67973130337457, 64.80969781546817, 52.387595062172565, 55.57046007727068, 68.74360589150938, 70.0222068718667, 68.6741243865977, 63.64566921365378, 62.14081013183068, 61.76930472774396, 64.45133541024246, 59.735711764490276, 65.19770603746714, 66.47630701782448, 60.18883455829917, 65.92890153411196, 63.96959019715263, 59.0584827779987, 59.65683463272932, 56.78680114482293, 68.85591417317382, 64.25763828121161, 72.0369143484812, 72.0369143484812, 65.08782462772318, 64.12205517455757, 65.53883496501517, 70.50861626106406, 64.54804825223006, 66.08080688288412, 62.8291861475369, 67.23197826609736, 55.63067432635053, 60.68640437088486, 67.04813128145686, 63.92394014325374, 71.12850914499248, 67.94564412989436, 66.18377507996453, 72.23667358296903, 72.72595224312246, 69.54308722802438, 68.86287177744573, 67.52559692019342, 71.8534636885724, 68.72927255036929, 70.89982231403974, 70.64566466374299, 58.81003167386253, 61.738739038663915, 65.03518306754643, 63.87392984097908, 67.1116916458964, 67.48319704998312, 63.18725974748515, 62.87442822029342]}, "sampler_perf": {"mean_env_wait_ms": 11.698990271151017, "mean_raw_obs_processing_ms": 0.5121647210636824, "mean_inference_ms": 6.537945824005554, "mean_action_processing_ms": 0.14739256659340833}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 32000, "timers": {"sample_time_ms": 4020.149, "sample_throughput": 994.988, "load_time_ms": 28.725, "load_throughput": 139253.554, "learn_time_ms": 7622.755, "learn_throughput": 524.745, "update_time_ms": 10.889}, "info": {"learner": {"ue": {"cur_kl_coeff": 0.15000000596046448, "cur_lr": 4.999999873689376e-05, "total_loss": 149.03489685058594, "policy_loss": -0.0035470561124384403, "vf_loss": 149.03732299804688, "vf_explained_var": 0.005184704437851906, "kl": 0.007476327940821648, "entropy": 0.8724437355995178, "entropy_coeff": 0.0, "model": {}}}, "num_steps_sampled": 32000, "num_steps_trained": 32000}, "done": false, "episodes_total": 320, "training_iteration": 8, "experiment_id": "f0134eced79d425ca17ebe3d2d0a9c1b", "date": "2021-03-09_10-45-22", "timestamp": 1615283122, "time_this_iter_s": 10.314263582229614, "time_total_s": 96.12344551086426, "pid": 4108, "hostname": "ray02", "node_ip": "131.234.28.177", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "env_config": {"episode_length": 100, "seed": null, "map": "150x100map", "bs_list": ["A", "B"], "ue_list": ["1", "2"], "rand_episodes": false, "new_ue_interval": null, "reward": "sum", "log_metrics": true}, "env": "MultiAgentMobileEnv", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": true, "log_level": "WARN", "callbacks": "<class 'deepcomp.util.callbacks.CustomMetricCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"ue": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Dict(connected:MultiBinary(2), dr:Box(0.0, 1.0, (2,), float32), ues_at_bs:Box(0.0, 1.0, (2,), float32), utility:Box(-1.0, 1.0, (1,), float32))", "Discrete(3)", {}]}, "policy_mapping_fn": "<function create_env_config.<locals>.<lambda> at 0x7f6a94b53670>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 96.12344551086426, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 28.02857142857142, "ram_util_percent": 4.799999999999999}, "trial_id": "e359b_00000"}
{"episode_reward_max": 149.81309192630414, "episode_reward_min": 116.31707869723539, "episode_reward_mean": 135.49074797766949, "episode_len_mean": 100.0, "episodes_this_iter": 40, "policy_reward_min": {"ue": 55.63067432635053}, "policy_reward_max": {"ue": 75.18957994099677}, "policy_reward_mean": {"ue": 67.74537398883473}, "custom_metrics": {"sum_utility_mean": 14.055587533134348, "sum_utility_min": -9.344827386918697, "sum_utility_max": 21.310345226162607, "eps_sum_utility_mean": 1405.6849692330734, "eps_sum_utility_min": 1170.0109793747415, "eps_sum_utility_max": 1553.294654105571}, "hist_stats": {"episode_reward": [142.4291253375893, 143.25801201177836, 142.23098788984723, 143.4547138910832, 140.75596702617116, 137.49609986623955, 129.47899532498147, 136.31166757038187, 131.1301382471297, 137.26249352034347, 143.45804631544183, 130.44772306896226, 145.3738605470366, 139.82900897469506, 149.81309192630414, 133.50485538309198, 138.67700983981132, 139.2575698512107, 142.33513364916593, 148.84640125133978, 137.1249966014476, 136.4879231333927, 147.15502171869826, 136.0517057375799, 145.3456566302662, 143.47892888614786, 137.29433569856297, 137.7185275675959, 137.59446258576497, 137.9424307866367, 142.9132903010664, 139.53696402957127, 142.88860560423592, 135.97486684944977, 134.0418235397809, 139.18218179205405, 140.65405522911135, 142.5073147452474, 144.49870919060157, 140.23511501806217, 123.02807297515143, 116.44363577755229, 133.1135524543855, 144.07382869696238, 129.20987980228074, 136.04745122607926, 130.6288551351143, 130.0611644136343, 116.31707869723539, 130.97207142471063, 139.07415327488684, 138.42044866293372, 142.26903947114693, 136.3884686976392, 140.58273623894164, 141.54548697778284, 120.54877071252646, 128.90911290852557, 134.5948886958796, 126.06168796777862, 141.34087765477696, 132.05755538990311, 132.1913178762715, 123.36269838723462, 140.25824444441918, 142.4345147732942, 121.905692315934, 122.04040509259892, 130.25533149172497, 134.79572549348887, 128.14972918506763, 133.12749025533918, 137.28065271377994, 117.04686953443255, 132.53568812915103, 144.86757840106128, 139.78882435269384, 133.40664340457218, 128.61118057735044, 127.7411733687394, 143.3472093359032, 140.28887409105585, 121.65524530112461, 137.95071734869157, 127.80502327145506, 134.982452130895, 138.16262456857157, 132.65314172614165, 138.4423671432018, 135.0407819161856, 131.60508094798837, 132.551244787926, 138.13479915676413, 136.9542240944316, 131.3163392468494, 143.40402989655115, 133.6409485303907, 117.93512428213248, 127.53295394959483, 130.2052218502347], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_ue_reward": [68.98382967106684, 73.4452956665223, 71.65834294433662, 71.59966906744165, 71.11549394492363, 71.11549394492363, 70.44875596518426, 73.00595792589891, 72.73579533596164, 68.02017169020947, 68.74804993311979, 68.74804993311979, 65.63295580296607, 63.84603952201525, 69.74726629274001, 66.5644012776419, 65.08218439698207, 66.04795385014768, 67.86486744484472, 69.39762607549879, 71.72902315772083, 71.72902315772085, 65.99024084980813, 64.45748221915406, 71.0954977659692, 74.27836278106732, 70.83729956627035, 68.99170940842455, 74.90654596315197, 74.90654596315197, 65.16099518399695, 68.34386019909509, 70.74418472541134, 67.93282511439995, 70.42450117937986, 68.8330686718308, 71.16756682458292, 71.16756682458292, 75.18957994099677, 73.65682131034269, 69.35821455449832, 67.76678204694926, 68.21462462824886, 68.27329850514386, 75.16894336689813, 71.98607835180002, 67.35721544016381, 68.69449029741612, 72.67282831513305, 72.67282831513305, 71.10016395289517, 72.37876493325251, 69.44288410305593, 67.85145159550689, 67.26783127624887, 70.45069629134699, 71.98009630798056, 65.61436627778434, 70.43556907571904, 67.50686171091766, 70.78800772190702, 72.12528257915935, 66.9277854653266, 72.60917856424442, 70.64858654834345, 72.24001905589252, 68.7538127400519, 67.22105410939783, 67.81662802366496, 66.2251955161159, 71.18252340357604, 67.99965838847795, 71.8891231836572, 68.76493204545407, 71.89295786280229, 70.61435688244497, 72.24935459530073, 72.24935459530073, 69.3218412552565, 70.91327376280555, 63.96959019715263, 59.0584827779987, 59.65683463272932, 56.78680114482293, 68.85591417317382, 64.25763828121161, 72.0369143484812, 72.0369143484812, 65.08782462772318, 64.12205517455757, 65.53883496501517, 70.50861626106406, 64.54804825223006, 66.08080688288412, 62.8291861475369, 67.23197826609736, 55.63067432635053, 60.68640437088486, 67.04813128145686, 63.92394014325374, 71.12850914499248, 67.94564412989436, 66.18377507996453, 72.23667358296903, 72.72595224312246, 69.54308722802438, 68.86287177744573, 67.52559692019342, 71.8534636885724, 68.72927255036929, 70.89982231403974, 70.64566466374299, 58.81003167386253, 61.738739038663915, 65.03518306754643, 63.87392984097908, 67.1116916458964, 67.48319704998312, 63.18725974748515, 62.87442822029342, 72.26187133493752, 69.07900631983941, 67.74728902764895, 64.3102663622541, 63.73784711525967, 68.45347076101184, 63.145702876018035, 60.21699551121666, 68.53768971466047, 71.72055472975858, 69.62582487909799, 72.8086898941961, 62.99782645365132, 58.90786586228259, 59.102301075763506, 62.9381040168355, 66.02112388633785, 64.23420760538707, 68.0371632369231, 66.75856225656578, 65.50988133648697, 62.639847848580594, 64.23527024324102, 68.89222001209822, 67.20530961293672, 70.07534310084311, 57.60063968829339, 59.446229846139175, 66.42425982817137, 66.11142830097965, 73.20016851585758, 71.66740988520351, 69.00095403587143, 70.78787031682225, 68.32409114828272, 65.0825522562896, 64.30559028867525, 64.30559028867525, 64.05633938641307, 63.684833982326346, 72.43998398327861, 70.90722535262452, 71.55011685103358, 68.73875724002218, 56.3661566551069, 65.2890886460178, 68.17964242057121, 69.77107492812027, 61.67177863799979, 66.13324463345523, 68.28694231922199, 66.69550981167293, 69.90636547650779, 68.25625909206373, 65.65793343444466, 66.995208291697, 68.26905155423047, 70.17331558897126, 69.05314958874688, 65.98763232743873, 65.80254047399417, 65.80254047399417, 68.78984998043495, 63.76139480749102, 66.70958775550596, 71.42521140125814, 69.853454914274, 67.1007691801576, 63.91032135227979, 67.40601789456964, 70.26699820432229, 73.13703169222866, 66.82047426519534, 66.82047426519534, 57.98609318524836, 59.94903109688415, 66.92000505144804, 60.61294889814681, 65.61483259014767, 64.59038926008708]}, "sampler_perf": {"mean_env_wait_ms": 11.572237965209274, "mean_raw_obs_processing_ms": 0.5094534674368721, "mean_inference_ms": 6.358271802502313, "mean_action_processing_ms": 0.1504877130009102}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 36000, "timers": {"sample_time_ms": 3931.638, "sample_throughput": 1017.388, "load_time_ms": 25.858, "load_throughput": 154693.987, "learn_time_ms": 7511.692, "learn_throughput": 532.503, "update_time_ms": 10.816}, "info": {"learner": {"ue": {"cur_kl_coeff": 0.15000000596046448, "cur_lr": 4.999999873689376e-05, "total_loss": 161.9961700439453, "policy_loss": -0.003022699151188135, "vf_loss": 161.99794006347656, "vf_explained_var": 0.008117475546896458, "kl": 0.008567010052502155, "entropy": 0.8736552000045776, "entropy_coeff": 0.0, "model": {}}}, "num_steps_sampled": 36000, "num_steps_trained": 36000}, "done": false, "episodes_total": 360, "training_iteration": 9, "experiment_id": "f0134eced79d425ca17ebe3d2d0a9c1b", "date": "2021-03-09_10-45-32", "timestamp": 1615283132, "time_this_iter_s": 10.143382549285889, "time_total_s": 106.26682806015015, "pid": 4108, "hostname": "ray02", "node_ip": "131.234.28.177", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "env_config": {"episode_length": 100, "seed": null, "map": "150x100map", "bs_list": ["A", "B"], "ue_list": ["1", "2"], "rand_episodes": false, "new_ue_interval": null, "reward": "sum", "log_metrics": true}, "env": "MultiAgentMobileEnv", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": true, "log_level": "WARN", "callbacks": "<class 'deepcomp.util.callbacks.CustomMetricCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"ue": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Dict(connected:MultiBinary(2), dr:Box(0.0, 1.0, (2,), float32), ues_at_bs:Box(0.0, 1.0, (2,), float32), utility:Box(-1.0, 1.0, (1,), float32))", "Discrete(3)", {}]}, "policy_mapping_fn": "<function create_env_config.<locals>.<lambda> at 0x7f6bbc4d08b0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 106.26682806015015, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 27.22857142857143, "ram_util_percent": 4.799999999999999}, "trial_id": "e359b_00000"}
{"episode_reward_max": 149.81309192630414, "episode_reward_min": 117.93512428213248, "episode_reward_mean": 139.3152246827145, "episode_len_mean": 100.0, "episodes_this_iter": 40, "policy_reward_min": {"ue": 56.3661566551069}, "policy_reward_max": {"ue": 75.48551962592043}, "policy_reward_mean": {"ue": 69.65761234135722}, "custom_metrics": {"sum_utility_mean": 14.950148305308332, "sum_utility_min": -9.344827386918697, "sum_utility_max": 21.310345226162607, "eps_sum_utility_mean": 1448.877452088497, "eps_sum_utility_min": 1161.5458473903307, "eps_sum_utility_max": 1577.0311993432572}, "hist_stats": {"episode_reward": [148.85240728100842, 145.94817299240367, 143.6517044150719, 141.5599968037754, 130.1979103856039, 142.21217664190476, 143.3686528816816, 143.2589014921457, 139.57213748956576, 144.96514036074865, 118.77206257450487, 140.17417154511577, 140.92588255537805, 141.9243153096075, 146.63370899849446, 138.72047967646233, 138.2427631065679, 132.7681010813555, 145.76540999328017, 147.3640784355028, 138.36141422000503, 140.82797831740137, 149.03034737559696, 143.01725439525666, 146.50003505922388, 142.3701047438965, 144.43422596653886, 140.45621607327263, 143.88052619688983, 144.87818357886317, 145.35668755634651, 142.71440246589117, 140.87918904211256, 147.78817423674292, 140.25198670530114, 136.18904596507127, 141.08905684748305, 137.38540898468375, 144.49794685733272, 139.14988894939148, 143.3472093359032, 140.28887409105585, 121.65524530112461, 137.95071734869157, 127.80502327145506, 134.982452130895, 138.16262456857157, 132.65314172614165, 138.4423671432018, 135.0407819161856, 131.60508094798837, 132.551244787926, 138.13479915676413, 136.9542240944316, 131.3163392468494, 143.40402989655115, 133.6409485303907, 117.93512428213248, 127.53295394959483, 130.2052218502347, 142.4291253375893, 143.25801201177836, 142.23098788984723, 143.4547138910832, 140.75596702617116, 137.49609986623955, 129.47899532498147, 136.31166757038187, 131.1301382471297, 137.26249352034347, 143.45804631544183, 130.44772306896226, 145.3738605470366, 139.82900897469506, 149.81309192630414, 133.50485538309198, 138.67700983981132, 139.2575698512107, 142.33513364916593, 148.84640125133978, 137.1249966014476, 136.4879231333927, 147.15502171869826, 136.0517057375799, 145.3456566302662, 143.47892888614786, 137.29433569856297, 137.7185275675959, 137.59446258576497, 137.9424307866367, 142.9132903010664, 139.53696402957127, 142.88860560423592, 135.97486684944977, 134.0418235397809, 139.18218179205405, 140.65405522911135, 142.5073147452474, 144.49870919060157, 140.23511501806217], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_ue_reward": [75.06550413068278, 73.78690315032544, 70.77269043692152, 75.17548255548198, 72.62156846131037, 71.03013595376129, 70.11136097326155, 71.44863583051388, 67.32968819052971, 62.868222195074274, 70.18329324202946, 72.02888339987527, 72.32362693101945, 71.04502595066211, 74.01659950739632, 69.24230198474918, 71.31882737543692, 68.2533101141288, 71.8432696901956, 73.12187067055292, 57.31171405312055, 61.46034852138427, 70.08708577255784, 70.08708577255784, 68.26154521840873, 72.66433733696918, 70.80574189120792, 71.11857341839963, 73.31685449924723, 73.31685449924723, 67.95456003272541, 70.76591964373682, 68.32566529950931, 69.91709780705837, 67.78973034618343, 64.97837073517206, 72.88270499664007, 72.88270499664007, 73.68203921775132, 73.68203921775132, 69.21004404845003, 69.15137017155504, 69.61827290492617, 71.20970541247526, 73.71945743402391, 75.31088994157297, 69.91719469007924, 73.10005970517736, 73.40643329320775, 73.09360176601604, 71.95143168727529, 70.41867305662123, 72.21711298326936, 72.21711298326937, 70.22810803663626, 70.22810803663626, 70.40750446779082, 73.47302172909895, 72.46842872787894, 72.40975485098394, 71.91196446284616, 73.44472309350023, 69.795105663844, 72.91929680204711, 70.41025758260868, 70.46893145950368, 75.48551962592043, 72.30265461082233, 70.28240911624633, 69.9695775890546, 67.17172790361272, 69.0173180614585, 73.66871956194464, 67.4203372855384, 70.7376847880262, 66.64772419665748, 72.9176108572925, 71.58033600004019, 71.13704004379731, 68.01284890559418, 72.43998398327861, 70.90722535262452, 71.55011685103358, 68.73875724002218, 56.3661566551069, 65.2890886460178, 68.17964242057121, 69.77107492812027, 61.67177863799979, 66.13324463345523, 68.28694231922199, 66.69550981167293, 69.90636547650779, 68.25625909206373, 65.65793343444466, 66.995208291697, 68.26905155423047, 70.17331558897126, 69.05314958874688, 65.98763232743873, 65.80254047399417, 65.80254047399417, 68.78984998043495, 63.76139480749102, 66.70958775550596, 71.42521140125814, 69.853454914274, 67.1007691801576, 63.91032135227979, 67.40601789456964, 70.26699820432229, 73.13703169222866, 66.82047426519534, 66.82047426519534, 57.98609318524836, 59.94903109688415, 66.92000505144804, 60.61294889814681, 65.61483259014767, 64.59038926008708, 68.98382967106684, 73.4452956665223, 71.65834294433662, 71.59966906744165, 71.11549394492363, 71.11549394492363, 70.44875596518426, 73.00595792589891, 72.73579533596164, 68.02017169020947, 68.74804993311979, 68.74804993311979, 65.63295580296607, 63.84603952201525, 69.74726629274001, 66.5644012776419, 65.08218439698207, 66.04795385014768, 67.86486744484472, 69.39762607549879, 71.72902315772083, 71.72902315772085, 65.99024084980813, 64.45748221915406, 71.0954977659692, 74.27836278106732, 70.83729956627035, 68.99170940842455, 74.90654596315197, 74.90654596315197, 65.16099518399695, 68.34386019909509, 70.74418472541134, 67.93282511439995, 70.42450117937986, 68.8330686718308, 71.16756682458292, 71.16756682458292, 75.18957994099677, 73.65682131034269, 69.35821455449832, 67.76678204694926, 68.21462462824886, 68.27329850514386, 75.16894336689813, 71.98607835180002, 67.35721544016381, 68.69449029741612, 72.67282831513305, 72.67282831513305, 71.10016395289517, 72.37876493325251, 69.44288410305593, 67.85145159550689, 67.26783127624887, 70.45069629134699, 71.98009630798056, 65.61436627778434, 70.43556907571904, 67.50686171091766, 70.78800772190702, 72.12528257915935, 66.9277854653266, 72.60917856424442, 70.64858654834345, 72.24001905589252, 68.7538127400519, 67.22105410939783, 67.81662802366496, 66.2251955161159, 71.18252340357604, 67.99965838847795, 71.8891231836572, 68.76493204545407, 71.89295786280229, 70.61435688244497, 72.24935459530073, 72.24935459530073, 69.3218412552565, 70.91327376280555]}, "sampler_perf": {"mean_env_wait_ms": 11.471715621391047, "mean_raw_obs_processing_ms": 0.5027689237945314, "mean_inference_ms": 6.196710688149344, "mean_action_processing_ms": 0.14796486211877283}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 40000, "timers": {"sample_time_ms": 3891.818, "sample_throughput": 1027.797, "load_time_ms": 23.579, "load_throughput": 169644.355, "learn_time_ms": 7420.409, "learn_throughput": 539.054, "update_time_ms": 11.145}, "info": {"learner": {"ue": {"cur_kl_coeff": 0.15000000596046448, "cur_lr": 4.999999873689376e-05, "total_loss": 166.57650756835938, "policy_loss": -0.00617979047819972, "vf_loss": 166.5810546875, "vf_explained_var": 0.013758332468569279, "kl": 0.010848707519471645, "entropy": 0.8526402711868286, "entropy_coeff": 0.0, "model": {}}}, "num_steps_sampled": 40000, "num_steps_trained": 40000}, "done": false, "episodes_total": 400, "training_iteration": 10, "experiment_id": "f0134eced79d425ca17ebe3d2d0a9c1b", "date": "2021-03-09_10-45-42", "timestamp": 1615283142, "time_this_iter_s": 10.47731876373291, "time_total_s": 116.74414682388306, "pid": 4108, "hostname": "ray02", "node_ip": "131.234.28.177", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "env_config": {"episode_length": 100, "seed": null, "map": "150x100map", "bs_list": ["A", "B"], "ue_list": ["1", "2"], "rand_episodes": false, "new_ue_interval": null, "reward": "sum", "log_metrics": true}, "env": "MultiAgentMobileEnv", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": true, "log_level": "WARN", "callbacks": "<class 'deepcomp.util.callbacks.CustomMetricCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"ue": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Dict(connected:MultiBinary(2), dr:Box(0.0, 1.0, (2,), float32), ues_at_bs:Box(0.0, 1.0, (2,), float32), utility:Box(-1.0, 1.0, (1,), float32))", "Discrete(3)", {}]}, "policy_mapping_fn": "<function create_env_config.<locals>.<lambda> at 0x7f6b55482e50>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 116.74414682388306, "timesteps_since_restore": 0, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 28.30666666666667, "ram_util_percent": 4.799999999999999}, "trial_id": "e359b_00000"}
{"episode_reward_max": 152.0984738415607, "episode_reward_min": 118.77206257450487, "episode_reward_mean": 140.67794894614008, "episode_len_mean": 100.0, "episodes_this_iter": 40, "policy_reward_min": {"ue": 57.31171405312055}, "policy_reward_max": {"ue": 76.04923692078032}, "policy_reward_mean": {"ue": 70.33897447307}, "custom_metrics": {"sum_utility_mean": 14.39202927837289, "sum_utility_min": -14.42798039285342, "sum_utility_max": 21.310345226162607, "eps_sum_utility_mean": 1464.2478468089885, "eps_sum_utility_min": 1161.5458473903307, "eps_sum_utility_max": 1612.8176960004425}, "hist_stats": {"episode_reward": [139.87721945133796, 141.45400727176644, 140.5141097960452, 130.9461686378143, 130.03498234482635, 152.0984738415607, 139.68144848998293, 135.6417017769466, 137.59563052341912, 142.6763567186374, 140.88096596119152, 130.77422512197643, 136.26527383644898, 138.86378595923213, 140.60886505015282, 131.98623850727338, 141.62166071180167, 149.558004886211, 144.67230336618098, 144.25923656254773, 140.03266313074317, 143.08603981394214, 136.81322518465166, 143.09817926164607, 138.6988729838435, 139.58942898058643, 149.5121930655335, 137.14826277743379, 141.28117369415267, 139.80868815875226, 141.1436674245926, 142.42799157116502, 142.35081418096837, 137.0566830192655, 142.29371419414412, 138.06683323378107, 144.6456661528809, 140.4659697155498, 144.46218079718955, 133.2388252550772, 137.1249966014476, 136.4879231333927, 147.15502171869826, 136.0517057375799, 145.3456566302662, 143.47892888614786, 137.29433569856297, 137.7185275675959, 137.59446258576497, 137.9424307866367, 142.9132903010664, 139.53696402957127, 142.88860560423592, 135.97486684944977, 134.0418235397809, 139.18218179205405, 140.65405522911135, 142.5073147452474, 144.49870919060157, 140.23511501806217, 148.85240728100842, 145.94817299240367, 143.6517044150719, 141.5599968037754, 130.1979103856039, 142.21217664190476, 143.3686528816816, 143.2589014921457, 139.57213748956576, 144.96514036074865, 118.77206257450487, 140.17417154511577, 140.92588255537805, 141.9243153096075, 146.63370899849446, 138.72047967646233, 138.2427631065679, 132.7681010813555, 145.76540999328017, 147.3640784355028, 138.36141422000503, 140.82797831740137, 149.03034737559696, 143.01725439525666, 146.50003505922388, 142.3701047438965, 144.43422596653886, 140.45621607327263, 143.88052619688983, 144.87818357886317, 145.35668755634651, 142.71440246589117, 140.87918904211256, 147.78817423674292, 140.25198670530114, 136.18904596507127, 141.08905684748305, 137.38540898468375, 144.49794685733272, 139.14988894939148], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_ue_reward": [70.42149445225176, 69.45572499908616, 70.72700363588318, 70.72700363588318, 70.25705489802257, 70.25705489802257, 65.60016314405554, 65.34600549375882, 66.42317097791889, 63.611811366907475, 76.04923692078032, 76.04923692078032, 69.20142375481272, 70.48002473517006, 68.74364596739618, 66.89805580955037, 67.20638275416043, 70.38924776925853, 70.54246210554419, 72.13389461309326, 68.84905047304665, 72.03191548814476, 62.5170790730818, 68.2571460488946, 70.49044874110054, 65.77482509534836, 67.99687623566285, 70.86690972356924, 68.0736995273486, 72.53516552280405, 65.38315570190562, 66.60308280536795, 69.37581361194759, 72.24584709985399, 74.77900244310543, 74.77900244310543, 72.30681474464296, 72.36548862153793, 73.72105078882294, 70.5381857737248, 72.37414338824767, 67.65851974249549, 72.33873616074553, 70.74730365319647, 66.07813770789726, 70.73508747675442, 71.51975269237546, 71.57842656927045, 69.34943649192171, 69.34943649192171, 67.59331843101295, 71.9961105495734, 74.7560965327668, 74.7560965327668, 71.57124370177158, 65.57701907566207, 72.99839866995244, 68.28277502420025, 72.29149284069965, 67.51719531805244, 71.3675499660708, 69.77611745852177, 70.44761647025545, 71.98037510090951, 72.73750265958574, 69.6133115213826, 70.85681639406128, 66.1998666252041, 71.9425733508465, 70.35114084329743, 67.44198410934145, 70.62484912443955, 71.5271168226659, 73.11854933021495, 68.67088928867332, 71.79508042687647, 71.46471108326774, 72.99746971392182, 65.98011213735994, 67.25871311771726, 69.35821455449832, 67.76678204694926, 68.21462462824886, 68.27329850514386, 75.16894336689813, 71.98607835180002, 67.35721544016381, 68.69449029741612, 72.67282831513305, 72.67282831513305, 71.10016395289517, 72.37876493325251, 69.44288410305593, 67.85145159550689, 67.26783127624887, 70.45069629134699, 71.98009630798056, 65.61436627778434, 70.43556907571904, 67.50686171091766, 70.78800772190702, 72.12528257915935, 66.9277854653266, 72.60917856424442, 70.64858654834345, 72.24001905589252, 68.7538127400519, 67.22105410939783, 67.81662802366496, 66.2251955161159, 71.18252340357604, 67.99965838847795, 71.8891231836572, 68.76493204545407, 71.89295786280229, 70.61435688244497, 72.24935459530073, 72.24935459530073, 69.3218412552565, 70.91327376280555, 75.06550413068278, 73.78690315032544, 70.77269043692152, 75.17548255548198, 72.62156846131037, 71.03013595376129, 70.11136097326155, 71.44863583051388, 67.32968819052971, 62.868222195074274, 70.18329324202946, 72.02888339987527, 72.32362693101945, 71.04502595066211, 74.01659950739632, 69.24230198474918, 71.31882737543692, 68.2533101141288, 71.8432696901956, 73.12187067055292, 57.31171405312055, 61.46034852138427, 70.08708577255784, 70.08708577255784, 68.26154521840873, 72.66433733696918, 70.80574189120792, 71.11857341839963, 73.31685449924723, 73.31685449924723, 67.95456003272541, 70.76591964373682, 68.32566529950931, 69.91709780705837, 67.78973034618343, 64.97837073517206, 72.88270499664007, 72.88270499664007, 73.68203921775132, 73.68203921775132, 69.21004404845003, 69.15137017155504, 69.61827290492617, 71.20970541247526, 73.71945743402391, 75.31088994157297, 69.91719469007924, 73.10005970517736, 73.40643329320775, 73.09360176601604, 71.95143168727529, 70.41867305662123, 72.21711298326936, 72.21711298326937, 70.22810803663626, 70.22810803663626, 70.40750446779082, 73.47302172909895, 72.46842872787894, 72.40975485098394, 71.91196446284616, 73.44472309350023, 69.795105663844, 72.91929680204711, 70.41025758260868, 70.46893145950368, 75.48551962592043, 72.30265461082233, 70.28240911624633, 69.9695775890546, 67.17172790361272, 69.0173180614585, 73.66871956194464, 67.4203372855384, 70.7376847880262, 66.64772419665748, 72.9176108572925, 71.58033600004019, 71.13704004379731, 68.01284890559418]}, "sampler_perf": {"mean_env_wait_ms": 11.366812895315393, "mean_raw_obs_processing_ms": 0.5007491074703951, "mean_inference_ms": 6.089514844713033, "mean_action_processing_ms": 0.14531507053684176}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 44000, "timers": {"sample_time_ms": 3712.729, "sample_throughput": 1077.375, "load_time_ms": 3.591, "load_throughput": 1113743.942, "learn_time_ms": 7035.521, "learn_throughput": 568.544, "update_time_ms": 11.383}, "info": {"learner": {"ue": {"cur_kl_coeff": 0.15000000596046448, "cur_lr": 4.999999873689376e-05, "total_loss": 160.69224548339844, "policy_loss": -0.006289539858698845, "vf_loss": 160.69699096679688, "vf_explained_var": 0.015067027881741524, "kl": 0.01007678359746933, "entropy": 0.8611096739768982, "entropy_coeff": 0.0, "model": {}}}, "num_steps_sampled": 44000, "num_steps_trained": 44000}, "done": false, "episodes_total": 440, "training_iteration": 11, "experiment_id": "f0134eced79d425ca17ebe3d2d0a9c1b", "date": "2021-03-09_10-45-53", "timestamp": 1615283153, "time_this_iter_s": 10.298486471176147, "time_total_s": 127.0426332950592, "pid": 4108, "hostname": "ray02", "node_ip": "131.234.28.177", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "env_config": {"episode_length": 100, "seed": null, "map": "150x100map", "bs_list": ["A", "B"], "ue_list": ["1", "2"], "rand_episodes": false, "new_ue_interval": null, "reward": "sum", "log_metrics": true}, "env": "MultiAgentMobileEnv", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": true, "log_level": "WARN", "callbacks": "<class 'deepcomp.util.callbacks.CustomMetricCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"ue": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Dict(connected:MultiBinary(2), dr:Box(0.0, 1.0, (2,), float32), ues_at_bs:Box(0.0, 1.0, (2,), float32), utility:Box(-1.0, 1.0, (1,), float32))", "Discrete(3)", {}]}, "policy_mapping_fn": "<function create_env_config.<locals>.<lambda> at 0x7f6b55482b80>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 127.0426332950592, "timesteps_since_restore": 0, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 26.207142857142856, "ram_util_percent": 4.799999999999999}, "trial_id": "e359b_00000"}
{"episode_reward_max": 153.01058127092278, "episode_reward_min": 130.03498234482635, "episode_reward_mean": 140.9161109847067, "episode_len_mean": 100.0, "episodes_this_iter": 40, "policy_reward_min": {"ue": 62.5170790730818}, "policy_reward_max": {"ue": 77.30100688923586}, "policy_reward_mean": {"ue": 70.45805549235332}, "custom_metrics": {"sum_utility_mean": 14.550939422353885, "sum_utility_min": -14.42798039285342, "sum_utility_max": 21.310345226162607, "eps_sum_utility_mean": 1465.4724182739308, "eps_sum_utility_min": 1325.6997729847787, "eps_sum_utility_max": 1616.8335382965154}, "hist_stats": {"episode_reward": [146.98514072215664, 135.22967722172598, 142.3592779852616, 141.908361924693, 143.20680769383358, 135.37334760798115, 142.40840111609032, 134.24625170406898, 146.10290284505845, 140.95577362705598, 135.62917521550094, 140.06797029236373, 133.52339423733395, 137.04308605021652, 142.6739856508321, 133.0796769577903, 143.10044198763427, 137.44590141334152, 138.033589367081, 145.46914565142237, 138.96401743935104, 136.87795255776388, 142.9986335953214, 139.51244643349784, 144.2306889797909, 135.25412754911338, 138.20470771740838, 131.6313211837576, 153.01058127092278, 152.88885327324846, 141.88888119875963, 144.28143928059563, 142.73822224021615, 136.8728660933565, 144.51437382800202, 145.11477477571657, 144.22318517520472, 151.02020322213764, 139.47132595095877, 138.78038248555094, 138.36141422000503, 140.82797831740137, 149.03034737559696, 143.01725439525666, 146.50003505922388, 142.3701047438965, 144.43422596653886, 140.45621607327263, 143.88052619688983, 144.87818357886317, 145.35668755634651, 142.71440246589117, 140.87918904211256, 147.78817423674292, 140.25198670530114, 136.18904596507127, 141.08905684748305, 137.38540898468375, 144.49794685733272, 139.14988894939148, 139.87721945133796, 141.45400727176644, 140.5141097960452, 130.9461686378143, 130.03498234482635, 152.0984738415607, 139.68144848998293, 135.6417017769466, 137.59563052341912, 142.6763567186374, 140.88096596119152, 130.77422512197643, 136.26527383644898, 138.86378595923213, 140.60886505015282, 131.98623850727338, 141.62166071180167, 149.558004886211, 144.67230336618098, 144.25923656254773, 140.03266313074317, 143.08603981394214, 136.81322518465166, 143.09817926164607, 138.6988729838435, 139.58942898058643, 149.5121930655335, 137.14826277743379, 141.28117369415267, 139.80868815875226, 141.1436674245926, 142.42799157116502, 142.35081418096837, 137.0566830192655, 142.29371419414412, 138.06683323378107, 144.6456661528809, 140.4659697155498, 144.46218079718955, 133.2388252550772], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_ue_reward": [73.49257036107831, 73.49257036107831, 69.84557160859069, 65.38410561313523, 70.38392273885623, 71.97535524640529, 70.15846470857198, 71.74989721612104, 71.6034038469167, 71.60340384691672, 67.53025804039467, 67.84308956758639, 71.20420055804512, 71.20420055804512, 69.45160073646315, 64.79465096760593, 72.2850721072021, 73.81783073785613, 69.19928583317059, 71.75648779388527, 68.48322503637661, 67.14595017912427, 72.3917969690579, 67.67617332330573, 67.55741337244149, 65.96598086489243, 69.28792234043536, 67.75516370978129, 70.54127657164149, 72.13270907919055, 68.22901287314508, 64.8506640846452, 71.55022099381713, 71.55022099381713, 67.92723445289623, 69.51866696044526, 68.9874577450929, 69.0461316219879, 71.93885657193661, 73.53028907948567, 68.84270822949684, 70.12130920985416, 69.23469253265642, 67.64326002510737, 71.49931679766061, 71.49931679766061, 68.98984390142186, 70.52260253207592, 70.5239119823463, 73.70677699744442, 67.5977268361092, 67.65640071300419, 69.13169079715159, 69.07301692025659, 65.1763601017001, 66.45496108205742, 77.30100688923586, 75.70957438168679, 76.44442663662414, 76.44442663662414, 70.14872434560525, 71.7401568531543, 71.3450033865233, 72.93643589407236, 70.57339486633353, 72.16482737388259, 64.7706833049973, 72.10218278835914, 73.05290316777547, 71.4614706602264, 72.55738738785827, 72.55738738785827, 72.08225564915482, 72.14092952604979, 75.5101016110687, 75.5101016110687, 68.93994672170476, 70.5313792292538, 69.36085430432797, 69.41952818122296, 69.21004404845003, 69.15137017155504, 69.61827290492617, 71.20970541247526, 73.71945743402391, 75.31088994157297, 69.91719469007924, 73.10005970517736, 73.40643329320775, 73.09360176601604, 71.95143168727529, 70.41867305662123, 72.21711298326936, 72.21711298326937, 70.22810803663626, 70.22810803663626, 70.40750446779082, 73.47302172909895, 72.46842872787894, 72.40975485098394, 71.91196446284616, 73.44472309350023, 69.795105663844, 72.91929680204711, 70.41025758260868, 70.46893145950368, 75.48551962592043, 72.30265461082233, 70.28240911624633, 69.9695775890546, 67.17172790361272, 69.0173180614585, 73.66871956194464, 67.4203372855384, 70.7376847880262, 66.64772419665748, 72.9176108572925, 71.58033600004019, 71.13704004379731, 68.01284890559418, 70.42149445225176, 69.45572499908616, 70.72700363588318, 70.72700363588318, 70.25705489802257, 70.25705489802257, 65.60016314405554, 65.34600549375882, 66.42317097791889, 63.611811366907475, 76.04923692078032, 76.04923692078032, 69.20142375481272, 70.48002473517006, 68.74364596739618, 66.89805580955037, 67.20638275416043, 70.38924776925853, 70.54246210554419, 72.13389461309326, 68.84905047304665, 72.03191548814476, 62.5170790730818, 68.2571460488946, 70.49044874110054, 65.77482509534836, 67.99687623566285, 70.86690972356924, 68.0736995273486, 72.53516552280405, 65.38315570190562, 66.60308280536795, 69.37581361194759, 72.24584709985399, 74.77900244310543, 74.77900244310543, 72.30681474464296, 72.36548862153793, 73.72105078882294, 70.5381857737248, 72.37414338824767, 67.65851974249549, 72.33873616074553, 70.74730365319647, 66.07813770789726, 70.73508747675442, 71.51975269237546, 71.57842656927045, 69.34943649192171, 69.34943649192171, 67.59331843101295, 71.9961105495734, 74.7560965327668, 74.7560965327668, 71.57124370177158, 65.57701907566207, 72.99839866995244, 68.28277502420025, 72.29149284069965, 67.51719531805244, 71.3675499660708, 69.77611745852177, 70.44761647025545, 71.98037510090951, 72.73750265958574, 69.6133115213826, 70.85681639406128, 66.1998666252041, 71.9425733508465, 70.35114084329743, 67.44198410934145, 70.62484912443955, 71.5271168226659, 73.11854933021495, 68.67088928867332, 71.79508042687647, 71.46471108326774, 72.99746971392182, 65.98011213735994, 67.25871311771726]}, "sampler_perf": {"mean_env_wait_ms": 11.288702920393792, "mean_raw_obs_processing_ms": 0.4924101691024048, "mean_inference_ms": 6.003281853222362, "mean_action_processing_ms": 0.14413191295172123}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 48000, "timers": {"sample_time_ms": 3622.374, "sample_throughput": 1104.248, "load_time_ms": 3.692, "load_throughput": 1083393.561, "learn_time_ms": 7015.27, "learn_throughput": 570.185, "update_time_ms": 10.931}, "info": {"learner": {"ue": {"cur_kl_coeff": 0.15000000596046448, "cur_lr": 4.999999873689376e-05, "total_loss": 164.15684509277344, "policy_loss": -0.005900082178413868, "vf_loss": 164.16152954101562, "vf_explained_var": 0.013445277698338032, "kl": 0.008181177079677582, "entropy": 0.825046181678772, "entropy_coeff": 0.0, "model": {}}}, "num_steps_sampled": 48000, "num_steps_trained": 48000}, "done": false, "episodes_total": 480, "training_iteration": 12, "experiment_id": "f0134eced79d425ca17ebe3d2d0a9c1b", "date": "2021-03-09_10-46-04", "timestamp": 1615283164, "time_this_iter_s": 10.830249309539795, "time_total_s": 137.872882604599, "pid": 4108, "hostname": "ray02", "node_ip": "131.234.28.177", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "env_config": {"episode_length": 100, "seed": null, "map": "150x100map", "bs_list": ["A", "B"], "ue_list": ["1", "2"], "rand_episodes": false, "new_ue_interval": null, "reward": "sum", "log_metrics": true}, "env": "MultiAgentMobileEnv", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": true, "log_level": "WARN", "callbacks": "<class 'deepcomp.util.callbacks.CustomMetricCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"ue": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Dict(connected:MultiBinary(2), dr:Box(0.0, 1.0, (2,), float32), ues_at_bs:Box(0.0, 1.0, (2,), float32), utility:Box(-1.0, 1.0, (1,), float32))", "Discrete(3)", {}]}, "policy_mapping_fn": "<function create_env_config.<locals>.<lambda> at 0x7f6b553b7a60>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 137.872882604599, "timesteps_since_restore": 0, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 27.066666666666666, "ram_util_percent": 4.799999999999999}, "trial_id": "e359b_00000"}
{"episode_reward_max": 153.82659775331774, "episode_reward_min": 131.6313211837576, "episode_reward_mean": 142.23861542405788, "episode_len_mean": 100.0, "episodes_this_iter": 40, "policy_reward_min": {"ue": 64.7706833049973}, "policy_reward_max": {"ue": 77.30100688923586}, "policy_reward_mean": {"ue": 71.1193077120289}, "custom_metrics": {"sum_utility_mean": 14.730749723624488, "sum_utility_min": -9.344827386918697, "sum_utility_max": 21.310345226162607, "eps_sum_utility_mean": 1480.1717237924458, "eps_sum_utility_min": 1325.6997729847787, "eps_sum_utility_max": 1616.8335382965154}, "hist_stats": {"episode_reward": [140.4760656554592, 152.43379373065147, 147.92317063338805, 146.4535396750249, 153.82659775331774, 138.50470719199768, 139.75655200734477, 142.49273509007054, 142.91829889648017, 139.81030333093548, 138.9761075522128, 147.24237894759028, 136.982479248252, 142.9211281932752, 140.7612073573559, 140.28899028228324, 148.79282788938536, 139.07826063826997, 144.55743892101276, 139.12003547068247, 150.27651471777983, 149.63689680891537, 135.81036870498923, 145.78812114800553, 148.88045095397246, 144.6565223710378, 143.5527203875639, 144.1700492066214, 141.87318603890083, 136.81606956873293, 145.91472662790787, 143.42741726402863, 149.12923399688663, 149.428038484115, 150.66531235416795, 144.85993134478923, 146.7090529698072, 146.17109965340956, 145.92690260010448, 144.30994262104713, 140.03266313074317, 143.08603981394214, 136.81322518465166, 143.09817926164607, 138.6988729838435, 139.58942898058643, 149.5121930655335, 137.14826277743379, 141.28117369415267, 139.80868815875226, 141.1436674245926, 142.42799157116502, 142.35081418096837, 137.0566830192655, 142.29371419414412, 138.06683323378107, 144.6456661528809, 140.4659697155498, 144.46218079718955, 133.2388252550772, 146.98514072215664, 135.22967722172598, 142.3592779852616, 141.908361924693, 143.20680769383358, 135.37334760798115, 142.40840111609032, 134.24625170406898, 146.10290284505845, 140.95577362705598, 135.62917521550094, 140.06797029236373, 133.52339423733395, 137.04308605021652, 142.6739856508321, 133.0796769577903, 143.10044198763427, 137.44590141334152, 138.033589367081, 145.46914565142237, 138.96401743935104, 136.87795255776388, 142.9986335953214, 139.51244643349784, 144.2306889797909, 135.25412754911338, 138.20470771740838, 131.6313211837576, 153.01058127092278, 152.88885327324846, 141.88888119875963, 144.28143928059563, 142.73822224021615, 136.8728660933565, 144.51437382800202, 145.11477477571657, 144.22318517520472, 151.02020322213764, 139.47132595095877, 138.78038248555094], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_ue_reward": [71.0044121430566, 69.47165351240254, 76.98327618065278, 75.45051754999872, 73.96158531669388, 73.96158531669388, 73.22676983751238, 73.22676983751238, 76.91329887665877, 76.91329887665877, 67.71959496534478, 70.7851122266529, 69.87827600367234, 69.87827600367237, 72.83780005258426, 69.65493503748614, 72.25486570201467, 70.66343319446561, 71.4965841730167, 68.3137191579186, 70.25443309143336, 68.7216744607793, 74.41690572756958, 72.82547322002053, 68.17840809693423, 68.8040711513177, 70.66484784286305, 72.2562803504121, 70.38060367867791, 70.38060367867791, 68.73881533563593, 71.55017494664732, 73.60069769091804, 75.1921301984671, 69.0562455925522, 70.02201504571781, 70.71662389140472, 73.84081502960787, 69.53068079689372, 69.58935467378872, 75.13825735888979, 75.13825735888979, 75.45774889463632, 74.179147914279, 67.93452129094203, 67.87584741404704, 72.89406057400281, 72.89406057400281, 74.44022547698613, 74.44022547698613, 71.56188187019173, 73.09464050084581, 71.74702325533441, 71.8056971322294, 72.05568766486307, 72.11436154175806, 70.78017725585447, 71.09300878304622, 68.37869784591894, 68.43737172281394, 75.31517513682992, 70.59955149107772, 70.9473293166874, 72.48008794734146, 75.33099631377027, 73.79823768311621, 74.71401924205746, 74.71401924205746, 75.33265617708386, 75.33265617708386, 73.19634498772159, 71.6635863570675, 72.58814716957659, 74.12090580023064, 73.24196559030062, 72.92913406310889, 72.13839810783011, 73.78850449227417, 71.51567082034484, 72.79427180070216, 72.37414338824767, 67.65851974249549, 72.33873616074553, 70.74730365319647, 66.07813770789726, 70.73508747675442, 71.51975269237546, 71.57842656927045, 69.34943649192171, 69.34943649192171, 67.59331843101295, 71.9961105495734, 74.7560965327668, 74.7560965327668, 71.57124370177158, 65.57701907566207, 72.99839866995244, 68.28277502420025, 72.29149284069965, 67.51719531805244, 71.3675499660708, 69.77611745852177, 70.44761647025545, 71.98037510090951, 72.73750265958574, 69.6133115213826, 70.85681639406128, 66.1998666252041, 71.9425733508465, 70.35114084329743, 67.44198410934145, 70.62484912443955, 71.5271168226659, 73.11854933021495, 68.67088928867332, 71.79508042687647, 71.46471108326774, 72.99746971392182, 65.98011213735994, 67.25871311771726, 73.49257036107831, 73.49257036107831, 69.84557160859069, 65.38410561313523, 70.38392273885623, 71.97535524640529, 70.15846470857198, 71.74989721612104, 71.6034038469167, 71.60340384691672, 67.53025804039467, 67.84308956758639, 71.20420055804512, 71.20420055804512, 69.45160073646315, 64.79465096760593, 72.2850721072021, 73.81783073785613, 69.19928583317059, 71.75648779388527, 68.48322503637661, 67.14595017912427, 72.3917969690579, 67.67617332330573, 67.55741337244149, 65.96598086489243, 69.28792234043536, 67.75516370978129, 70.54127657164149, 72.13270907919055, 68.22901287314508, 64.8506640846452, 71.55022099381713, 71.55022099381713, 67.92723445289623, 69.51866696044526, 68.9874577450929, 69.0461316219879, 71.93885657193661, 73.53028907948567, 68.84270822949684, 70.12130920985416, 69.23469253265642, 67.64326002510737, 71.49931679766061, 71.49931679766061, 68.98984390142186, 70.52260253207592, 70.5239119823463, 73.70677699744442, 67.5977268361092, 67.65640071300419, 69.13169079715159, 69.07301692025659, 65.1763601017001, 66.45496108205742, 77.30100688923586, 75.70957438168679, 76.44442663662414, 76.44442663662414, 70.14872434560525, 71.7401568531543, 71.3450033865233, 72.93643589407236, 70.57339486633353, 72.16482737388259, 64.7706833049973, 72.10218278835914, 73.05290316777547, 71.4614706602264, 72.55738738785827, 72.55738738785827, 72.08225564915482, 72.14092952604979, 75.5101016110687, 75.5101016110687, 68.93994672170476, 70.5313792292538, 69.36085430432797, 69.41952818122296]}, "sampler_perf": {"mean_env_wait_ms": 11.207139211018653, "mean_raw_obs_processing_ms": 0.4866838465069552, "mean_inference_ms": 5.928653169092542, "mean_action_processing_ms": 0.14405756942881875}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 52000, "timers": {"sample_time_ms": 3602.191, "sample_throughput": 1110.435, "load_time_ms": 3.67, "load_throughput": 1089988.76, "learn_time_ms": 6938.22, "learn_throughput": 576.517, "update_time_ms": 10.517}, "info": {"learner": {"ue": {"cur_kl_coeff": 0.15000000596046448, "cur_lr": 4.999999873689376e-05, "total_loss": 172.34255981445312, "policy_loss": -0.005059340503066778, "vf_loss": 172.3462677001953, "vf_explained_var": 0.013662528246641159, "kl": 0.009105321951210499, "entropy": 0.763152003288269, "entropy_coeff": 0.0, "model": {}}}, "num_steps_sampled": 52000, "num_steps_trained": 52000}, "done": false, "episodes_total": 520, "training_iteration": 13, "experiment_id": "f0134eced79d425ca17ebe3d2d0a9c1b", "date": "2021-03-09_10-46-14", "timestamp": 1615283174, "time_this_iter_s": 10.006989479064941, "time_total_s": 147.87987208366394, "pid": 4108, "hostname": "ray02", "node_ip": "131.234.28.177", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "env_config": {"episode_length": 100, "seed": null, "map": "150x100map", "bs_list": ["A", "B"], "ue_list": ["1", "2"], "rand_episodes": false, "new_ue_interval": null, "reward": "sum", "log_metrics": true}, "env": "MultiAgentMobileEnv", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": true, "log_level": "WARN", "callbacks": "<class 'deepcomp.util.callbacks.CustomMetricCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"ue": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Dict(connected:MultiBinary(2), dr:Box(0.0, 1.0, (2,), float32), ues_at_bs:Box(0.0, 1.0, (2,), float32), utility:Box(-1.0, 1.0, (1,), float32))", "Discrete(3)", {}]}, "policy_mapping_fn": "<function create_env_config.<locals>.<lambda> at 0x7f6b553b7ee0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 147.87987208366394, "timesteps_since_restore": 0, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 28.21428571428572, "ram_util_percent": 4.799999999999999}, "trial_id": "e359b_00000"}
{"episode_reward_max": 154.84316236753915, "episode_reward_min": 131.6313211837576, "episode_reward_mean": 144.82535830932372, "episode_len_mean": 100.0, "episodes_this_iter": 40, "policy_reward_min": {"ue": 64.01588092593772}, "policy_reward_max": {"ue": 77.79188974101208}, "policy_reward_mean": {"ue": 72.41267915466182}, "custom_metrics": {"sum_utility_mean": 15.02117726301669, "sum_utility_min": -8.171349849018874, "sum_utility_max": 21.310345226162607, "eps_sum_utility_mean": 1507.1666707694635, "eps_sum_utility_min": 1298.228515088547, "eps_sum_utility_max": 1617.4919391209257}, "hist_stats": {"episode_reward": [145.05422952527653, 148.97266099371194, 152.70413353647734, 148.87056393229165, 143.48941588699307, 143.75287803710904, 148.1662719474039, 143.3915037077893, 146.49881519421885, 147.09851988890767, 144.07278386903863, 147.0806115720684, 148.39247695927224, 146.7806268561294, 134.67735222753765, 154.05102085137048, 148.68464374607282, 152.61896720079176, 138.5403607611284, 152.38378014664465, 154.84316236753915, 147.57646701848597, 147.17725335863105, 150.17855920539495, 150.62986132957042, 152.2252491172668, 139.02179551036858, 148.48446537962548, 150.4443264070241, 131.86756479294752, 151.63695982206838, 146.78755656903252, 146.70443936974385, 143.67444945094456, 143.56986507069576, 146.94681002371146, 142.93356703959614, 148.2733201242948, 143.68352012611922, 146.79686147063273, 138.96401743935104, 136.87795255776388, 142.9986335953214, 139.51244643349784, 144.2306889797909, 135.25412754911338, 138.20470771740838, 131.6313211837576, 153.01058127092278, 152.88885327324846, 141.88888119875963, 144.28143928059563, 142.73822224021615, 136.8728660933565, 144.51437382800202, 145.11477477571657, 144.22318517520472, 151.02020322213764, 139.47132595095877, 138.78038248555094, 140.4760656554592, 152.43379373065147, 147.92317063338805, 146.4535396750249, 153.82659775331774, 138.50470719199768, 139.75655200734477, 142.49273509007054, 142.91829889648017, 139.81030333093548, 138.9761075522128, 147.24237894759028, 136.982479248252, 142.9211281932752, 140.7612073573559, 140.28899028228324, 148.79282788938536, 139.07826063826997, 144.55743892101276, 139.12003547068247, 150.27651471777983, 149.63689680891537, 135.81036870498923, 145.78812114800553, 148.88045095397246, 144.6565223710378, 143.5527203875639, 144.1700492066214, 141.87318603890083, 136.81606956873293, 145.91472662790787, 143.42741726402863, 149.12923399688663, 149.428038484115, 150.66531235416795, 144.85993134478923, 146.7090529698072, 146.17109965340956, 145.92690260010448, 144.30994262104713], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_ue_reward": [70.93568225508913, 74.11854727018722, 75.28204675063047, 73.6906142430814, 76.35206676823856, 76.35206676823856, 73.63956571237124, 75.23099821992032, 70.94899168972196, 72.54042419727101, 70.28500651100543, 73.46787152610355, 72.64811922974864, 75.51815271765506, 72.46213116922172, 70.92937253856766, 73.40582336070516, 73.09299183351342, 73.54925994445381, 73.54925994445381, 72.03639193451929, 72.0363919345193, 75.1024013551357, 71.97821021693255, 74.83553896981466, 73.55693798945734, 74.3131085069875, 72.46751834914171, 68.13439236754328, 66.54295985999423, 77.79188974101208, 76.25913111035801, 73.54660561926177, 75.13803812681083, 76.30948360039581, 76.30948360039581, 68.63087989038544, 69.90948087074277, 76.19189007332223, 76.19189007332223, 77.42158118376945, 77.42158118376945, 73.94464927283872, 73.63181774564697, 74.38434293309001, 72.79291042554095, 74.29356334892287, 75.88499585647193, 74.51921441101052, 76.1106469185596, 75.3169083048587, 76.90834081240777, 70.30661400895885, 68.71518150140979, 73.60293219963394, 74.88153317999127, 75.22216320351201, 75.22216320351201, 64.01588092593772, 67.85168386700974, 75.8184799110341, 75.8184799110341, 73.36444134606869, 73.42311522296369, 74.1479359386464, 72.55650343109734, 72.6329409792468, 71.04150847169774, 70.98921628157333, 72.5806487891224, 75.00616364250973, 71.94064638120159, 71.46678351979799, 71.46678351979799, 74.13666006214737, 74.13666006214737, 72.60813937838658, 71.07538074773251, 73.39843073531627, 73.39843073531627, 68.84270822949684, 70.12130920985416, 69.23469253265642, 67.64326002510737, 71.49931679766061, 71.49931679766061, 68.98984390142186, 70.52260253207592, 70.5239119823463, 73.70677699744442, 67.5977268361092, 67.65640071300419, 69.13169079715159, 69.07301692025659, 65.1763601017001, 66.45496108205742, 77.30100688923586, 75.70957438168679, 76.44442663662414, 76.44442663662414, 70.14872434560525, 71.7401568531543, 71.3450033865233, 72.93643589407236, 70.57339486633353, 72.16482737388259, 64.7706833049973, 72.10218278835914, 73.05290316777547, 71.4614706602264, 72.55738738785827, 72.55738738785827, 72.08225564915482, 72.14092952604979, 75.5101016110687, 75.5101016110687, 68.93994672170476, 70.5313792292538, 69.36085430432797, 69.41952818122296, 71.0044121430566, 69.47165351240254, 76.98327618065278, 75.45051754999872, 73.96158531669388, 73.96158531669388, 73.22676983751238, 73.22676983751238, 76.91329887665877, 76.91329887665877, 67.71959496534478, 70.7851122266529, 69.87827600367234, 69.87827600367237, 72.83780005258426, 69.65493503748614, 72.25486570201467, 70.66343319446561, 71.4965841730167, 68.3137191579186, 70.25443309143336, 68.7216744607793, 74.41690572756958, 72.82547322002053, 68.17840809693423, 68.8040711513177, 70.66484784286305, 72.2562803504121, 70.38060367867791, 70.38060367867791, 68.73881533563593, 71.55017494664732, 73.60069769091804, 75.1921301984671, 69.0562455925522, 70.02201504571781, 70.71662389140472, 73.84081502960787, 69.53068079689372, 69.58935467378872, 75.13825735888979, 75.13825735888979, 75.45774889463632, 74.179147914279, 67.93452129094203, 67.87584741404704, 72.89406057400281, 72.89406057400281, 74.44022547698613, 74.44022547698613, 71.56188187019173, 73.09464050084581, 71.74702325533441, 71.8056971322294, 72.05568766486307, 72.11436154175806, 70.78017725585447, 71.09300878304622, 68.37869784591894, 68.43737172281394, 75.31517513682992, 70.59955149107772, 70.9473293166874, 72.48008794734146, 75.33099631377027, 73.79823768311621, 74.71401924205746, 74.71401924205746, 75.33265617708386, 75.33265617708386, 73.19634498772159, 71.6635863570675, 72.58814716957659, 74.12090580023064, 73.24196559030062, 72.92913406310889, 72.13839810783011, 73.78850449227417, 71.51567082034484, 72.79427180070216]}, "sampler_perf": {"mean_env_wait_ms": 11.133301435584363, "mean_raw_obs_processing_ms": 0.48551434645508584, "mean_inference_ms": 5.855000199877362, "mean_action_processing_ms": 0.14138667185626855}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 56000, "timers": {"sample_time_ms": 3555.749, "sample_throughput": 1124.939, "load_time_ms": 3.646, "load_throughput": 1096980.254, "learn_time_ms": 6909.258, "learn_throughput": 578.933, "update_time_ms": 11.787}, "info": {"learner": {"ue": {"cur_kl_coeff": 0.15000000596046448, "cur_lr": 4.999999873689376e-05, "total_loss": 177.74464416503906, "policy_loss": -0.0019000445026904345, "vf_loss": 177.74559020996094, "vf_explained_var": 0.012963172048330307, "kl": 0.00630300585180521, "entropy": 0.7383336424827576, "entropy_coeff": 0.0, "model": {}}}, "num_steps_sampled": 56000, "num_steps_trained": 56000}, "done": false, "episodes_total": 560, "training_iteration": 14, "experiment_id": "f0134eced79d425ca17ebe3d2d0a9c1b", "date": "2021-03-09_10-46-24", "timestamp": 1615283184, "time_this_iter_s": 10.269043684005737, "time_total_s": 158.14891576766968, "pid": 4108, "hostname": "ray02", "node_ip": "131.234.28.177", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "env_config": {"episode_length": 100, "seed": null, "map": "150x100map", "bs_list": ["A", "B"], "ue_list": ["1", "2"], "rand_episodes": false, "new_ue_interval": null, "reward": "sum", "log_metrics": true}, "env": "MultiAgentMobileEnv", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": true, "log_level": "WARN", "callbacks": "<class 'deepcomp.util.callbacks.CustomMetricCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"ue": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Dict(connected:MultiBinary(2), dr:Box(0.0, 1.0, (2,), float32), ues_at_bs:Box(0.0, 1.0, (2,), float32), utility:Box(-1.0, 1.0, (1,), float32))", "Discrete(3)", {}]}, "policy_mapping_fn": "<function create_env_config.<locals>.<lambda> at 0x7f6b553b74c0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 158.14891576766968, "timesteps_since_restore": 0, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 27.107142857142858, "ram_util_percent": 4.799999999999999}, "trial_id": "e359b_00000"}
{"episode_reward_max": 156.0774407523126, "episode_reward_min": 131.86756479294752, "episode_reward_mean": 147.21789849028076, "episode_len_mean": 100.0, "episodes_this_iter": 40, "policy_reward_min": {"ue": 64.01588092593772}, "policy_reward_max": {"ue": 78.03872037615616}, "policy_reward_mean": {"ue": 73.6089492451403}, "custom_metrics": {"sum_utility_mean": 15.205169192544906, "sum_utility_min": -8.171349849018874, "sum_utility_max": 21.310345226162607, "eps_sum_utility_mean": 1528.2429723096384, "eps_sum_utility_min": 1298.228515088547, "eps_sum_utility_max": 1638.4551440115583}, "hist_stats": {"episode_reward": [146.69473038320325, 145.05560444697164, 142.32136105452992, 149.1111443158017, 150.52812477807106, 141.6641514574057, 140.25987154647947, 152.73237827714416, 152.66460573822792, 153.22510471388898, 147.49370943056766, 147.10225964395772, 153.46536705853293, 150.0440798672014, 146.52142126913725, 151.3324425868592, 155.0109722999922, 147.71447347835505, 153.167365843703, 153.71727651919718, 144.34621650851403, 153.640902287656, 152.5799261287424, 150.25900414717938, 144.54120263735166, 148.11205561452368, 144.12753950773651, 147.58387953904457, 153.35593878377642, 143.69190429760937, 150.23165668716632, 145.93937745308324, 152.63313982735997, 146.52144103572482, 142.7212193346341, 148.03323327917934, 146.66626569104358, 156.0774407523126, 148.04154035116795, 146.11929223833022, 150.27651471777983, 149.63689680891537, 135.81036870498923, 145.78812114800553, 148.88045095397246, 144.6565223710378, 143.5527203875639, 144.1700492066214, 141.87318603890083, 136.81606956873293, 145.91472662790787, 143.42741726402863, 149.12923399688663, 149.428038484115, 150.66531235416795, 144.85993134478923, 146.7090529698072, 146.17109965340956, 145.92690260010448, 144.30994262104713, 145.05422952527653, 148.97266099371194, 152.70413353647734, 148.87056393229165, 143.48941588699307, 143.75287803710904, 148.1662719474039, 143.3915037077893, 146.49881519421885, 147.09851988890767, 144.07278386903863, 147.0806115720684, 148.39247695927224, 146.7806268561294, 134.67735222753765, 154.05102085137048, 148.68464374607282, 152.61896720079176, 138.5403607611284, 152.38378014664465, 154.84316236753915, 147.57646701848597, 147.17725335863105, 150.17855920539495, 150.62986132957042, 152.2252491172668, 139.02179551036858, 148.48446537962548, 150.4443264070241, 131.86756479294752, 151.63695982206838, 146.78755656903252, 146.70443936974385, 143.67444945094456, 143.56986507069576, 146.94681002371146, 142.93356703959614, 148.2733201242948, 143.68352012611922, 146.79686147063273], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_ue_reward": [72.70806470142288, 73.9866656817802, 73.29418153881267, 71.76142290815861, 70.52138003708625, 71.79998101744359, 73.91627166772211, 75.19487264807945, 74.46834613526087, 76.05977864280993, 71.62779198247723, 70.03635947492816, 67.64504512521528, 72.61482642126418, 76.3661891385719, 76.3661891385719, 77.09868218444088, 75.56592355378682, 75.81683610316988, 77.40826861071893, 73.74685471528373, 73.74685471528373, 72.75541356820432, 74.34684607575335, 76.73268352926632, 76.73268352926632, 74.2263236798261, 75.81775618737512, 74.0270899498956, 72.49433131924152, 75.66622129342946, 75.66622129342946, 77.50548614999599, 77.50548614999599, 73.8572367391774, 73.8572367391774, 77.35006223717845, 75.81730360652439, 77.65435451337301, 76.06292200582395, 72.01669249066111, 72.32952401785283, 76.82045114382791, 76.82045114382791, 77.05634237969814, 75.52358374904408, 74.97308630999369, 75.28591783718542, 71.50422200334873, 73.03698063400279, 74.05602780726176, 74.05602780726176, 72.22018551746413, 71.90735399027241, 73.15263927934356, 74.43124025970089, 75.91159007656101, 77.44434870721507, 72.64166840257926, 71.0502358950302, 75.11582834358316, 75.11582834358316, 72.9403517880941, 72.9990256649891, 76.31656991367984, 76.31656991367984, 74.05643677163694, 72.46500426408788, 72.28340474623992, 70.43781458839413, 73.25023732426253, 74.78299595491659, 74.12884909929627, 72.53741659174722, 78.03872037615616, 78.03872037615616, 74.81648642935848, 73.22505392180942, 73.82602543449208, 72.29326680383801, 75.13825735888979, 75.13825735888979, 75.45774889463632, 74.179147914279, 67.93452129094203, 67.87584741404704, 72.89406057400281, 72.89406057400281, 74.44022547698613, 74.44022547698613, 71.56188187019173, 73.09464050084581, 71.74702325533441, 71.8056971322294, 72.05568766486307, 72.11436154175806, 70.78017725585447, 71.09300878304622, 68.37869784591894, 68.43737172281394, 75.31517513682992, 70.59955149107772, 70.9473293166874, 72.48008794734146, 75.33099631377027, 73.79823768311621, 74.71401924205746, 74.71401924205746, 75.33265617708386, 75.33265617708386, 73.19634498772159, 71.6635863570675, 72.58814716957659, 74.12090580023064, 73.24196559030062, 72.92913406310889, 72.13839810783011, 73.78850449227417, 71.51567082034484, 72.79427180070216, 70.93568225508913, 74.11854727018722, 75.28204675063047, 73.6906142430814, 76.35206676823856, 76.35206676823856, 73.63956571237124, 75.23099821992032, 70.94899168972196, 72.54042419727101, 70.28500651100543, 73.46787152610355, 72.64811922974864, 75.51815271765506, 72.46213116922172, 70.92937253856766, 73.40582336070516, 73.09299183351342, 73.54925994445381, 73.54925994445381, 72.03639193451929, 72.0363919345193, 75.1024013551357, 71.97821021693255, 74.83553896981466, 73.55693798945734, 74.3131085069875, 72.46751834914171, 68.13439236754328, 66.54295985999423, 77.79188974101208, 76.25913111035801, 73.54660561926177, 75.13803812681083, 76.30948360039581, 76.30948360039581, 68.63087989038544, 69.90948087074277, 76.19189007332223, 76.19189007332223, 77.42158118376945, 77.42158118376945, 73.94464927283872, 73.63181774564697, 74.38434293309001, 72.79291042554095, 74.29356334892287, 75.88499585647193, 74.51921441101052, 76.1106469185596, 75.3169083048587, 76.90834081240777, 70.30661400895885, 68.71518150140979, 73.60293219963394, 74.88153317999127, 75.22216320351201, 75.22216320351201, 64.01588092593772, 67.85168386700974, 75.8184799110341, 75.8184799110341, 73.36444134606869, 73.42311522296369, 74.1479359386464, 72.55650343109734, 72.6329409792468, 71.04150847169774, 70.98921628157333, 72.5806487891224, 75.00616364250973, 71.94064638120159, 71.46678351979799, 71.46678351979799, 74.13666006214737, 74.13666006214737, 72.60813937838658, 71.07538074773251, 73.39843073531627, 73.39843073531627]}, "sampler_perf": {"mean_env_wait_ms": 11.080065321895184, "mean_raw_obs_processing_ms": 0.4864124548804891, "mean_inference_ms": 5.794456318568382, "mean_action_processing_ms": 0.1408769976135325}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 60000, "timers": {"sample_time_ms": 3536.341, "sample_throughput": 1131.113, "load_time_ms": 3.684, "load_throughput": 1085868.807, "learn_time_ms": 6790.895, "learn_throughput": 589.024, "update_time_ms": 11.862}, "info": {"learner": {"ue": {"cur_kl_coeff": 0.15000000596046448, "cur_lr": 4.999999873689376e-05, "total_loss": 182.24758911132812, "policy_loss": -0.0044336747378110886, "vf_loss": 182.25094604492188, "vf_explained_var": 0.01545146107673645, "kl": 0.007180000189691782, "entropy": 0.7284777760505676, "entropy_coeff": 0.0, "model": {}}}, "num_steps_sampled": 60000, "num_steps_trained": 60000}, "done": false, "episodes_total": 600, "training_iteration": 15, "experiment_id": "f0134eced79d425ca17ebe3d2d0a9c1b", "date": "2021-03-09_10-46-34", "timestamp": 1615283194, "time_this_iter_s": 10.227765560150146, "time_total_s": 168.37668132781982, "pid": 4108, "hostname": "ray02", "node_ip": "131.234.28.177", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "env_config": {"episode_length": 100, "seed": null, "map": "150x100map", "bs_list": ["A", "B"], "ue_list": ["1", "2"], "rand_episodes": false, "new_ue_interval": null, "reward": "sum", "log_metrics": true}, "env": "MultiAgentMobileEnv", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": true, "log_level": "WARN", "callbacks": "<class 'deepcomp.util.callbacks.CustomMetricCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"ue": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Dict(connected:MultiBinary(2), dr:Box(0.0, 1.0, (2,), float32), ues_at_bs:Box(0.0, 1.0, (2,), float32), utility:Box(-1.0, 1.0, (1,), float32))", "Discrete(3)", {}]}, "policy_mapping_fn": "<function create_env_config.<locals>.<lambda> at 0x7f6b553b7ca0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 168.37668132781982, "timesteps_since_restore": 0, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 28.42142857142857, "ram_util_percent": 4.799999999999999}, "trial_id": "e359b_00000"}
{"episode_reward_max": 158.56669241496735, "episode_reward_min": 131.86756479294752, "episode_reward_mean": 148.80641139760655, "episode_len_mean": 100.0, "episodes_this_iter": 40, "policy_reward_min": {"ue": 64.01588092593772}, "policy_reward_max": {"ue": 79.50774658507771}, "policy_reward_mean": {"ue": 74.40320569880319}, "custom_metrics": {"sum_utility_mean": 15.62552320685953, "sum_utility_min": 8.79708413849351, "sum_utility_max": 21.310345226162607, "eps_sum_utility_mean": 1545.6632868271806, "eps_sum_utility_min": 1298.228515088547, "eps_sum_utility_max": 1644.5148068222259}, "hist_stats": {"episode_reward": [146.61736893214072, 152.19001898869283, 141.63236546574996, 154.44909872601, 150.56381559079426, 147.4026354482075, 157.48273453950162, 147.04578453781102, 150.14897329799402, 151.81683888985398, 145.39489678027144, 156.43821642057912, 144.54494658205897, 158.56669241496735, 150.7770145506704, 149.65024648988367, 149.4448148748089, 144.24055753622878, 157.55397193454905, 154.2509186872383, 156.84731488056553, 151.08430100973646, 153.60312579100093, 147.15849168302088, 152.17361331331932, 154.43984550059895, 148.73104377299268, 148.20812854837015, 148.91131465774953, 156.15175710428292, 143.8238685033782, 151.72441148123272, 151.46723433677738, 150.55211769997294, 147.4180415883879, 150.57232376992482, 147.60440050289736, 142.4862996857267, 142.3880565450545, 146.57786433259633, 154.84316236753915, 147.57646701848597, 147.17725335863105, 150.17855920539495, 150.62986132957042, 152.2252491172668, 139.02179551036858, 148.48446537962548, 150.4443264070241, 131.86756479294752, 151.63695982206838, 146.78755656903252, 146.70443936974385, 143.67444945094456, 143.56986507069576, 146.94681002371146, 142.93356703959614, 148.2733201242948, 143.68352012611922, 146.79686147063273, 146.69473038320325, 145.05560444697164, 142.32136105452992, 149.1111443158017, 150.52812477807106, 141.6641514574057, 140.25987154647947, 152.73237827714416, 152.66460573822792, 153.22510471388898, 147.49370943056766, 147.10225964395772, 153.46536705853293, 150.0440798672014, 146.52142126913725, 151.3324425868592, 155.0109722999922, 147.71447347835505, 153.167365843703, 153.71727651919718, 144.34621650851403, 153.640902287656, 152.5799261287424, 150.25900414717938, 144.54120263735166, 148.11205561452368, 144.12753950773651, 147.58387953904457, 153.35593878377642, 143.69190429760937, 150.23165668716632, 145.93937745308324, 152.63313982735997, 146.52144103572482, 142.7212193346341, 148.03323327917934, 146.66626569104358, 156.0774407523126, 148.04154035116795, 146.11929223833022], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_ue_reward": [74.87078003517188, 71.74658889696875, 76.09500949434631, 76.09500949434631, 72.407615240424, 69.22475022532589, 77.22454936300494, 77.22454936300494, 75.28190779539707, 75.28190779539707, 72.90560147032912, 74.49703397787817, 79.50774658507771, 77.97498795442363, 72.72717601513095, 74.31860852268002, 75.20156547414523, 74.9474078238485, 75.87908250647942, 75.93775638337442, 73.33674888031436, 72.05814789995702, 78.21910821028943, 78.21910821028943, 73.83456886013094, 70.7103777219278, 79.28334620748353, 79.28334620748353, 75.38850727533512, 75.38850727533512, 74.82512324494176, 74.82512324494176, 74.72240743740439, 74.72240743740439, 72.75957925829296, 71.48097827793565, 78.7769859672744, 78.7769859672744, 77.12545934361897, 77.12545934361897, 78.4236574402827, 78.4236574402827, 75.5421505048681, 75.5421505048681, 76.8015628955004, 76.8015628955004, 72.78352958773576, 74.37496209528481, 76.08680665665952, 76.08680665665952, 77.21992275029936, 77.21992275029936, 72.9305051425431, 75.8005386304495, 74.10406427418498, 74.10406427418498, 74.45565732887464, 74.45565732887464, 78.0758785521413, 78.0758785521413, 71.14555493636203, 72.6783135670161, 75.86220574061629, 75.86220574061629, 75.7336171683886, 75.7336171683886, 75.27605884998634, 75.27605884998634, 73.58194196904542, 73.83609961934214, 75.28616188496234, 75.28616188496234, 73.03582093612145, 74.56857956677551, 71.24314984286329, 71.24314984286329, 71.32110709767557, 71.06694944737882, 73.28893216629812, 73.28893216629812, 77.42158118376945, 77.42158118376945, 73.94464927283872, 73.63181774564697, 74.38434293309001, 72.79291042554095, 74.29356334892287, 75.88499585647193, 74.51921441101052, 76.1106469185596, 75.3169083048587, 76.90834081240777, 70.30661400895885, 68.71518150140979, 73.60293219963394, 74.88153317999127, 75.22216320351201, 75.22216320351201, 64.01588092593772, 67.85168386700974, 75.8184799110341, 75.8184799110341, 73.36444134606869, 73.42311522296369, 74.1479359386464, 72.55650343109734, 72.6329409792468, 71.04150847169774, 70.98921628157333, 72.5806487891224, 75.00616364250973, 71.94064638120159, 71.46678351979799, 71.46678351979799, 74.13666006214737, 74.13666006214737, 72.60813937838658, 71.07538074773251, 73.39843073531627, 73.39843073531627, 72.70806470142288, 73.9866656817802, 73.29418153881267, 71.76142290815861, 70.52138003708625, 71.79998101744359, 73.91627166772211, 75.19487264807945, 74.46834613526087, 76.05977864280993, 71.62779198247723, 70.03635947492816, 67.64504512521528, 72.61482642126418, 76.3661891385719, 76.3661891385719, 77.09868218444088, 75.56592355378682, 75.81683610316988, 77.40826861071893, 73.74685471528373, 73.74685471528373, 72.75541356820432, 74.34684607575335, 76.73268352926632, 76.73268352926632, 74.2263236798261, 75.81775618737512, 74.0270899498956, 72.49433131924152, 75.66622129342946, 75.66622129342946, 77.50548614999599, 77.50548614999599, 73.8572367391774, 73.8572367391774, 77.35006223717845, 75.81730360652439, 77.65435451337301, 76.06292200582395, 72.01669249066111, 72.32952401785283, 76.82045114382791, 76.82045114382791, 77.05634237969814, 75.52358374904408, 74.97308630999369, 75.28591783718542, 71.50422200334873, 73.03698063400279, 74.05602780726176, 74.05602780726176, 72.22018551746413, 71.90735399027241, 73.15263927934356, 74.43124025970089, 75.91159007656101, 77.44434870721507, 72.64166840257926, 71.0502358950302, 75.11582834358316, 75.11582834358316, 72.9403517880941, 72.9990256649891, 76.31656991367984, 76.31656991367984, 74.05643677163694, 72.46500426408788, 72.28340474623992, 70.43781458839413, 73.25023732426253, 74.78299595491659, 74.12884909929627, 72.53741659174722, 78.03872037615616, 78.03872037615616, 74.81648642935848, 73.22505392180942, 73.82602543449208, 72.29326680383801]}, "sampler_perf": {"mean_env_wait_ms": 11.058027500979, "mean_raw_obs_processing_ms": 0.4865444034585482, "mean_inference_ms": 5.73285531134887, "mean_action_processing_ms": 0.14113374219141772}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 64000, "timers": {"sample_time_ms": 3460.561, "sample_throughput": 1155.882, "load_time_ms": 3.544, "load_throughput": 1128669.187, "learn_time_ms": 6623.14, "learn_throughput": 603.943, "update_time_ms": 11.732}, "info": {"learner": {"ue": {"cur_kl_coeff": 0.15000000596046448, "cur_lr": 4.999999873689376e-05, "total_loss": 184.11151123046875, "policy_loss": -0.0038595376536250114, "vf_loss": 184.11404418945312, "vf_explained_var": 0.018259244039654732, "kl": 0.008916674181818962, "entropy": 0.7050057649612427, "entropy_coeff": 0.0, "model": {}}}, "num_steps_sampled": 64000, "num_steps_trained": 64000}, "done": false, "episodes_total": 640, "training_iteration": 16, "experiment_id": "f0134eced79d425ca17ebe3d2d0a9c1b", "date": "2021-03-09_10-46-45", "timestamp": 1615283205, "time_this_iter_s": 10.212523221969604, "time_total_s": 178.58920454978943, "pid": 4108, "hostname": "ray02", "node_ip": "131.234.28.177", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "env_config": {"episode_length": 100, "seed": null, "map": "150x100map", "bs_list": ["A", "B"], "ue_list": ["1", "2"], "rand_episodes": false, "new_ue_interval": null, "reward": "sum", "log_metrics": true}, "env": "MultiAgentMobileEnv", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": true, "log_level": "WARN", "callbacks": "<class 'deepcomp.util.callbacks.CustomMetricCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"ue": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Dict(connected:MultiBinary(2), dr:Box(0.0, 1.0, (2,), float32), ues_at_bs:Box(0.0, 1.0, (2,), float32), utility:Box(-1.0, 1.0, (1,), float32))", "Discrete(3)", {}]}, "policy_mapping_fn": "<function create_env_config.<locals>.<lambda> at 0x7f6b553b71f0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 178.58920454978943, "timesteps_since_restore": 0, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 27.835714285714285, "ram_util_percent": 4.799999999999999}, "trial_id": "e359b_00000"}
{"episode_reward_max": 158.56669241496735, "episode_reward_min": 141.63236546574996, "episode_reward_mean": 150.42110463513816, "episode_len_mean": 100.0, "episodes_this_iter": 40, "policy_reward_min": {"ue": 69.22475022532589}, "policy_reward_max": {"ue": 79.50774658507771}, "policy_reward_mean": {"ue": 75.21055231756898}, "custom_metrics": {"sum_utility_mean": 15.920229157333583, "sum_utility_min": 8.79708413849351, "sum_utility_max": 21.310345226162607, "eps_sum_utility_mean": 1562.2117220592452, "eps_sum_utility_min": 1472.1838601746574, "eps_sum_utility_max": 1644.5148068222259}, "hist_stats": {"episode_reward": [154.5483477621982, 155.13727595779034, 156.9116581159663, 154.286106899459, 153.66331832669033, 148.42052818345292, 152.4895253833701, 158.17617717565525, 149.56550891951946, 152.62210477688234, 153.67718728765908, 151.3725980916085, 148.6369013907871, 151.91093485150003, 153.39055575382798, 153.23005966258154, 152.83838647674293, 151.5667645161157, 146.86523580451671, 152.7057508181527, 151.73206023662988, 148.9748479318858, 150.84208693794966, 147.71793227071868, 147.3964628503378, 149.37159603322658, 153.63594982345012, 148.614567473007, 147.37527981429474, 152.31993088702126, 153.7221317852048, 154.323861530018, 148.8456453817197, 153.59120420062789, 150.36233426168468, 150.8164545816561, 154.1120372925845, 154.36033775850314, 151.10171933421935, 153.52045547686527, 144.34621650851403, 153.640902287656, 152.5799261287424, 150.25900414717938, 144.54120263735166, 148.11205561452368, 144.12753950773651, 147.58387953904457, 153.35593878377642, 143.69190429760937, 150.23165668716632, 145.93937745308324, 152.63313982735997, 146.52144103572482, 142.7212193346341, 148.03323327917934, 146.66626569104358, 156.0774407523126, 148.04154035116795, 146.11929223833022, 146.61736893214072, 152.19001898869283, 141.63236546574996, 154.44909872601, 150.56381559079426, 147.4026354482075, 157.48273453950162, 147.04578453781102, 150.14897329799402, 151.81683888985398, 145.39489678027144, 156.43821642057912, 144.54494658205897, 158.56669241496735, 150.7770145506704, 149.65024648988367, 149.4448148748089, 144.24055753622878, 157.55397193454905, 154.2509186872383, 156.84731488056553, 151.08430100973646, 153.60312579100093, 147.15849168302088, 152.17361331331932, 154.43984550059895, 148.73104377299268, 148.20812854837015, 148.91131465774953, 156.15175710428292, 143.8238685033782, 151.72441148123272, 151.46723433677738, 150.55211769997294, 147.4180415883879, 150.57232376992482, 147.60440050289736, 142.4862996857267, 142.3880565450545, 146.57786433259633], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_ue_reward": [77.91347437127763, 76.63487339092029, 77.56863797889508, 77.56863797889508, 79.22220837331004, 77.68944974265597, 77.14305344972944, 77.14305344972944, 76.83165916334505, 76.83165916334505, 76.59741285304997, 71.82311533040281, 76.24476269168494, 76.24476269168494, 79.08808858782749, 79.08808858782749, 76.34485002886123, 73.2206588906581, 77.07743170376806, 75.544673073114, 77.6343098976039, 76.04287739005484, 75.6862990458041, 75.6862990458041, 73.55207138006645, 75.08483001072052, 75.95546742574993, 75.95546742574993, 76.69527787691395, 76.69527787691395, 75.8193135775161, 77.41074608506516, 76.41919323837134, 76.41919323837134, 75.78338225805778, 75.78338225805778, 75.02405040980733, 71.84118539470923, 76.35287540907613, 76.35287540907613, 75.0409769260927, 76.69108331053675, 74.48742396594288, 74.48742396594288, 75.42104346897466, 75.42104346897466, 72.26753362781024, 75.45039864290837, 73.69823142516881, 73.69823142516881, 75.48151427038775, 73.89008176283868, 76.81797491172495, 76.81797491172495, 74.94658422668213, 73.6679832463248, 74.48335616092179, 72.89192365337273, 76.15996544351057, 76.15996544351057, 77.65678214637678, 76.06534963882773, 75.57049825745986, 78.75336327255799, 74.4228226908598, 74.4228226908598, 76.79560210031379, 76.79560210031379, 74.54186664066357, 75.8204676210209, 76.20394354460254, 74.61251103705348, 77.05601864629212, 77.05601864629212, 77.1801688792514, 77.1801688792514, 74.91155917693088, 76.19016015728822, 77.55594399220705, 75.96451148465799, 72.01669249066111, 72.32952401785283, 76.82045114382791, 76.82045114382791, 77.05634237969814, 75.52358374904408, 74.97308630999369, 75.28591783718542, 71.50422200334873, 73.03698063400279, 74.05602780726176, 74.05602780726176, 72.22018551746413, 71.90735399027241, 73.15263927934356, 74.43124025970089, 75.91159007656101, 77.44434870721507, 72.64166840257926, 71.0502358950302, 75.11582834358316, 75.11582834358316, 72.9403517880941, 72.9990256649891, 76.31656991367984, 76.31656991367984, 74.05643677163694, 72.46500426408788, 72.28340474623992, 70.43781458839413, 73.25023732426253, 74.78299595491659, 74.12884909929627, 72.53741659174722, 78.03872037615616, 78.03872037615616, 74.81648642935848, 73.22505392180942, 73.82602543449208, 72.29326680383801, 74.87078003517188, 71.74658889696875, 76.09500949434631, 76.09500949434631, 72.407615240424, 69.22475022532589, 77.22454936300494, 77.22454936300494, 75.28190779539707, 75.28190779539707, 72.90560147032912, 74.49703397787817, 79.50774658507771, 77.97498795442363, 72.72717601513095, 74.31860852268002, 75.20156547414523, 74.9474078238485, 75.87908250647942, 75.93775638337442, 73.33674888031436, 72.05814789995702, 78.21910821028943, 78.21910821028943, 73.83456886013094, 70.7103777219278, 79.28334620748353, 79.28334620748353, 75.38850727533512, 75.38850727533512, 74.82512324494176, 74.82512324494176, 74.72240743740439, 74.72240743740439, 72.75957925829296, 71.48097827793565, 78.7769859672744, 78.7769859672744, 77.12545934361897, 77.12545934361897, 78.4236574402827, 78.4236574402827, 75.5421505048681, 75.5421505048681, 76.8015628955004, 76.8015628955004, 72.78352958773576, 74.37496209528481, 76.08680665665952, 76.08680665665952, 77.21992275029936, 77.21992275029936, 72.9305051425431, 75.8005386304495, 74.10406427418498, 74.10406427418498, 74.45565732887464, 74.45565732887464, 78.0758785521413, 78.0758785521413, 71.14555493636203, 72.6783135670161, 75.86220574061629, 75.86220574061629, 75.7336171683886, 75.7336171683886, 75.27605884998634, 75.27605884998634, 73.58194196904542, 73.83609961934214, 75.28616188496234, 75.28616188496234, 73.03582093612145, 74.56857956677551, 71.24314984286329, 71.24314984286329, 71.32110709767557, 71.06694944737882, 73.28893216629812, 73.28893216629812]}, "sampler_perf": {"mean_env_wait_ms": 11.032555511056199, "mean_raw_obs_processing_ms": 0.4846221175208859, "mean_inference_ms": 5.678154754342686, "mean_action_processing_ms": 0.1429321817947055}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 68000, "timers": {"sample_time_ms": 3417.16, "sample_throughput": 1170.563, "load_time_ms": 3.368, "load_throughput": 1187574.13, "learn_time_ms": 6582.618, "learn_throughput": 607.661, "update_time_ms": 13.023}, "info": {"learner": {"ue": {"cur_kl_coeff": 0.15000000596046448, "cur_lr": 4.999999873689376e-05, "total_loss": 187.83973693847656, "policy_loss": -0.0031951582059264183, "vf_loss": 187.8412322998047, "vf_explained_var": 0.021566210314631462, "kl": 0.011301453225314617, "entropy": 0.7127625942230225, "entropy_coeff": 0.0, "model": {}}}, "num_steps_sampled": 68000, "num_steps_trained": 68000}, "done": false, "episodes_total": 680, "training_iteration": 17, "experiment_id": "f0134eced79d425ca17ebe3d2d0a9c1b", "date": "2021-03-09_10-46-55", "timestamp": 1615283215, "time_this_iter_s": 10.206928968429565, "time_total_s": 188.796133518219, "pid": 4108, "hostname": "ray02", "node_ip": "131.234.28.177", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "env_config": {"episode_length": 100, "seed": null, "map": "150x100map", "bs_list": ["A", "B"], "ue_list": ["1", "2"], "rand_episodes": false, "new_ue_interval": null, "reward": "sum", "log_metrics": true}, "env": "MultiAgentMobileEnv", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": true, "log_level": "WARN", "callbacks": "<class 'deepcomp.util.callbacks.CustomMetricCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"ue": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Dict(connected:MultiBinary(2), dr:Box(0.0, 1.0, (2,), float32), ues_at_bs:Box(0.0, 1.0, (2,), float32), utility:Box(-1.0, 1.0, (1,), float32))", "Discrete(3)", {}]}, "policy_mapping_fn": "<function create_env_config.<locals>.<lambda> at 0x7f6b553b7a60>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 188.796133518219, "timesteps_since_restore": 0, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 28.3, "ram_util_percent": 4.799999999999999}, "trial_id": "e359b_00000"}
{"episode_reward_max": 158.17617717565525, "episode_reward_min": 142.3880565450545, "episode_reward_mean": 150.8576869864083, "episode_len_mean": 100.0, "episodes_this_iter": 40, "policy_reward_min": {"ue": 71.06694944737882}, "policy_reward_max": {"ue": 79.22220837331004}, "policy_reward_mean": {"ue": 75.42884349320404}, "custom_metrics": {"sum_utility_mean": 16.382453677185232, "sum_utility_min": 8.79708413849351, "sum_utility_max": 21.310345226162607, "eps_sum_utility_mean": 1564.2433240513328, "eps_sum_utility_min": 1488.1754492812288, "eps_sum_utility_max": 1635.0376348219575}, "hist_stats": {"episode_reward": [148.66210411484593, 144.73873272815806, 148.32495410499575, 152.95236605643527, 153.1422348079427, 154.99583047445594, 153.39817404341943, 146.76734697746616, 149.56672726530928, 152.0851528152162, 150.89635206332775, 151.364539233448, 155.95392615398129, 147.75679344518772, 152.19063108703614, 144.8329228015533, 152.432079572396, 148.22424462929996, 145.00656441666507, 150.71641816720575, 147.34000902999418, 152.5045918545099, 152.12591759248647, 156.39537772254528, 150.17224191651974, 150.12164634727452, 151.29225860795015, 148.44221777503088, 152.63774105796892, 151.78125633572608, 152.56604156589265, 148.1415732490845, 146.36805630787268, 153.87021450559087, 151.49379931069996, 147.1773421919745, 150.61990772191268, 152.26296208839165, 152.73638871852103, 147.03568305886887, 156.84731488056553, 151.08430100973646, 153.60312579100093, 147.15849168302088, 152.17361331331932, 154.43984550059895, 148.73104377299268, 148.20812854837015, 148.91131465774953, 156.15175710428292, 143.8238685033782, 151.72441148123272, 151.46723433677738, 150.55211769997294, 147.4180415883879, 150.57232376992482, 147.60440050289736, 142.4862996857267, 142.3880565450545, 146.57786433259633, 154.5483477621982, 155.13727595779034, 156.9116581159663, 154.286106899459, 153.66331832669033, 148.42052818345292, 152.4895253833701, 158.17617717565525, 149.56550891951946, 152.62210477688234, 153.67718728765908, 151.3725980916085, 148.6369013907871, 151.91093485150003, 153.39055575382798, 153.23005966258154, 152.83838647674293, 151.5667645161157, 146.86523580451671, 152.7057508181527, 151.73206023662988, 148.9748479318858, 150.84208693794966, 147.71793227071868, 147.3964628503378, 149.37159603322658, 153.63594982345012, 148.614567473007, 147.37527981429474, 152.31993088702126, 153.7221317852048, 154.323861530018, 148.8456453817197, 153.59120420062789, 150.36233426168468, 150.8164545816561, 154.1120372925845, 154.36033775850314, 151.10171933421935, 153.52045547686527], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_ue_reward": [75.1267683111974, 73.53533580364834, 73.16508261785351, 71.57365011030446, 74.16247705249786, 74.16247705249786, 76.47618302821752, 76.47618302821752, 76.57111740397123, 76.57111740397123, 77.49791523722786, 77.49791523722786, 76.69908702170957, 76.69908702170957, 74.17938974250757, 72.58795723495851, 75.57907988642904, 73.98764737887998, 76.042576407608, 76.042576407608, 75.44817603166382, 75.44817603166382, 76.47798587049837, 74.88655336294931, 77.9769630769905, 77.9769630769905, 73.87839672259388, 73.87839672259388, 76.09531554351794, 76.09531554351794, 73.21217765455107, 71.62074514700201, 76.21603978619792, 76.21603978619792, 73.34574299932282, 74.87850162997691, 71.70756595455792, 73.29899846210698, 76.92030465270437, 73.79611351450124, 72.87428826122253, 74.46572076877159, 76.25229592725482, 76.25229592725482, 76.06295879624311, 76.06295879624311, 78.19768886127252, 78.19768886127252, 75.85250027358677, 74.3197416429327, 76.62291874273873, 73.49872760453562, 74.85041305020047, 76.44184555774953, 73.42539263374081, 75.01682514128987, 76.31887052898436, 76.31887052898436, 75.890628167863, 75.890628167863, 76.28302078294622, 76.28302078294622, 74.86650287831674, 73.27507037076766, 72.38831190016172, 73.97974440771078, 76.93510725279532, 76.93510725279532, 75.74689965534988, 75.74689965534988, 73.58867109598712, 73.58867109598712, 76.10567011473078, 74.51423760718174, 76.13148104419575, 76.13148104419575, 77.00749484943903, 75.72889386908172, 74.31355778320895, 72.72212527565989, 78.4236574402827, 78.4236574402827, 75.5421505048681, 75.5421505048681, 76.8015628955004, 76.8015628955004, 72.78352958773576, 74.37496209528481, 76.08680665665952, 76.08680665665952, 77.21992275029936, 77.21992275029936, 72.9305051425431, 75.8005386304495, 74.10406427418498, 74.10406427418498, 74.45565732887464, 74.45565732887464, 78.0758785521413, 78.0758785521413, 71.14555493636203, 72.6783135670161, 75.86220574061629, 75.86220574061629, 75.7336171683886, 75.7336171683886, 75.27605884998634, 75.27605884998634, 73.58194196904542, 73.83609961934214, 75.28616188496234, 75.28616188496234, 73.03582093612145, 74.56857956677551, 71.24314984286329, 71.24314984286329, 71.32110709767557, 71.06694944737882, 73.28893216629812, 73.28893216629812, 77.91347437127763, 76.63487339092029, 77.56863797889508, 77.56863797889508, 79.22220837331004, 77.68944974265597, 77.14305344972944, 77.14305344972944, 76.83165916334505, 76.83165916334505, 76.59741285304997, 71.82311533040281, 76.24476269168494, 76.24476269168494, 79.08808858782749, 79.08808858782749, 76.34485002886123, 73.2206588906581, 77.07743170376806, 75.544673073114, 77.6343098976039, 76.04287739005484, 75.6862990458041, 75.6862990458041, 73.55207138006645, 75.08483001072052, 75.95546742574993, 75.95546742574993, 76.69527787691395, 76.69527787691395, 75.8193135775161, 77.41074608506516, 76.41919323837134, 76.41919323837134, 75.78338225805778, 75.78338225805778, 75.02405040980733, 71.84118539470923, 76.35287540907613, 76.35287540907613, 75.0409769260927, 76.69108331053675, 74.48742396594288, 74.48742396594288, 75.42104346897466, 75.42104346897466, 72.26753362781024, 75.45039864290837, 73.69823142516881, 73.69823142516881, 75.48151427038775, 73.89008176283868, 76.81797491172495, 76.81797491172495, 74.94658422668213, 73.6679832463248, 74.48335616092179, 72.89192365337273, 76.15996544351057, 76.15996544351057, 77.65678214637678, 76.06534963882773, 75.57049825745986, 78.75336327255799, 74.4228226908598, 74.4228226908598, 76.79560210031379, 76.79560210031379, 74.54186664066357, 75.8204676210209, 76.20394354460254, 74.61251103705348, 77.05601864629212, 77.05601864629212, 77.1801688792514, 77.1801688792514, 74.91155917693088, 76.19016015728822, 77.55594399220705, 75.96451148465799]}, "sampler_perf": {"mean_env_wait_ms": 11.00355382180121, "mean_raw_obs_processing_ms": 0.48167701123376444, "mean_inference_ms": 5.649061895002913, "mean_action_processing_ms": 0.14315281949181863}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 72000, "timers": {"sample_time_ms": 3414.67, "sample_throughput": 1171.416, "load_time_ms": 3.319, "load_throughput": 1205043.347, "learn_time_ms": 6602.686, "learn_throughput": 605.814, "update_time_ms": 13.398}, "info": {"learner": {"ue": {"cur_kl_coeff": 0.15000000596046448, "cur_lr": 4.999999873689376e-05, "total_loss": 184.18167114257812, "policy_loss": -0.001188321621157229, "vf_loss": 184.18197631835938, "vf_explained_var": 0.020777886733412743, "kl": 0.005680100992321968, "entropy": 0.6804775595664978, "entropy_coeff": 0.0, "model": {}}}, "num_steps_sampled": 72000, "num_steps_trained": 72000}, "done": false, "episodes_total": 720, "training_iteration": 18, "experiment_id": "f0134eced79d425ca17ebe3d2d0a9c1b", "date": "2021-03-09_10-47-06", "timestamp": 1615283226, "time_this_iter_s": 10.521013021469116, "time_total_s": 199.3171465396881, "pid": 4108, "hostname": "ray02", "node_ip": "131.234.28.177", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "env_config": {"episode_length": 100, "seed": null, "map": "150x100map", "bs_list": ["A", "B"], "ue_list": ["1", "2"], "rand_episodes": false, "new_ue_interval": null, "reward": "sum", "log_metrics": true}, "env": "MultiAgentMobileEnv", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": true, "log_level": "WARN", "callbacks": "<class 'deepcomp.util.callbacks.CustomMetricCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"ue": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Dict(connected:MultiBinary(2), dr:Box(0.0, 1.0, (2,), float32), ues_at_bs:Box(0.0, 1.0, (2,), float32), utility:Box(-1.0, 1.0, (1,), float32))", "Discrete(3)", {}]}, "policy_mapping_fn": "<function create_env_config.<locals>.<lambda> at 0x7f6b553b7430>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 199.3171465396881, "timesteps_since_restore": 0, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 27.385714285714293, "ram_util_percent": 4.799999999999999}, "trial_id": "e359b_00000"}
{"episode_reward_max": 159.98016410807446, "episode_reward_min": 144.1572930471075, "episode_reward_mean": 151.32147143549741, "episode_len_mean": 100.0, "episodes_this_iter": 40, "policy_reward_min": {"ue": 71.27512618264674}, "policy_reward_max": {"ue": 79.99008205403707}, "policy_reward_mean": {"ue": 75.66073571774862}, "custom_metrics": {"sum_utility_mean": 16.55981884972984, "sum_utility_min": 10.206592306948258, "sum_utility_max": 21.310345226162607, "eps_sum_utility_mean": 1565.7731813085318, "eps_sum_utility_min": 1491.5847700717472, "eps_sum_utility_max": 1627.1289887838043}, "hist_stats": {"episode_reward": [147.46721203351177, 157.01783227441234, 159.98016410807446, 154.55111716576192, 150.37308480260174, 154.35923127991634, 152.0000496035455, 152.2849159434041, 150.5721436183768, 152.34956716677448, 155.49989256388, 153.77638612142079, 150.57386043556426, 153.15222303612916, 153.35838308304392, 158.05852039206206, 151.21979563266336, 151.69941687789566, 153.80486358773447, 155.40148598000923, 146.25839003533886, 149.30982404281536, 144.1572930471075, 159.30733035584456, 156.75094956182545, 151.3607570359128, 154.73186176880506, 156.69648267572222, 148.46521829824604, 152.03495197248145, 152.40188388185294, 148.7459312462978, 149.06812035866926, 147.48082407308033, 148.026045807173, 152.68255075576127, 145.42028585320003, 151.83170388946553, 149.98249729136853, 158.10387811322755, 151.73206023662988, 148.9748479318858, 150.84208693794966, 147.71793227071868, 147.3964628503378, 149.37159603322658, 153.63594982345012, 148.614567473007, 147.37527981429474, 152.31993088702126, 153.7221317852048, 154.323861530018, 148.8456453817197, 153.59120420062789, 150.36233426168468, 150.8164545816561, 154.1120372925845, 154.36033775850314, 151.10171933421935, 153.52045547686527, 148.66210411484593, 144.73873272815806, 148.32495410499575, 152.95236605643527, 153.1422348079427, 154.99583047445594, 153.39817404341943, 146.76734697746616, 149.56672726530928, 152.0851528152162, 150.89635206332775, 151.364539233448, 155.95392615398129, 147.75679344518772, 152.19063108703614, 144.8329228015533, 152.432079572396, 148.22424462929996, 145.00656441666507, 150.71641816720575, 147.34000902999418, 152.5045918545099, 152.12591759248647, 156.39537772254528, 150.17224191651974, 150.12164634727452, 151.29225860795015, 148.44221777503088, 152.63774105796892, 151.78125633572608, 152.56604156589265, 148.1415732490845, 146.36805630787268, 153.87021450559087, 151.49379931069996, 147.1773421919745, 150.61990772191268, 152.26296208839165, 152.73638871852103, 147.03568305886887], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_ue_reward": [73.7336060167558, 73.7336060167558, 78.50891613720601, 78.50891613720601, 79.99008205403707, 79.99008205403707, 77.2755585828809, 77.2755585828809, 75.18654240130078, 75.18654240130078, 77.17961563995799, 77.17961563995799, 76.79574105554718, 75.20430854799812, 76.14245797170196, 76.14245797170196, 75.28607180918833, 75.28607180918833, 76.17478358338715, 76.17478358338715, 77.74994628193978, 77.74994628193978, 76.88819306071034, 76.88819306071034, 76.0533095331091, 74.52055090245504, 76.57611151806441, 76.57611151806441, 76.67919154152187, 76.67919154152187, 79.02926019603083, 79.02926019603083, 76.40561407010615, 74.81418156255708, 76.64542469272229, 75.05399218517323, 76.9024317938671, 76.9024317938671, 76.90502673622997, 78.49645924377904, 73.12919501766942, 73.12919501766942, 75.42129133673457, 73.88853270608048, 71.28293026977917, 72.87436277732823, 79.65366517792215, 79.65366517792215, 78.37547478091264, 78.37547478091264, 77.1153952619095, 74.2453617740031, 77.36593088440242, 77.36593088440242, 78.34824133786097, 78.34824133786097, 74.87190963930156, 73.59330865894422, 76.81319224001513, 75.22175973246607, 76.9966581947009, 75.40522568715184, 73.5772493693743, 75.16868187692336, 73.73834392556003, 75.3297764331091, 72.9446957827655, 74.53612829031455, 74.77940221891345, 73.24664358825939, 76.34127537788056, 76.34127537788056, 71.27512618264674, 74.14515967055314, 76.71156819850718, 75.12013569095812, 75.63054913586294, 74.35194815550558, 79.05193905661363, 79.05193905661363, 75.0409769260927, 76.69108331053675, 74.48742396594288, 74.48742396594288, 75.42104346897466, 75.42104346897466, 72.26753362781024, 75.45039864290837, 73.69823142516881, 73.69823142516881, 75.48151427038775, 73.89008176283868, 76.81797491172495, 76.81797491172495, 74.94658422668213, 73.6679832463248, 74.48335616092179, 72.89192365337273, 76.15996544351057, 76.15996544351057, 77.65678214637678, 76.06534963882773, 75.57049825745986, 78.75336327255799, 74.4228226908598, 74.4228226908598, 76.79560210031379, 76.79560210031379, 74.54186664066357, 75.8204676210209, 76.20394354460254, 74.61251103705348, 77.05601864629212, 77.05601864629212, 77.1801688792514, 77.1801688792514, 74.91155917693088, 76.19016015728822, 77.55594399220705, 75.96451148465799, 75.1267683111974, 73.53533580364834, 73.16508261785351, 71.57365011030446, 74.16247705249786, 74.16247705249786, 76.47618302821752, 76.47618302821752, 76.57111740397123, 76.57111740397123, 77.49791523722786, 77.49791523722786, 76.69908702170957, 76.69908702170957, 74.17938974250757, 72.58795723495851, 75.57907988642904, 73.98764737887998, 76.042576407608, 76.042576407608, 75.44817603166382, 75.44817603166382, 76.47798587049837, 74.88655336294931, 77.9769630769905, 77.9769630769905, 73.87839672259388, 73.87839672259388, 76.09531554351794, 76.09531554351794, 73.21217765455107, 71.62074514700201, 76.21603978619792, 76.21603978619792, 73.34574299932282, 74.87850162997691, 71.70756595455792, 73.29899846210698, 76.92030465270437, 73.79611351450124, 72.87428826122253, 74.46572076877159, 76.25229592725482, 76.25229592725482, 76.06295879624311, 76.06295879624311, 78.19768886127252, 78.19768886127252, 75.85250027358677, 74.3197416429327, 76.62291874273873, 73.49872760453562, 74.85041305020047, 76.44184555774953, 73.42539263374081, 75.01682514128987, 76.31887052898436, 76.31887052898436, 75.890628167863, 75.890628167863, 76.28302078294622, 76.28302078294622, 74.86650287831674, 73.27507037076766, 72.38831190016172, 73.97974440771078, 76.93510725279532, 76.93510725279532, 75.74689965534988, 75.74689965534988, 73.58867109598712, 73.58867109598712, 76.10567011473078, 74.51423760718174, 76.13148104419575, 76.13148104419575, 77.00749484943903, 75.72889386908172, 74.31355778320895, 72.72212527565989]}, "sampler_perf": {"mean_env_wait_ms": 11.001875856659558, "mean_raw_obs_processing_ms": 0.47964814466156186, "mean_inference_ms": 5.6338202342687485, "mean_action_processing_ms": 0.14275857001720244}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 76000, "timers": {"sample_time_ms": 3478.369, "sample_throughput": 1149.964, "load_time_ms": 3.595, "load_throughput": 1112517.97, "learn_time_ms": 6629.109, "learn_throughput": 603.399, "update_time_ms": 14.923}, "info": {"learner": {"ue": {"cur_kl_coeff": 0.15000000596046448, "cur_lr": 4.999999873689376e-05, "total_loss": 188.92672729492188, "policy_loss": -0.0022610395681113005, "vf_loss": 188.9281463623047, "vf_explained_var": 0.0215443167835474, "kl": 0.005641233641654253, "entropy": 0.6996864080429077, "entropy_coeff": 0.0, "model": {}}}, "num_steps_sampled": 76000, "num_steps_trained": 76000}, "done": false, "episodes_total": 760, "training_iteration": 19, "experiment_id": "f0134eced79d425ca17ebe3d2d0a9c1b", "date": "2021-03-09_10-47-17", "timestamp": 1615283237, "time_this_iter_s": 11.033777475357056, "time_total_s": 210.35092401504517, "pid": 4108, "hostname": "ray02", "node_ip": "131.234.28.177", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "env_config": {"episode_length": 100, "seed": null, "map": "150x100map", "bs_list": ["A", "B"], "ue_list": ["1", "2"], "rand_episodes": false, "new_ue_interval": null, "reward": "sum", "log_metrics": true}, "env": "MultiAgentMobileEnv", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": true, "log_level": "WARN", "callbacks": "<class 'deepcomp.util.callbacks.CustomMetricCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"ue": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Dict(connected:MultiBinary(2), dr:Box(0.0, 1.0, (2,), float32), ues_at_bs:Box(0.0, 1.0, (2,), float32), utility:Box(-1.0, 1.0, (1,), float32))", "Discrete(3)", {}]}, "policy_mapping_fn": "<function create_env_config.<locals>.<lambda> at 0x7f6b553b7c10>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 210.35092401504517, "timesteps_since_restore": 0, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 27.740000000000002, "ram_util_percent": 4.799999999999999}, "trial_id": "e359b_00000"}
{"episode_reward_max": 159.98016410807446, "episode_reward_min": 142.87951005077701, "episode_reward_mean": 152.2630940795996, "episode_len_mean": 100.0, "episodes_this_iter": 40, "policy_reward_min": {"ue": 70.15386777103255}, "policy_reward_max": {"ue": 79.99008205403707}, "policy_reward_mean": {"ue": 76.13154703979968}, "custom_metrics": {"sum_utility_mean": 15.688829673357821, "sum_utility_min": -8.171349849018874, "sum_utility_max": 21.310345226162607, "eps_sum_utility_mean": 1567.2568111815262, "eps_sum_utility_min": 1463.0987156311048, "eps_sum_utility_max": 1650.2790361656782}, "hist_stats": {"episode_reward": [150.49038815435728, 157.41520012186396, 151.51142435491374, 146.62820441385873, 153.4551893230538, 158.02889894063117, 155.32170024922084, 154.6397080252263, 152.2886623065179, 156.70486664676514, 149.94867838203044, 153.71198105961508, 154.58772919733303, 152.71967808899228, 152.5839096361774, 157.1219710557532, 153.01956894688425, 153.6992689530909, 150.5666283024753, 156.81062925138957, 142.87951005077701, 158.07759808800444, 152.74534284362505, 153.38960755441767, 150.99759766412438, 143.4319266802683, 151.13086103216585, 154.99018289837778, 150.54425009962085, 154.7832582390419, 157.399551448272, 151.81037226505077, 152.342505205232, 155.16555281055088, 157.21105658170637, 152.16299561889042, 150.61345924484266, 154.9776127721617, 153.37793920678666, 151.621789516097, 147.34000902999418, 152.5045918545099, 152.12591759248647, 156.39537772254528, 150.17224191651974, 150.12164634727452, 151.29225860795015, 148.44221777503088, 152.63774105796892, 151.78125633572608, 152.56604156589265, 148.1415732490845, 146.36805630787268, 153.87021450559087, 151.49379931069996, 147.1773421919745, 150.61990772191268, 152.26296208839165, 152.73638871852103, 147.03568305886887, 147.46721203351177, 157.01783227441234, 159.98016410807446, 154.55111716576192, 150.37308480260174, 154.35923127991634, 152.0000496035455, 152.2849159434041, 150.5721436183768, 152.34956716677448, 155.49989256388, 153.77638612142079, 150.57386043556426, 153.15222303612916, 153.35838308304392, 158.05852039206206, 151.21979563266336, 151.69941687789566, 153.80486358773447, 155.40148598000923, 146.25839003533886, 149.30982404281536, 144.1572930471075, 159.30733035584456, 156.75094956182545, 151.3607570359128, 154.73186176880506, 156.69648267572222, 148.46521829824604, 152.03495197248145, 152.40188388185294, 148.7459312462978, 149.06812035866926, 147.48082407308033, 148.026045807173, 152.68255075576127, 145.42028585320003, 151.83170388946553, 149.98249729136853, 158.10387811322755], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_ue_reward": [75.2451940771785, 75.2451940771785, 78.7076000609319, 78.7076000609319, 75.75571217745672, 75.75571217745672, 73.31410220692932, 73.31410220692932, 76.7275946615268, 76.7275946615268, 79.01444947031548, 79.01444947031548, 77.66085012461035, 77.66085012461035, 77.31985401261305, 77.31985401261305, 76.14433115325878, 76.14433115325878, 78.35243332338243, 78.35243332338243, 75.77005544478969, 74.17862293724063, 76.0602742760329, 77.65170678358197, 77.29386459866636, 77.29386459866636, 76.35983904449607, 76.35983904449607, 76.29195481808861, 76.29195481808861, 78.56098552787638, 78.56098552787638, 77.30550072721657, 75.71406821966752, 76.8496344765454, 76.8496344765454, 75.28331415123756, 75.28331415123756, 78.40531462569469, 78.40531462569469, 70.77111759676224, 72.10839245401456, 79.03879904400213, 79.03879904400213, 76.37267142181234, 76.37267142181234, 77.49052003098323, 75.89908752343418, 75.49879883206214, 75.49879883206214, 70.15386777103255, 73.27805890923568, 75.56543051608284, 75.56543051608284, 77.49509144918869, 77.49509144918869, 75.27212504981031, 75.27212504981031, 77.39162911952086, 77.39162911952086, 78.69977572413583, 78.69977572413583, 75.90518613252527, 75.90518613252527, 75.37553634884136, 76.96696885639041, 76.78706015150075, 78.37849265904981, 78.60552829085307, 78.60552829085307, 76.08149780944515, 76.08149780944515, 75.30672962242124, 75.30672962242124, 77.48880638608067, 77.48880638608067, 76.68896960339325, 76.68896960339325, 75.81089475804838, 75.81089475804838, 72.87428826122253, 74.46572076877159, 76.25229592725482, 76.25229592725482, 76.06295879624311, 76.06295879624311, 78.19768886127252, 78.19768886127252, 75.85250027358677, 74.3197416429327, 76.62291874273873, 73.49872760453562, 74.85041305020047, 76.44184555774953, 73.42539263374081, 75.01682514128987, 76.31887052898436, 76.31887052898436, 75.890628167863, 75.890628167863, 76.28302078294622, 76.28302078294622, 74.86650287831674, 73.27507037076766, 72.38831190016172, 73.97974440771078, 76.93510725279532, 76.93510725279532, 75.74689965534988, 75.74689965534988, 73.58867109598712, 73.58867109598712, 76.10567011473078, 74.51423760718174, 76.13148104419575, 76.13148104419575, 77.00749484943903, 75.72889386908172, 74.31355778320895, 72.72212527565989, 73.7336060167558, 73.7336060167558, 78.50891613720601, 78.50891613720601, 79.99008205403707, 79.99008205403707, 77.2755585828809, 77.2755585828809, 75.18654240130078, 75.18654240130078, 77.17961563995799, 77.17961563995799, 76.79574105554718, 75.20430854799812, 76.14245797170196, 76.14245797170196, 75.28607180918833, 75.28607180918833, 76.17478358338715, 76.17478358338715, 77.74994628193978, 77.74994628193978, 76.88819306071034, 76.88819306071034, 76.0533095331091, 74.52055090245504, 76.57611151806441, 76.57611151806441, 76.67919154152187, 76.67919154152187, 79.02926019603083, 79.02926019603083, 76.40561407010615, 74.81418156255708, 76.64542469272229, 75.05399218517323, 76.9024317938671, 76.9024317938671, 76.90502673622997, 78.49645924377904, 73.12919501766942, 73.12919501766942, 75.42129133673457, 73.88853270608048, 71.28293026977917, 72.87436277732823, 79.65366517792215, 79.65366517792215, 78.37547478091264, 78.37547478091264, 77.1153952619095, 74.2453617740031, 77.36593088440242, 77.36593088440242, 78.34824133786097, 78.34824133786097, 74.87190963930156, 73.59330865894422, 76.81319224001513, 75.22175973246607, 76.9966581947009, 75.40522568715184, 73.5772493693743, 75.16868187692336, 73.73834392556003, 75.3297764331091, 72.9446957827655, 74.53612829031455, 74.77940221891345, 73.24664358825939, 76.34127537788056, 76.34127537788056, 71.27512618264674, 74.14515967055314, 76.71156819850718, 75.12013569095812, 75.63054913586294, 74.35194815550558, 79.05193905661363, 79.05193905661363]}, "sampler_perf": {"mean_env_wait_ms": 11.00669288134306, "mean_raw_obs_processing_ms": 0.47843553151269197, "mean_inference_ms": 5.602134134684027, "mean_action_processing_ms": 0.1407186722971022}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 80000, "timers": {"sample_time_ms": 3459.948, "sample_throughput": 1156.087, "load_time_ms": 3.601, "load_throughput": 1110912.053, "learn_time_ms": 6656.384, "learn_throughput": 600.927, "update_time_ms": 14.192}, "info": {"learner": {"ue": {"cur_kl_coeff": 0.15000000596046448, "cur_lr": 4.999999873689376e-05, "total_loss": 190.94717407226562, "policy_loss": -0.0026782939676195383, "vf_loss": 190.94911193847656, "vf_explained_var": 0.02240186184644699, "kl": 0.004793005995452404, "entropy": 0.6644202470779419, "entropy_coeff": 0.0, "model": {}}}, "num_steps_sampled": 80000, "num_steps_trained": 80000}, "done": false, "episodes_total": 800, "training_iteration": 20, "experiment_id": "f0134eced79d425ca17ebe3d2d0a9c1b", "date": "2021-03-09_10-47-27", "timestamp": 1615283247, "time_this_iter_s": 10.61121153831482, "time_total_s": 220.96213555335999, "pid": 4108, "hostname": "ray02", "node_ip": "131.234.28.177", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "env_config": {"episode_length": 100, "seed": null, "map": "150x100map", "bs_list": ["A", "B"], "ue_list": ["1", "2"], "rand_episodes": false, "new_ue_interval": null, "reward": "sum", "log_metrics": true}, "env": "MultiAgentMobileEnv", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": true, "log_level": "WARN", "callbacks": "<class 'deepcomp.util.callbacks.CustomMetricCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"ue": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Dict(connected:MultiBinary(2), dr:Box(0.0, 1.0, (2,), float32), ues_at_bs:Box(0.0, 1.0, (2,), float32), utility:Box(-1.0, 1.0, (1,), float32))", "Discrete(3)", {}]}, "policy_mapping_fn": "<function create_env_config.<locals>.<lambda> at 0x7f6b553b7b80>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 220.96213555335999, "timesteps_since_restore": 0, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 27.473333333333333, "ram_util_percent": 4.799999999999999}, "trial_id": "e359b_00000"}
{"episode_reward_max": 159.30733035584456, "episode_reward_min": 142.87951005077701, "episode_reward_mean": 153.0600229127607, "episode_len_mean": 100.0, "episodes_this_iter": 40, "policy_reward_min": {"ue": 70.15386777103255}, "policy_reward_max": {"ue": 79.65366517792215}, "policy_reward_mean": {"ue": 76.53001145638024}, "custom_metrics": {"sum_utility_mean": 15.07433126891817, "sum_utility_min": -8.171349849018874, "sum_utility_max": 21.310345226162607, "eps_sum_utility_mean": 1575.976409121963, "eps_sum_utility_min": 1463.0987156311048, "eps_sum_utility_max": 1673.6754727508683}, "hist_stats": {"episode_reward": [155.91117109705772, 152.5182323080587, 153.4106260470694, 155.88288524125312, 156.4003583258508, 152.32328855405603, 152.17247654588522, 154.16969343724287, 152.21611349187964, 155.25295700316684, 155.12123117118404, 156.71237466200574, 158.610805590521, 153.74749030533462, 156.51363792481152, 157.55081690356627, 155.41434494350221, 151.7419406015772, 153.63723591004572, 156.1742300607836, 147.63091359510287, 155.26233083332, 152.9327390768679, 151.93371612266884, 151.23272058312193, 155.8348243062474, 154.15570017943742, 152.8954688123738, 149.2617662800568, 155.1529573530957, 152.16892302920172, 153.3202617391965, 151.26876791921273, 156.65144132131365, 157.6545002817398, 153.1152221092267, 152.67743833372884, 157.24447364289847, 153.35464615262117, 153.04753418542708, 146.25839003533886, 149.30982404281536, 144.1572930471075, 159.30733035584456, 156.75094956182545, 151.3607570359128, 154.73186176880506, 156.69648267572222, 148.46521829824604, 152.03495197248145, 152.40188388185294, 148.7459312462978, 149.06812035866926, 147.48082407308033, 148.026045807173, 152.68255075576127, 145.42028585320003, 151.83170388946553, 149.98249729136853, 158.10387811322755, 150.49038815435728, 157.41520012186396, 151.51142435491374, 146.62820441385873, 153.4551893230538, 158.02889894063117, 155.32170024922084, 154.6397080252263, 152.2886623065179, 156.70486664676514, 149.94867838203044, 153.71198105961508, 154.58772919733303, 152.71967808899228, 152.5839096361774, 157.1219710557532, 153.01956894688425, 153.6992689530909, 150.5666283024753, 156.81062925138957, 142.87951005077701, 158.07759808800444, 152.74534284362505, 153.38960755441767, 150.99759766412438, 143.4319266802683, 151.13086103216585, 154.99018289837778, 150.54425009962085, 154.7832582390419, 157.399551448272, 151.81037226505077, 152.342505205232, 155.16555281055088, 157.21105658170637, 152.16299561889042, 150.61345924484266, 154.9776127721617, 153.37793920678666, 151.621789516097], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_ue_reward": [77.95558554852872, 77.95558554852872, 76.25911615402919, 76.25911615402919, 77.47169233886162, 75.93893370820754, 77.94144262062642, 77.94144262062642, 78.20017916292525, 78.20017916292525, 75.3952649617009, 76.92802359235496, 76.08623827294248, 76.08623827294248, 77.08484671862134, 77.08484671862134, 76.1080567459397, 76.1080567459397, 76.98717801140468, 78.265778991762, 77.56061558559182, 77.56061558559182, 78.35618733100267, 78.35618733100267, 79.30540279526029, 79.30540279526029, 76.87374515266723, 76.87374515266723, 78.2568189624057, 78.2568189624057, 78.77540845178298, 78.77540845178298, 77.70717247175104, 77.70717247175104, 75.87097030078849, 75.87097030078849, 76.81861795502272, 76.81861795502272, 78.0871150303917, 78.0871150303917, 74.58183611287834, 73.04907748222426, 77.63116541665984, 77.63116541665984, 76.46636953843378, 76.46636953843378, 75.96685806133434, 75.96685806133434, 75.61636029156088, 75.61636029156088, 77.1216958993491, 78.71312840689816, 77.0778500897186, 77.0778500897186, 76.44773440618675, 76.44773440618675, 74.60154620158083, 74.66022007847582, 77.57647867654774, 77.57647867654774, 76.08446151460069, 76.08446151460069, 76.66013086959819, 76.66013086959819, 74.86800464427931, 76.40076327493338, 78.32572066065677, 78.32572066065677, 78.82725014086977, 78.82725014086977, 76.55761105461326, 76.55761105461326, 76.33871916686431, 76.33871916686431, 78.62223682144905, 78.62223682144905, 76.67732307631043, 76.67732307631043, 77.29014640804041, 75.75738777738633, 73.12919501766942, 73.12919501766942, 75.42129133673457, 73.88853270608048, 71.28293026977917, 72.87436277732823, 79.65366517792215, 79.65366517792215, 78.37547478091264, 78.37547478091264, 77.1153952619095, 74.2453617740031, 77.36593088440242, 77.36593088440242, 78.34824133786097, 78.34824133786097, 74.87190963930156, 73.59330865894422, 76.81319224001513, 75.22175973246607, 76.9966581947009, 75.40522568715184, 73.5772493693743, 75.16868187692336, 73.73834392556003, 75.3297764331091, 72.9446957827655, 74.53612829031455, 74.77940221891345, 73.24664358825939, 76.34127537788056, 76.34127537788056, 71.27512618264674, 74.14515967055314, 76.71156819850718, 75.12013569095812, 75.63054913586294, 74.35194815550558, 79.05193905661363, 79.05193905661363, 75.2451940771785, 75.2451940771785, 78.7076000609319, 78.7076000609319, 75.75571217745672, 75.75571217745672, 73.31410220692932, 73.31410220692932, 76.7275946615268, 76.7275946615268, 79.01444947031548, 79.01444947031548, 77.66085012461035, 77.66085012461035, 77.31985401261305, 77.31985401261305, 76.14433115325878, 76.14433115325878, 78.35243332338243, 78.35243332338243, 75.77005544478969, 74.17862293724063, 76.0602742760329, 77.65170678358197, 77.29386459866636, 77.29386459866636, 76.35983904449607, 76.35983904449607, 76.29195481808861, 76.29195481808861, 78.56098552787638, 78.56098552787638, 77.30550072721657, 75.71406821966752, 76.8496344765454, 76.8496344765454, 75.28331415123756, 75.28331415123756, 78.40531462569469, 78.40531462569469, 70.77111759676224, 72.10839245401456, 79.03879904400213, 79.03879904400213, 76.37267142181234, 76.37267142181234, 77.49052003098323, 75.89908752343418, 75.49879883206214, 75.49879883206214, 70.15386777103255, 73.27805890923568, 75.56543051608284, 75.56543051608284, 77.49509144918869, 77.49509144918869, 75.27212504981031, 75.27212504981031, 77.39162911952086, 77.39162911952086, 78.69977572413583, 78.69977572413583, 75.90518613252527, 75.90518613252527, 75.37553634884136, 76.96696885639041, 76.78706015150075, 78.37849265904981, 78.60552829085307, 78.60552829085307, 76.08149780944515, 76.08149780944515, 75.30672962242124, 75.30672962242124, 77.48880638608067, 77.48880638608067, 76.68896960339325, 76.68896960339325, 75.81089475804838, 75.81089475804838]}, "sampler_perf": {"mean_env_wait_ms": 10.999780083666662, "mean_raw_obs_processing_ms": 0.47551020892577, "mean_inference_ms": 5.561031080062037, "mean_action_processing_ms": 0.1406562504426846}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 84000, "timers": {"sample_time_ms": 3477.269, "sample_throughput": 1150.328, "load_time_ms": 3.509, "load_throughput": 1139849.444, "learn_time_ms": 6653.632, "learn_throughput": 601.175, "update_time_ms": 13.951}, "info": {"learner": {"ue": {"cur_kl_coeff": 0.07500000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 191.65609741210938, "policy_loss": -0.0009768090676516294, "vf_loss": 191.65675354003906, "vf_explained_var": 0.026491275057196617, "kl": 0.004077269230037928, "entropy": 0.6274973750114441, "entropy_coeff": 0.0, "model": {}}}, "num_steps_sampled": 84000, "num_steps_trained": 84000}, "done": false, "episodes_total": 840, "training_iteration": 21, "experiment_id": "f0134eced79d425ca17ebe3d2d0a9c1b", "date": "2021-03-09_10-47-38", "timestamp": 1615283258, "time_this_iter_s": 10.40285849571228, "time_total_s": 231.36499404907227, "pid": 4108, "hostname": "ray02", "node_ip": "131.234.28.177", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "env_config": {"episode_length": 100, "seed": null, "map": "150x100map", "bs_list": ["A", "B"], "ue_list": ["1", "2"], "rand_episodes": false, "new_ue_interval": null, "reward": "sum", "log_metrics": true}, "env": "MultiAgentMobileEnv", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": true, "log_level": "WARN", "callbacks": "<class 'deepcomp.util.callbacks.CustomMetricCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"ue": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Dict(connected:MultiBinary(2), dr:Box(0.0, 1.0, (2,), float32), ues_at_bs:Box(0.0, 1.0, (2,), float32), utility:Box(-1.0, 1.0, (1,), float32))", "Discrete(3)", {}]}, "policy_mapping_fn": "<function create_env_config.<locals>.<lambda> at 0x7f6b553b7dc0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 231.36499404907227, "timesteps_since_restore": 0, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 27.65, "ram_util_percent": 4.799999999999999}, "trial_id": "e359b_00000"}
{"episode_reward_max": 160.16474030524256, "episode_reward_min": 142.87951005077701, "episode_reward_mean": 154.32290511134772, "episode_len_mean": 100.0, "episodes_this_iter": 40, "policy_reward_min": {"ue": 70.15386777103255}, "policy_reward_max": {"ue": 80.0823701526211}, "policy_reward_mean": {"ue": 77.16145255567375}, "custom_metrics": {"sum_utility_mean": 15.549634154825487, "sum_utility_min": -8.171349849018874, "sum_utility_max": 21.310345226162607, "eps_sum_utility_mean": 1587.6118102127768, "eps_sum_utility_min": 1463.0987156311048, "eps_sum_utility_max": 1673.6754727508683}, "hist_stats": {"episode_reward": [152.73218109903246, 159.0526319021684, 153.22976234237382, 153.92542254939713, 157.09887038980133, 154.34066668739268, 151.7533628106945, 157.14336494507154, 155.78846489737123, 156.2677993253123, 156.93334499804155, 154.9574261131457, 148.8190522810762, 157.21397312821898, 153.88794460387498, 160.04743886548266, 151.60067344730098, 156.47028491010667, 152.58586670385318, 155.43277191045024, 154.4902309336561, 153.61724749817216, 159.39865082941884, 158.86211848580865, 157.78414053752454, 157.43710853005723, 157.94323432984908, 155.9750301602997, 152.05854701867673, 157.6834240817214, 158.32454169554467, 155.54294442142026, 155.53078610336843, 156.11855037677537, 160.16474030524256, 157.73319329323306, 150.47062126684523, 155.0816855665368, 150.8349515115994, 156.02623447712887, 142.87951005077701, 158.07759808800444, 152.74534284362505, 153.38960755441767, 150.99759766412438, 143.4319266802683, 151.13086103216585, 154.99018289837778, 150.54425009962085, 154.7832582390419, 157.399551448272, 151.81037226505077, 152.342505205232, 155.16555281055088, 157.21105658170637, 152.16299561889042, 150.61345924484266, 154.9776127721617, 153.37793920678666, 151.621789516097, 155.91117109705772, 152.5182323080587, 153.4106260470694, 155.88288524125312, 156.4003583258508, 152.32328855405603, 152.17247654588522, 154.16969343724287, 152.21611349187964, 155.25295700316684, 155.12123117118404, 156.71237466200574, 158.610805590521, 153.74749030533462, 156.51363792481152, 157.55081690356627, 155.41434494350221, 151.7419406015772, 153.63723591004572, 156.1742300607836, 147.63091359510287, 155.26233083332, 152.9327390768679, 151.93371612266884, 151.23272058312193, 155.8348243062474, 154.15570017943742, 152.8954688123738, 149.2617662800568, 155.1529573530957, 152.16892302920172, 153.3202617391965, 151.26876791921273, 156.65144132131365, 157.6545002817398, 153.1152221092267, 152.67743833372884, 157.24447364289847, 153.35464615262117, 153.04753418542708], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_ue_reward": [76.36609054951616, 76.36609054951616, 79.52631595108397, 79.52631595108397, 76.61488117118674, 76.61488117118674, 77.75842752847302, 76.16699502092396, 78.54943519490047, 78.54943519490047, 77.1703333436962, 77.1703333436962, 76.67239765912171, 75.08096515157263, 78.57168247253557, 78.57168247253557, 77.89423244868544, 77.89423244868544, 78.13389966265605, 78.13389966265605, 78.4666724990207, 78.4666724990207, 77.4787130565727, 77.4787130565727, 75.36165815790838, 73.45739412316759, 78.60698656410938, 78.60698656410938, 76.94397230193736, 76.94397230193736, 80.02371943274117, 80.02371943274117, 77.39176923119952, 74.2089042161014, 78.23514245505322, 78.23514245505322, 77.08864960570105, 75.49721709815199, 77.716385955225, 77.716385955225, 77.2451154668279, 77.2451154668279, 76.80862374908592, 76.80862374908592, 79.69932541470926, 79.69932541470926, 79.43105924290415, 79.43105924290415, 78.89207026876214, 78.89207026876214, 78.71855426502847, 78.71855426502847, 78.97161716492438, 78.97161716492438, 77.34821458997108, 78.6268155703284, 76.8249897631128, 75.23355725556374, 78.84171204086059, 78.84171204086059, 79.16227084777222, 79.16227084777222, 77.77147221071004, 77.77147221071004, 77.76539305168409, 77.76539305168409, 78.05927518838755, 78.05927518838755, 80.0823701526211, 80.0823701526211, 79.66231290039086, 78.0708803928418, 74.439594379648, 76.03102688719706, 77.54084278326826, 77.54084278326826, 76.18385507112667, 74.65109644047261, 78.01311723856435, 78.01311723856435, 70.77111759676224, 72.10839245401456, 79.03879904400213, 79.03879904400213, 76.37267142181234, 76.37267142181234, 77.49052003098323, 75.89908752343418, 75.49879883206214, 75.49879883206214, 70.15386777103255, 73.27805890923568, 75.56543051608284, 75.56543051608284, 77.49509144918869, 77.49509144918869, 75.27212504981031, 75.27212504981031, 77.39162911952086, 77.39162911952086, 78.69977572413583, 78.69977572413583, 75.90518613252527, 75.90518613252527, 75.37553634884136, 76.96696885639041, 76.78706015150075, 78.37849265904981, 78.60552829085307, 78.60552829085307, 76.08149780944515, 76.08149780944515, 75.30672962242124, 75.30672962242124, 77.48880638608067, 77.48880638608067, 76.68896960339325, 76.68896960339325, 75.81089475804838, 75.81089475804838, 77.95558554852872, 77.95558554852872, 76.25911615402919, 76.25911615402919, 77.47169233886162, 75.93893370820754, 77.94144262062642, 77.94144262062642, 78.20017916292525, 78.20017916292525, 75.3952649617009, 76.92802359235496, 76.08623827294248, 76.08623827294248, 77.08484671862134, 77.08484671862134, 76.1080567459397, 76.1080567459397, 76.98717801140468, 78.265778991762, 77.56061558559182, 77.56061558559182, 78.35618733100267, 78.35618733100267, 79.30540279526029, 79.30540279526029, 76.87374515266723, 76.87374515266723, 78.2568189624057, 78.2568189624057, 78.77540845178298, 78.77540845178298, 77.70717247175104, 77.70717247175104, 75.87097030078849, 75.87097030078849, 76.81861795502272, 76.81861795502272, 78.0871150303917, 78.0871150303917, 74.58183611287834, 73.04907748222426, 77.63116541665984, 77.63116541665984, 76.46636953843378, 76.46636953843378, 75.96685806133434, 75.96685806133434, 75.61636029156088, 75.61636029156088, 77.1216958993491, 78.71312840689816, 77.0778500897186, 77.0778500897186, 76.44773440618675, 76.44773440618675, 74.60154620158083, 74.66022007847582, 77.57647867654774, 77.57647867654774, 76.08446151460069, 76.08446151460069, 76.66013086959819, 76.66013086959819, 74.86800464427931, 76.40076327493338, 78.32572066065677, 78.32572066065677, 78.82725014086977, 78.82725014086977, 76.55761105461326, 76.55761105461326, 76.33871916686431, 76.33871916686431, 78.62223682144905, 78.62223682144905, 76.67732307631043, 76.67732307631043, 77.29014640804041, 75.75738777738633]}, "sampler_perf": {"mean_env_wait_ms": 10.98975038252888, "mean_raw_obs_processing_ms": 0.47372746455563153, "mean_inference_ms": 5.511867206449213, "mean_action_processing_ms": 0.14124317350797086}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 88000, "timers": {"sample_time_ms": 3472.98, "sample_throughput": 1151.749, "load_time_ms": 3.536, "load_throughput": 1131127.067, "learn_time_ms": 6601.511, "learn_throughput": 605.922, "update_time_ms": 16.071}, "info": {"learner": {"ue": {"cur_kl_coeff": 0.03750000149011612, "cur_lr": 4.999999873689376e-05, "total_loss": 194.3415985107422, "policy_loss": -0.0034156469628214836, "vf_loss": 194.34461975097656, "vf_explained_var": 0.025054657831788063, "kl": 0.009281568229198456, "entropy": 0.6087415218353271, "entropy_coeff": 0.0, "model": {}}}, "num_steps_sampled": 88000, "num_steps_trained": 88000}, "done": false, "episodes_total": 880, "training_iteration": 22, "experiment_id": "f0134eced79d425ca17ebe3d2d0a9c1b", "date": "2021-03-09_10-47-48", "timestamp": 1615283268, "time_this_iter_s": 10.251340389251709, "time_total_s": 241.61633443832397, "pid": 4108, "hostname": "ray02", "node_ip": "131.234.28.177", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "env_config": {"episode_length": 100, "seed": null, "map": "150x100map", "bs_list": ["A", "B"], "ue_list": ["1", "2"], "rand_episodes": false, "new_ue_interval": null, "reward": "sum", "log_metrics": true}, "env": "MultiAgentMobileEnv", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": true, "log_level": "WARN", "callbacks": "<class 'deepcomp.util.callbacks.CustomMetricCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"ue": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Dict(connected:MultiBinary(2), dr:Box(0.0, 1.0, (2,), float32), ues_at_bs:Box(0.0, 1.0, (2,), float32), utility:Box(-1.0, 1.0, (1,), float32))", "Discrete(3)", {}]}, "policy_mapping_fn": "<function create_env_config.<locals>.<lambda> at 0x7f6b55430f70>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 241.61633443832397, "timesteps_since_restore": 0, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 28.657142857142855, "ram_util_percent": 4.799999999999999}, "trial_id": "e359b_00000"}
{"episode_reward_max": 160.38269588262693, "episode_reward_min": 147.63091359510287, "episode_reward_mean": 155.53227203552797, "episode_len_mean": 100.0, "episodes_this_iter": 40, "policy_reward_min": {"ue": 73.04907748222426}, "policy_reward_max": {"ue": 80.19134794131324}, "policy_reward_mean": {"ue": 77.76613601776386}, "custom_metrics": {"sum_utility_mean": 16.255418462260458, "sum_utility_min": 10.206592306948258, "sum_utility_max": 21.310345226162607, "eps_sum_utility_mean": 1596.1118104333686, "eps_sum_utility_min": 1510.7419390159077, "eps_sum_utility_max": 1660.4952857249766}, "hist_stats": {"episode_reward": [157.30233437410425, 157.3159918542163, 155.92229598596748, 154.96804317999334, 156.06412840563814, 154.53043505747178, 153.32433260057712, 153.34995122062986, 153.71186706320253, 155.5150054558452, 156.55862918960787, 154.8309664878666, 155.48276221548173, 159.0533777312342, 157.48797868112268, 156.35190531699112, 158.47148795270385, 157.76425039287994, 155.02782469030404, 155.68995666554514, 159.39629883121393, 157.65533822985049, 158.51712931891348, 155.05815368148495, 156.5213373159366, 158.08092814438237, 159.67851356439013, 160.38269588262693, 157.77216661229863, 159.708175061928, 159.17670900577042, 157.31564778980947, 158.28056555400235, 156.87254143303988, 155.61688266094575, 154.25775895154197, 152.76986839795757, 156.40067362357712, 157.1541465523594, 156.73251722947867, 147.63091359510287, 155.26233083332, 152.9327390768679, 151.93371612266884, 151.23272058312193, 155.8348243062474, 154.15570017943742, 152.8954688123738, 149.2617662800568, 155.1529573530957, 152.16892302920172, 153.3202617391965, 151.26876791921273, 156.65144132131365, 157.6545002817398, 153.1152221092267, 152.67743833372884, 157.24447364289847, 153.35464615262117, 153.04753418542708, 152.73218109903246, 159.0526319021684, 153.22976234237382, 153.92542254939713, 157.09887038980133, 154.34066668739268, 151.7533628106945, 157.14336494507154, 155.78846489737123, 156.2677993253123, 156.93334499804155, 154.9574261131457, 148.8190522810762, 157.21397312821898, 153.88794460387498, 160.04743886548266, 151.60067344730098, 156.47028491010667, 152.58586670385318, 155.43277191045024, 154.4902309336561, 153.61724749817216, 159.39865082941884, 158.86211848580865, 157.78414053752454, 157.43710853005723, 157.94323432984908, 155.9750301602997, 152.05854701867673, 157.6834240817214, 158.32454169554467, 155.54294442142026, 155.53078610336843, 156.11855037677537, 160.16474030524256, 157.73319329323306, 150.47062126684523, 155.0816855665368, 150.8349515115994, 156.02623447712887], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_ue_reward": [78.65116718705197, 78.65116718705197, 78.65799592710809, 78.65799592710809, 77.96114799298354, 77.96114799298354, 77.48402158999659, 77.48402158999659, 78.03206420281897, 78.03206420281897, 77.26521752873577, 77.26521752873577, 76.66216630028842, 76.66216630028842, 76.6749756103148, 76.6749756103148, 76.85593353160111, 76.85593353160111, 77.75750272792237, 77.75750272792237, 78.27931459480372, 78.27931459480372, 77.41548324393321, 77.41548324393321, 77.74138110774076, 77.74138110774076, 79.52668886561693, 79.52668886561693, 78.7439893405612, 78.7439893405612, 78.1759526584954, 78.1759526584954, 79.23574397635177, 79.23574397635177, 78.8821251964399, 78.8821251964399, 77.51391234515188, 77.51391234515188, 77.8449783327724, 77.8449783327724, 79.69814941560679, 79.69814941560679, 78.82766911492513, 78.82766911492513, 79.25856465945655, 79.25856465945655, 77.52907684074232, 77.52907684074232, 78.26066865796811, 78.26066865796811, 79.0404640721911, 79.0404640721911, 79.8392567821949, 79.8392567821949, 80.19134794131324, 80.19134794131324, 78.88608330614915, 78.88608330614915, 79.85408753096381, 79.85408753096381, 79.588354502885, 79.588354502885, 78.65782389490455, 78.65782389490455, 79.14028277700099, 79.14028277700099, 78.43627071651977, 78.43627071651977, 77.8084413304728, 77.8084413304728, 77.12887947577089, 77.12887947577089, 76.38493419897867, 76.38493419897867, 78.20033681178843, 78.20033681178843, 78.57707327617958, 78.57707327617958, 78.3662586147392, 78.3662586147392, 74.58183611287834, 73.04907748222426, 77.63116541665984, 77.63116541665984, 76.46636953843378, 76.46636953843378, 75.96685806133434, 75.96685806133434, 75.61636029156088, 75.61636029156088, 77.1216958993491, 78.71312840689816, 77.0778500897186, 77.0778500897186, 76.44773440618675, 76.44773440618675, 74.60154620158083, 74.66022007847582, 77.57647867654774, 77.57647867654774, 76.08446151460069, 76.08446151460069, 76.66013086959819, 76.66013086959819, 74.86800464427931, 76.40076327493338, 78.32572066065677, 78.32572066065677, 78.82725014086977, 78.82725014086977, 76.55761105461326, 76.55761105461326, 76.33871916686431, 76.33871916686431, 78.62223682144905, 78.62223682144905, 76.67732307631043, 76.67732307631043, 77.29014640804041, 75.75738777738633, 76.36609054951616, 76.36609054951616, 79.52631595108397, 79.52631595108397, 76.61488117118674, 76.61488117118674, 77.75842752847302, 76.16699502092396, 78.54943519490047, 78.54943519490047, 77.1703333436962, 77.1703333436962, 76.67239765912171, 75.08096515157263, 78.57168247253557, 78.57168247253557, 77.89423244868544, 77.89423244868544, 78.13389966265605, 78.13389966265605, 78.4666724990207, 78.4666724990207, 77.4787130565727, 77.4787130565727, 75.36165815790838, 73.45739412316759, 78.60698656410938, 78.60698656410938, 76.94397230193736, 76.94397230193736, 80.02371943274117, 80.02371943274117, 77.39176923119952, 74.2089042161014, 78.23514245505322, 78.23514245505322, 77.08864960570105, 75.49721709815199, 77.716385955225, 77.716385955225, 77.2451154668279, 77.2451154668279, 76.80862374908592, 76.80862374908592, 79.69932541470926, 79.69932541470926, 79.43105924290415, 79.43105924290415, 78.89207026876214, 78.89207026876214, 78.71855426502847, 78.71855426502847, 78.97161716492438, 78.97161716492438, 77.34821458997108, 78.6268155703284, 76.8249897631128, 75.23355725556374, 78.84171204086059, 78.84171204086059, 79.16227084777222, 79.16227084777222, 77.77147221071004, 77.77147221071004, 77.76539305168409, 77.76539305168409, 78.05927518838755, 78.05927518838755, 80.0823701526211, 80.0823701526211, 79.66231290039086, 78.0708803928418, 74.439594379648, 76.03102688719706, 77.54084278326826, 77.54084278326826, 76.18385507112667, 74.65109644047261, 78.01311723856435, 78.01311723856435]}, "sampler_perf": {"mean_env_wait_ms": 11.005748163265121, "mean_raw_obs_processing_ms": 0.4727521400904995, "mean_inference_ms": 5.481354990502402, "mean_action_processing_ms": 0.1422985478893691}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 92000, "timers": {"sample_time_ms": 3543.441, "sample_throughput": 1128.846, "load_time_ms": 3.607, "load_throughput": 1108966.137, "learn_time_ms": 6636.527, "learn_throughput": 602.725, "update_time_ms": 16.285}, "info": {"learner": {"ue": {"cur_kl_coeff": 0.03750000149011612, "cur_lr": 4.999999873689376e-05, "total_loss": 194.85824584960938, "policy_loss": -0.003329379018396139, "vf_loss": 194.86117553710938, "vf_explained_var": 0.030613522976636887, "kl": 0.01010146364569664, "entropy": 0.6090195775032043, "entropy_coeff": 0.0, "model": {}}}, "num_steps_sampled": 92000, "num_steps_trained": 92000}, "done": false, "episodes_total": 920, "training_iteration": 23, "experiment_id": "f0134eced79d425ca17ebe3d2d0a9c1b", "date": "2021-03-09_10-47-59", "timestamp": 1615283279, "time_this_iter_s": 11.036439180374146, "time_total_s": 252.65277361869812, "pid": 4108, "hostname": "ray02", "node_ip": "131.234.28.177", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "env_config": {"episode_length": 100, "seed": null, "map": "150x100map", "bs_list": ["A", "B"], "ue_list": ["1", "2"], "rand_episodes": false, "new_ue_interval": null, "reward": "sum", "log_metrics": true}, "env": "MultiAgentMobileEnv", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": true, "log_level": "WARN", "callbacks": "<class 'deepcomp.util.callbacks.CustomMetricCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"ue": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Dict(connected:MultiBinary(2), dr:Box(0.0, 1.0, (2,), float32), ues_at_bs:Box(0.0, 1.0, (2,), float32), utility:Box(-1.0, 1.0, (1,), float32))", "Discrete(3)", {}]}, "policy_mapping_fn": "<function create_env_config.<locals>.<lambda> at 0x7f6b554820d0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 252.65277361869812, "timesteps_since_restore": 0, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 29.260000000000005, "ram_util_percent": 4.799999999999999}, "trial_id": "e359b_00000"}
{"episode_reward_max": 160.38269588262693, "episode_reward_min": 148.33088956213436, "episode_reward_mean": 155.51427982002372, "episode_len_mean": 100.0, "episodes_this_iter": 40, "policy_reward_min": {"ue": 73.5261442908884}, "policy_reward_max": {"ue": 80.19134794131324}, "policy_reward_mean": {"ue": 77.75713991001174}, "custom_metrics": {"sum_utility_mean": 16.123492380628583, "sum_utility_min": 8.79708413849351, "sum_utility_max": 21.310345226162607, "eps_sum_utility_mean": 1588.9453862554446, "eps_sum_utility_min": 1534.9427880974688, "eps_sum_utility_max": 1660.4952857249766}, "hist_stats": {"episode_reward": [155.08173418560335, 154.917109180024, 148.33088956213436, 156.06679423102344, 155.099675853493, 154.4764734265721, 153.3086683158773, 153.93423863540505, 153.76947785606637, 152.18158995210064, 156.12117069516194, 155.03994550182557, 155.17105897881214, 158.27763213613036, 152.5231539074568, 153.11544293955234, 154.02410827974018, 150.95298888409235, 152.16079740129027, 153.36018954236226, 152.83262089912546, 156.06613204306797, 152.25615590107736, 154.66476301079808, 153.2077095323716, 156.63167656558795, 152.08807486897928, 155.05326067432213, 153.53602703299407, 153.23200622734078, 155.55355698969635, 152.7196783752379, 154.87105571940498, 155.36708673706727, 155.70187571634165, 154.93641853258254, 155.09443832878736, 154.11322911398275, 154.171204164975, 154.26831831813803, 154.4902309336561, 153.61724749817216, 159.39865082941884, 158.86211848580865, 157.78414053752454, 157.43710853005723, 157.94323432984908, 155.9750301602997, 152.05854701867673, 157.6834240817214, 158.32454169554467, 155.54294442142026, 155.53078610336843, 156.11855037677537, 160.16474030524256, 157.73319329323306, 150.47062126684523, 155.0816855665368, 150.8349515115994, 156.02623447712887, 157.30233437410425, 157.3159918542163, 155.92229598596748, 154.96804317999334, 156.06412840563814, 154.53043505747178, 153.32433260057712, 153.34995122062986, 153.71186706320253, 155.5150054558452, 156.55862918960787, 154.8309664878666, 155.48276221548173, 159.0533777312342, 157.48797868112268, 156.35190531699112, 158.47148795270385, 157.76425039287994, 155.02782469030404, 155.68995666554514, 159.39629883121393, 157.65533822985049, 158.51712931891348, 155.05815368148495, 156.5213373159366, 158.08092814438237, 159.67851356439013, 160.38269588262693, 157.77216661229863, 159.708175061928, 159.17670900577042, 157.31564778980947, 158.28056555400235, 156.87254143303988, 155.61688266094575, 154.25775895154197, 152.76986839795757, 156.40067362357712, 157.1541465523594, 156.73251722947867], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_ue_reward": [77.54086709280149, 77.54086709280149, 77.45855459001184, 77.45855459001184, 73.5261442908884, 74.80474527124572, 78.03339711551168, 78.03339711551168, 77.54983792674639, 77.54983792674639, 78.00461602861297, 76.4718573979589, 76.6543341579385, 76.6543341579385, 76.96711931770251, 76.96711931770251, 76.88473892803307, 76.88473892803307, 76.09079497605035, 76.09079497605035, 78.06058534758087, 78.06058534758087, 77.51997275091267, 77.51997275091267, 77.58552948940593, 77.58552948940593, 79.13881606806503, 79.13881606806503, 76.2615769537283, 76.2615769537283, 76.557721469776, 76.557721469776, 77.01205413986996, 77.01205413986996, 75.47649444204616, 75.47649444204616, 76.87611495441953, 75.28468244687048, 76.68009477118103, 76.68009477118103, 75.62059419578814, 77.21202670333722, 78.0330660215339, 78.0330660215339, 76.1280779505386, 76.1280779505386, 77.33238150539894, 77.33238150539894, 76.60385476618573, 76.60385476618573, 78.31583828279383, 78.31583828279383, 75.4047369443109, 76.68333792466821, 77.52663033716097, 77.52663033716097, 76.7680135164969, 76.7680135164969, 77.41171936744475, 75.82028685989569, 77.77677849484807, 77.77677849484807, 76.35983918761883, 76.35983918761883, 77.43552785970225, 77.43552785970225, 77.6835433685335, 77.6835433685335, 77.85093785817067, 77.85093785817067, 77.46820926629115, 77.46820926629115, 77.54721916439358, 77.54721916439358, 77.05661455699129, 77.05661455699129, 77.08560208248745, 77.08560208248745, 77.13415915906886, 77.13415915906886, 77.2451154668279, 77.2451154668279, 76.80862374908592, 76.80862374908592, 79.69932541470926, 79.69932541470926, 79.43105924290415, 79.43105924290415, 78.89207026876214, 78.89207026876214, 78.71855426502847, 78.71855426502847, 78.97161716492438, 78.97161716492438, 77.34821458997108, 78.6268155703284, 76.8249897631128, 75.23355725556374, 78.84171204086059, 78.84171204086059, 79.16227084777222, 79.16227084777222, 77.77147221071004, 77.77147221071004, 77.76539305168409, 77.76539305168409, 78.05927518838755, 78.05927518838755, 80.0823701526211, 80.0823701526211, 79.66231290039086, 78.0708803928418, 74.439594379648, 76.03102688719706, 77.54084278326826, 77.54084278326826, 76.18385507112667, 74.65109644047261, 78.01311723856435, 78.01311723856435, 78.65116718705197, 78.65116718705197, 78.65799592710809, 78.65799592710809, 77.96114799298354, 77.96114799298354, 77.48402158999659, 77.48402158999659, 78.03206420281897, 78.03206420281897, 77.26521752873577, 77.26521752873577, 76.66216630028842, 76.66216630028842, 76.6749756103148, 76.6749756103148, 76.85593353160111, 76.85593353160111, 77.75750272792237, 77.75750272792237, 78.27931459480372, 78.27931459480372, 77.41548324393321, 77.41548324393321, 77.74138110774076, 77.74138110774076, 79.52668886561693, 79.52668886561693, 78.7439893405612, 78.7439893405612, 78.1759526584954, 78.1759526584954, 79.23574397635177, 79.23574397635177, 78.8821251964399, 78.8821251964399, 77.51391234515188, 77.51391234515188, 77.8449783327724, 77.8449783327724, 79.69814941560679, 79.69814941560679, 78.82766911492513, 78.82766911492513, 79.25856465945655, 79.25856465945655, 77.52907684074232, 77.52907684074232, 78.26066865796811, 78.26066865796811, 79.0404640721911, 79.0404640721911, 79.8392567821949, 79.8392567821949, 80.19134794131324, 80.19134794131324, 78.88608330614915, 78.88608330614915, 79.85408753096381, 79.85408753096381, 79.588354502885, 79.588354502885, 78.65782389490455, 78.65782389490455, 79.14028277700099, 79.14028277700099, 78.43627071651977, 78.43627071651977, 77.8084413304728, 77.8084413304728, 77.12887947577089, 77.12887947577089, 76.38493419897867, 76.38493419897867, 78.20033681178843, 78.20033681178843, 78.57707327617958, 78.57707327617958, 78.3662586147392, 78.3662586147392]}, "sampler_perf": {"mean_env_wait_ms": 11.052143611166487, "mean_raw_obs_processing_ms": 0.4711180905172434, "mean_inference_ms": 5.459287308394326, "mean_action_processing_ms": 0.14249096241190318}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 96000, "timers": {"sample_time_ms": 3592.319, "sample_throughput": 1113.487, "load_time_ms": 3.668, "load_throughput": 1090633.557, "learn_time_ms": 6635.562, "learn_throughput": 602.813, "update_time_ms": 15.166}, "info": {"learner": {"ue": {"cur_kl_coeff": 0.03750000149011612, "cur_lr": 4.999999873689376e-05, "total_loss": 191.7177276611328, "policy_loss": -0.0025268716271966696, "vf_loss": 191.71983337402344, "vf_explained_var": 0.02611393667757511, "kl": 0.010251760482788086, "entropy": 0.5958545804023743, "entropy_coeff": 0.0, "model": {}}}, "num_steps_sampled": 96000, "num_steps_trained": 96000}, "done": false, "episodes_total": 960, "training_iteration": 24, "experiment_id": "f0134eced79d425ca17ebe3d2d0a9c1b", "date": "2021-03-09_10-48-10", "timestamp": 1615283290, "time_this_iter_s": 10.788174152374268, "time_total_s": 263.4409477710724, "pid": 4108, "hostname": "ray02", "node_ip": "131.234.28.177", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "env_config": {"episode_length": 100, "seed": null, "map": "150x100map", "bs_list": ["A", "B"], "ue_list": ["1", "2"], "rand_episodes": false, "new_ue_interval": null, "reward": "sum", "log_metrics": true}, "env": "MultiAgentMobileEnv", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": true, "log_level": "WARN", "callbacks": "<class 'deepcomp.util.callbacks.CustomMetricCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"ue": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Dict(connected:MultiBinary(2), dr:Box(0.0, 1.0, (2,), float32), ues_at_bs:Box(0.0, 1.0, (2,), float32), utility:Box(-1.0, 1.0, (1,), float32))", "Discrete(3)", {}]}, "policy_mapping_fn": "<function create_env_config.<locals>.<lambda> at 0x7f6b554309d0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 263.4409477710724, "timesteps_since_restore": 0, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 29.466666666666672, "ram_util_percent": 4.799999999999999}, "trial_id": "e359b_00000"}
{"episode_reward_max": 160.56663052701043, "episode_reward_min": 148.33088956213436, "episode_reward_mean": 155.66862242868632, "episode_len_mean": 100.0, "episodes_this_iter": 40, "policy_reward_min": {"ue": 73.5261442908884}, "policy_reward_max": {"ue": 80.283315263505}, "policy_reward_mean": {"ue": 77.83431121434303}, "custom_metrics": {"sum_utility_mean": 16.183456552619774, "sum_utility_min": 8.79708413849351, "sum_utility_max": 21.310345226162607, "eps_sum_utility_mean": 1587.9415456957452, "eps_sum_utility_min": 1534.9427880974688, "eps_sum_utility_max": 1658.9421683355083}, "hist_stats": {"episode_reward": [154.07446895442388, 156.20150955751473, 156.45579513399622, 158.7042290377849, 159.02186949069505, 156.80835532669226, 154.41971750415473, 153.45018085520815, 160.1015876280373, 158.19445558355824, 159.95611946093914, 151.52549672593113, 158.69709058636028, 157.4472390619257, 159.43039466547532, 152.63254308283058, 157.21282607739312, 160.56663052701043, 156.3227886936303, 156.8475363267861, 153.45441501982822, 158.92562679309265, 154.1075826069353, 155.34366794756704, 157.05790209501436, 152.16643983985074, 155.88607732563048, 153.1408555576018, 156.35550029523756, 158.31468952736338, 157.33626391113404, 155.39245277908736, 158.0526433576086, 153.52393752772986, 158.5623331707252, 157.58396621706754, 157.34838472265562, 154.06875441737407, 152.56418643241778, 157.97925298625245, 159.39629883121393, 157.65533822985049, 158.51712931891348, 155.05815368148495, 156.5213373159366, 158.08092814438237, 159.67851356439013, 160.38269588262693, 157.77216661229863, 159.708175061928, 159.17670900577042, 157.31564778980947, 158.28056555400235, 156.87254143303988, 155.61688266094575, 154.25775895154197, 152.76986839795757, 156.40067362357712, 157.1541465523594, 156.73251722947867, 155.08173418560335, 154.917109180024, 148.33088956213436, 156.06679423102344, 155.099675853493, 154.4764734265721, 153.3086683158773, 153.93423863540505, 153.76947785606637, 152.18158995210064, 156.12117069516194, 155.03994550182557, 155.17105897881214, 158.27763213613036, 152.5231539074568, 153.11544293955234, 154.02410827974018, 150.95298888409235, 152.16079740129027, 153.36018954236226, 152.83262089912546, 156.06613204306797, 152.25615590107736, 154.66476301079808, 153.2077095323716, 156.63167656558795, 152.08807486897928, 155.05326067432213, 153.53602703299407, 153.23200622734078, 155.55355698969635, 152.7196783752379, 154.87105571940498, 155.36708673706727, 155.70187571634165, 154.93641853258254, 155.09443832878736, 154.11322911398275, 154.171204164975, 154.26831831813803], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_ue_reward": [76.2415182234373, 77.83295073098634, 78.10075477875719, 78.10075477875719, 78.2278975669979, 78.2278975669979, 79.35211451889231, 79.35211451889231, 80.27731406067441, 78.74455543002034, 78.40417766334608, 78.40417766334608, 77.2098587520773, 77.2098587520773, 76.72509042760394, 76.72509042760394, 80.05079381401856, 80.05079381401856, 79.09722779177893, 79.09722779177893, 79.97805973046945, 79.97805973046945, 75.76274836296543, 75.76274836296543, 79.34854529317994, 79.34854529317994, 78.72361953096264, 78.72361953096264, 79.71519733273753, 79.71519733273753, 76.31627154141522, 76.31627154141522, 77.96711254851775, 79.24571352887506, 80.283315263505, 80.283315263505, 77.36567809304051, 78.95711060058959, 78.42376816339295, 78.42376816339295, 77.52292376368857, 75.93149125613951, 79.46281339654617, 79.46281339654617, 77.05379130346756, 77.05379130346756, 77.67183397378331, 77.67183397378331, 78.52895104750706, 78.52895104750706, 76.0832199199253, 76.0832199199253, 77.9430386628151, 77.9430386628151, 76.57042777880088, 76.57042777880088, 78.1777501476186, 78.1777501476186, 79.15734476368152, 79.15734476368152, 78.66813195556686, 78.66813195556686, 77.69622638954358, 77.69622638954358, 79.0263216788042, 79.0263216788042, 76.76196876386483, 76.76196876386483, 79.28116658536243, 79.28116658536243, 78.79198310853364, 78.79198310853364, 78.67419236132766, 78.67419236132766, 76.23866095491229, 77.83009346246135, 76.28209321620884, 76.28209321620884, 78.98962649312598, 78.98962649312598, 79.69814941560679, 79.69814941560679, 78.82766911492513, 78.82766911492513, 79.25856465945655, 79.25856465945655, 77.52907684074232, 77.52907684074232, 78.26066865796811, 78.26066865796811, 79.0404640721911, 79.0404640721911, 79.8392567821949, 79.8392567821949, 80.19134794131324, 80.19134794131324, 78.88608330614915, 78.88608330614915, 79.85408753096381, 79.85408753096381, 79.588354502885, 79.588354502885, 78.65782389490455, 78.65782389490455, 79.14028277700099, 79.14028277700099, 78.43627071651977, 78.43627071651977, 77.8084413304728, 77.8084413304728, 77.12887947577089, 77.12887947577089, 76.38493419897867, 76.38493419897867, 78.20033681178843, 78.20033681178843, 78.57707327617958, 78.57707327617958, 78.3662586147392, 78.3662586147392, 77.54086709280149, 77.54086709280149, 77.45855459001184, 77.45855459001184, 73.5261442908884, 74.80474527124572, 78.03339711551168, 78.03339711551168, 77.54983792674639, 77.54983792674639, 78.00461602861297, 76.4718573979589, 76.6543341579385, 76.6543341579385, 76.96711931770251, 76.96711931770251, 76.88473892803307, 76.88473892803307, 76.09079497605035, 76.09079497605035, 78.06058534758087, 78.06058534758087, 77.51997275091267, 77.51997275091267, 77.58552948940593, 77.58552948940593, 79.13881606806503, 79.13881606806503, 76.2615769537283, 76.2615769537283, 76.557721469776, 76.557721469776, 77.01205413986996, 77.01205413986996, 75.47649444204616, 75.47649444204616, 76.87611495441953, 75.28468244687048, 76.68009477118103, 76.68009477118103, 75.62059419578814, 77.21202670333722, 78.0330660215339, 78.0330660215339, 76.1280779505386, 76.1280779505386, 77.33238150539894, 77.33238150539894, 76.60385476618573, 76.60385476618573, 78.31583828279383, 78.31583828279383, 75.4047369443109, 76.68333792466821, 77.52663033716097, 77.52663033716097, 76.7680135164969, 76.7680135164969, 77.41171936744475, 75.82028685989569, 77.77677849484807, 77.77677849484807, 76.35983918761883, 76.35983918761883, 77.43552785970225, 77.43552785970225, 77.6835433685335, 77.6835433685335, 77.85093785817067, 77.85093785817067, 77.46820926629115, 77.46820926629115, 77.54721916439358, 77.54721916439358, 77.05661455699129, 77.05661455699129, 77.08560208248745, 77.08560208248745, 77.13415915906886, 77.13415915906886]}, "sampler_perf": {"mean_env_wait_ms": 11.082438267790298, "mean_raw_obs_processing_ms": 0.4691738417806634, "mean_inference_ms": 5.435440400241083, "mean_action_processing_ms": 0.14266538594710115}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 100000, "timers": {"sample_time_ms": 3583.047, "sample_throughput": 1116.368, "load_time_ms": 3.659, "load_throughput": 1093305.877, "learn_time_ms": 6690.691, "learn_throughput": 597.846, "update_time_ms": 15.183}, "info": {"learner": {"ue": {"cur_kl_coeff": 0.03750000149011612, "cur_lr": 4.999999873689376e-05, "total_loss": 196.8125, "policy_loss": -0.004787227138876915, "vf_loss": 196.81695556640625, "vf_explained_var": 0.029964013025164604, "kl": 0.00833738874644041, "entropy": 0.588942289352417, "entropy_coeff": 0.0, "model": {}}}, "num_steps_sampled": 100000, "num_steps_trained": 100000}, "done": false, "episodes_total": 1000, "training_iteration": 25, "experiment_id": "f0134eced79d425ca17ebe3d2d0a9c1b", "date": "2021-03-09_10-48-21", "timestamp": 1615283301, "time_this_iter_s": 10.71587324142456, "time_total_s": 274.15682101249695, "pid": 4108, "hostname": "ray02", "node_ip": "131.234.28.177", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "env_config": {"episode_length": 100, "seed": null, "map": "150x100map", "bs_list": ["A", "B"], "ue_list": ["1", "2"], "rand_episodes": false, "new_ue_interval": null, "reward": "sum", "log_metrics": true}, "env": "MultiAgentMobileEnv", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": true, "log_level": "WARN", "callbacks": "<class 'deepcomp.util.callbacks.CustomMetricCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"ue": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Dict(connected:MultiBinary(2), dr:Box(0.0, 1.0, (2,), float32), ues_at_bs:Box(0.0, 1.0, (2,), float32), utility:Box(-1.0, 1.0, (1,), float32))", "Discrete(3)", {}]}, "policy_mapping_fn": "<function create_env_config.<locals>.<lambda> at 0x7f6b55430310>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 274.15682101249695, "timesteps_since_restore": 0, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 28.307142857142853, "ram_util_percent": 4.799999999999999}, "trial_id": "e359b_00000"}
{"episode_reward_max": 161.97284818865444, "episode_reward_min": 151.52549672593113, "episode_reward_mean": 156.63248384205642, "episode_len_mean": 100.0, "episodes_this_iter": 40, "policy_reward_min": {"ue": 75.4047369443109}, "policy_reward_max": {"ue": 80.9864240943271}, "policy_reward_mean": {"ue": 78.31624192102807}, "custom_metrics": {"sum_utility_mean": 16.41226563733938, "sum_utility_min": 8.79708413849351, "sum_utility_max": 21.310345226162607, "eps_sum_utility_mean": 1601.9202361643318, "eps_sum_utility_min": 1548.9959955797528, "eps_sum_utility_max": 1662.3491723388686}, "hist_stats": {"episode_reward": [160.13036815033115, 157.6629575884727, 156.57399774272153, 159.27053597448452, 158.27039497602692, 160.8449580088468, 155.7733453085932, 158.79973849235455, 158.85042742284134, 157.48395599735903, 157.39735112117978, 154.62241269493836, 156.86957733649172, 160.57685041181276, 161.80696000931238, 156.33906715683884, 157.85260852669762, 157.82297049015295, 157.80327893907577, 160.97607226861862, 156.2423337918283, 153.21089197475897, 159.44481738558954, 161.97284818865444, 157.76237618980485, 157.55535580281668, 155.15155011885957, 157.15909725977383, 159.1337547276982, 158.8651970331847, 158.65211443613214, 157.22690808505445, 160.59950351986157, 161.6511066341862, 154.55362323081715, 154.37260055033255, 159.14007932005472, 156.22620810589166, 161.04348689684292, 155.9556467739484, 152.83262089912546, 156.06613204306797, 152.25615590107736, 154.66476301079808, 153.2077095323716, 156.63167656558795, 152.08807486897928, 155.05326067432213, 153.53602703299407, 153.23200622734078, 155.55355698969635, 152.7196783752379, 154.87105571940498, 155.36708673706727, 155.70187571634165, 154.93641853258254, 155.09443832878736, 154.11322911398275, 154.171204164975, 154.26831831813803, 154.07446895442388, 156.20150955751473, 156.45579513399622, 158.7042290377849, 159.02186949069505, 156.80835532669226, 154.41971750415473, 153.45018085520815, 160.1015876280373, 158.19445558355824, 159.95611946093914, 151.52549672593113, 158.69709058636028, 157.4472390619257, 159.43039466547532, 152.63254308283058, 157.21282607739312, 160.56663052701043, 156.3227886936303, 156.8475363267861, 153.45441501982822, 158.92562679309265, 154.1075826069353, 155.34366794756704, 157.05790209501436, 152.16643983985074, 155.88607732563048, 153.1408555576018, 156.35550029523756, 158.31468952736338, 157.33626391113404, 155.39245277908736, 158.0526433576086, 153.52393752772986, 158.5623331707252, 157.58396621706754, 157.34838472265562, 154.06875441737407, 152.56418643241778, 157.97925298625245], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_ue_reward": [80.06518407516533, 80.06518407516533, 78.83147879423615, 78.83147879423615, 78.28699887136062, 78.28699887136062, 79.6352679872421, 79.6352679872421, 79.13519748801329, 79.13519748801329, 80.42247900442318, 80.42247900442318, 77.88667265429646, 77.88667265429646, 79.39986924617709, 79.39986924617709, 79.42521371142045, 79.42521371142045, 78.74197799867937, 78.74197799867937, 78.69867556058978, 78.69867556058978, 77.31120634746905, 77.31120634746905, 78.43478866824569, 78.43478866824569, 80.28842520590626, 80.28842520590626, 80.903480004656, 80.903480004656, 78.16953357841928, 78.16953357841928, 78.92630426334861, 78.92630426334861, 78.9114852450763, 78.9114852450763, 78.90163946953774, 78.90163946953774, 80.4880361343091, 80.4880361343091, 78.12116689591394, 78.12116689591394, 76.60544598737928, 76.60544598737928, 79.72240869279462, 79.72240869279462, 80.9864240943271, 80.9864240943271, 78.88118809490226, 78.88118809490226, 78.77767790140821, 78.77767790140821, 77.57577505942963, 77.57577505942963, 78.57954862988679, 78.57954862988679, 79.56687736384903, 79.56687736384903, 79.4325985165922, 79.4325985165922, 79.32605721806584, 79.32605721806584, 78.61345404252708, 78.61345404252708, 80.29975175993061, 80.29975175993061, 80.82555331709288, 80.82555331709288, 78.07252786918296, 76.4810953616339, 76.39058402139165, 77.9820165289407, 79.57003966002718, 79.57003966002718, 78.11310405294572, 78.11310405294572, 80.5217434484213, 80.5217434484213, 77.97782338697397, 77.97782338697397, 75.62059419578814, 77.21202670333722, 78.0330660215339, 78.0330660215339, 76.1280779505386, 76.1280779505386, 77.33238150539894, 77.33238150539894, 76.60385476618573, 76.60385476618573, 78.31583828279383, 78.31583828279383, 75.4047369443109, 76.68333792466821, 77.52663033716097, 77.52663033716097, 76.7680135164969, 76.7680135164969, 77.41171936744475, 75.82028685989569, 77.77677849484807, 77.77677849484807, 76.35983918761883, 76.35983918761883, 77.43552785970225, 77.43552785970225, 77.6835433685335, 77.6835433685335, 77.85093785817067, 77.85093785817067, 77.46820926629115, 77.46820926629115, 77.54721916439358, 77.54721916439358, 77.05661455699129, 77.05661455699129, 77.08560208248745, 77.08560208248745, 77.13415915906886, 77.13415915906886, 76.2415182234373, 77.83295073098634, 78.10075477875719, 78.10075477875719, 78.2278975669979, 78.2278975669979, 79.35211451889231, 79.35211451889231, 80.27731406067441, 78.74455543002034, 78.40417766334608, 78.40417766334608, 77.2098587520773, 77.2098587520773, 76.72509042760394, 76.72509042760394, 80.05079381401856, 80.05079381401856, 79.09722779177893, 79.09722779177893, 79.97805973046945, 79.97805973046945, 75.76274836296543, 75.76274836296543, 79.34854529317994, 79.34854529317994, 78.72361953096264, 78.72361953096264, 79.71519733273753, 79.71519733273753, 76.31627154141522, 76.31627154141522, 77.96711254851775, 79.24571352887506, 80.283315263505, 80.283315263505, 77.36567809304051, 78.95711060058959, 78.42376816339295, 78.42376816339295, 77.52292376368857, 75.93149125613951, 79.46281339654617, 79.46281339654617, 77.05379130346756, 77.05379130346756, 77.67183397378331, 77.67183397378331, 78.52895104750706, 78.52895104750706, 76.0832199199253, 76.0832199199253, 77.9430386628151, 77.9430386628151, 76.57042777880088, 76.57042777880088, 78.1777501476186, 78.1777501476186, 79.15734476368152, 79.15734476368152, 78.66813195556686, 78.66813195556686, 77.69622638954358, 77.69622638954358, 79.0263216788042, 79.0263216788042, 76.76196876386483, 76.76196876386483, 79.28116658536243, 79.28116658536243, 78.79198310853364, 78.79198310853364, 78.67419236132766, 78.67419236132766, 76.23866095491229, 77.83009346246135, 76.28209321620884, 76.28209321620884, 78.98962649312598, 78.98962649312598]}, "sampler_perf": {"mean_env_wait_ms": 11.100396115875958, "mean_raw_obs_processing_ms": 0.4669732674574271, "mean_inference_ms": 5.413913324549697, "mean_action_processing_ms": 0.14158216040635338}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 104000, "timers": {"sample_time_ms": 3609.969, "sample_throughput": 1108.043, "load_time_ms": 3.634, "load_throughput": 1100628.866, "learn_time_ms": 6724.241, "learn_throughput": 594.863, "update_time_ms": 14.493}, "info": {"learner": {"ue": {"cur_kl_coeff": 0.03750000149011612, "cur_lr": 4.999999873689376e-05, "total_loss": 198.7934112548828, "policy_loss": -0.002300369320437312, "vf_loss": 198.79539489746094, "vf_explained_var": 0.03440757095813751, "kl": 0.008432947099208832, "entropy": 0.5763939023017883, "entropy_coeff": 0.0, "model": {}}}, "num_steps_sampled": 104000, "num_steps_trained": 104000}, "done": false, "episodes_total": 1040, "training_iteration": 26, "experiment_id": "f0134eced79d425ca17ebe3d2d0a9c1b", "date": "2021-03-09_10-48-32", "timestamp": 1615283312, "time_this_iter_s": 10.75152063369751, "time_total_s": 284.90834164619446, "pid": 4108, "hostname": "ray02", "node_ip": "131.234.28.177", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "env_config": {"episode_length": 100, "seed": null, "map": "150x100map", "bs_list": ["A", "B"], "ue_list": ["1", "2"], "rand_episodes": false, "new_ue_interval": null, "reward": "sum", "log_metrics": true}, "env": "MultiAgentMobileEnv", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": true, "log_level": "WARN", "callbacks": "<class 'deepcomp.util.callbacks.CustomMetricCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"ue": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Dict(connected:MultiBinary(2), dr:Box(0.0, 1.0, (2,), float32), ues_at_bs:Box(0.0, 1.0, (2,), float32), utility:Box(-1.0, 1.0, (1,), float32))", "Discrete(3)", {}]}, "policy_mapping_fn": "<function create_env_config.<locals>.<lambda> at 0x7f6b554303a0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 284.90834164619446, "timesteps_since_restore": 0, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 28.933333333333337, "ram_util_percent": 4.799999999999999}, "trial_id": "e359b_00000"}
{"episode_reward_max": 161.97284818865444, "episode_reward_min": 150.92007269593807, "episode_reward_mean": 156.9879325627439, "episode_len_mean": 100.0, "episodes_this_iter": 40, "policy_reward_min": {"ue": 74.6643200941944}, "policy_reward_max": {"ue": 80.9864240943271}, "policy_reward_mean": {"ue": 78.49396628137178}, "custom_metrics": {"sum_utility_mean": 16.711985217898206, "sum_utility_min": 10.206592306948258, "sum_utility_max": 21.310345226162607, "eps_sum_utility_mean": 1610.5723902776797, "eps_sum_utility_min": 1547.735742487196, "eps_sum_utility_max": 1662.3491723388686}, "hist_stats": {"episode_reward": [160.7669016441506, 156.89762207322457, 157.07119048368764, 158.28278664730698, 158.21570038833988, 158.60124817991965, 156.7344861862003, 156.83308264175025, 158.0128040644123, 157.49638956703035, 157.19586924917138, 153.89507635848696, 150.92007269593807, 154.98743850294466, 158.7132240381403, 159.31908578002736, 157.14761624424557, 159.71504780869884, 153.0997430471375, 155.1930704453271, 153.74860993949432, 157.76370456774788, 158.22757188910083, 156.77037082563538, 151.4802809850736, 157.82141080201882, 157.2071661581195, 157.05113297278086, 155.33843009948754, 157.1576744144299, 153.00299485380435, 153.66637818021758, 155.90755689909605, 154.5544273697542, 155.47480268730567, 157.03323163724366, 155.28781430719437, 155.5108193006721, 161.08423860258227, 156.79392256307295, 153.45441501982822, 158.92562679309265, 154.1075826069353, 155.34366794756704, 157.05790209501436, 152.16643983985074, 155.88607732563048, 153.1408555576018, 156.35550029523756, 158.31468952736338, 157.33626391113404, 155.39245277908736, 158.0526433576086, 153.52393752772986, 158.5623331707252, 157.58396621706754, 157.34838472265562, 154.06875441737407, 152.56418643241778, 157.97925298625245, 160.13036815033115, 157.6629575884727, 156.57399774272153, 159.27053597448452, 158.27039497602692, 160.8449580088468, 155.7733453085932, 158.79973849235455, 158.85042742284134, 157.48395599735903, 157.39735112117978, 154.62241269493836, 156.86957733649172, 160.57685041181276, 161.80696000931238, 156.33906715683884, 157.85260852669762, 157.82297049015295, 157.80327893907577, 160.97607226861862, 156.2423337918283, 153.21089197475897, 159.44481738558954, 161.97284818865444, 157.76237618980485, 157.55535580281668, 155.15155011885957, 157.15909725977383, 159.1337547276982, 158.8651970331847, 158.65211443613214, 157.22690808505445, 160.59950351986157, 161.6511066341862, 154.55362323081715, 154.37260055033255, 159.14007932005472, 156.22620810589166, 161.04348689684292, 155.9556467739484], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_ue_reward": [80.38345082207513, 80.38345082207513, 78.44881103661216, 78.44881103661216, 78.53559524184372, 78.53559524184372, 79.14139332365328, 79.14139332365328, 79.10785019416984, 79.10785019416984, 79.30062408995965, 79.30062408995965, 78.3672430931, 78.3672430931, 78.41654132087494, 78.41654132087494, 79.00640203220603, 79.00640203220603, 78.74819478351499, 78.74819478351499, 78.59793462458559, 78.59793462458559, 76.94753817924334, 76.94753817924334, 76.25575260174345, 74.6643200941944, 77.49371925147221, 77.49371925147221, 79.35661201907, 79.35661201907, 79.65954289001355, 79.65954289001355, 78.57380812212259, 78.57380812212259, 79.8575239043493, 79.8575239043493, 76.54987152356867, 76.54987152356867, 78.39225147643796, 76.8008189688889, 76.87430496974707, 76.87430496974707, 78.88185228387381, 78.88185228387381, 79.11378594455024, 79.11378594455024, 78.38518541281753, 78.38518541281753, 74.94442423876212, 76.53585674631118, 78.9107054010092, 78.9107054010092, 78.60358307905956, 78.60358307905956, 78.52556648639028, 78.52556648639028, 78.4649313035181, 76.87349879596904, 78.57883720721482, 78.57883720721482, 76.50149742690212, 76.50149742690212, 78.42462159765772, 75.24175658255959, 77.95377844954787, 77.95377844954787, 77.27721368487695, 77.27721368487695, 77.7374013436527, 77.7374013436527, 78.51661581862172, 78.51661581862172, 77.643907153597, 77.643907153597, 77.75540965033584, 77.75540965033584, 80.54211930129092, 80.54211930129092, 78.39696128153638, 78.39696128153638, 77.52292376368857, 75.93149125613951, 79.46281339654617, 79.46281339654617, 77.05379130346756, 77.05379130346756, 77.67183397378331, 77.67183397378331, 78.52895104750706, 78.52895104750706, 76.0832199199253, 76.0832199199253, 77.9430386628151, 77.9430386628151, 76.57042777880088, 76.57042777880088, 78.1777501476186, 78.1777501476186, 79.15734476368152, 79.15734476368152, 78.66813195556686, 78.66813195556686, 77.69622638954358, 77.69622638954358, 79.0263216788042, 79.0263216788042, 76.76196876386483, 76.76196876386483, 79.28116658536243, 79.28116658536243, 78.79198310853364, 78.79198310853364, 78.67419236132766, 78.67419236132766, 76.23866095491229, 77.83009346246135, 76.28209321620884, 76.28209321620884, 78.98962649312598, 78.98962649312598, 80.06518407516533, 80.06518407516533, 78.83147879423615, 78.83147879423615, 78.28699887136062, 78.28699887136062, 79.6352679872421, 79.6352679872421, 79.13519748801329, 79.13519748801329, 80.42247900442318, 80.42247900442318, 77.88667265429646, 77.88667265429646, 79.39986924617709, 79.39986924617709, 79.42521371142045, 79.42521371142045, 78.74197799867937, 78.74197799867937, 78.69867556058978, 78.69867556058978, 77.31120634746905, 77.31120634746905, 78.43478866824569, 78.43478866824569, 80.28842520590626, 80.28842520590626, 80.903480004656, 80.903480004656, 78.16953357841928, 78.16953357841928, 78.92630426334861, 78.92630426334861, 78.9114852450763, 78.9114852450763, 78.90163946953774, 78.90163946953774, 80.4880361343091, 80.4880361343091, 78.12116689591394, 78.12116689591394, 76.60544598737928, 76.60544598737928, 79.72240869279462, 79.72240869279462, 80.9864240943271, 80.9864240943271, 78.88118809490226, 78.88118809490226, 78.77767790140821, 78.77767790140821, 77.57577505942963, 77.57577505942963, 78.57954862988679, 78.57954862988679, 79.56687736384903, 79.56687736384903, 79.4325985165922, 79.4325985165922, 79.32605721806584, 79.32605721806584, 78.61345404252708, 78.61345404252708, 80.29975175993061, 80.29975175993061, 80.82555331709288, 80.82555331709288, 78.07252786918296, 76.4810953616339, 76.39058402139165, 77.9820165289407, 79.57003966002718, 79.57003966002718, 78.11310405294572, 78.11310405294572, 80.5217434484213, 80.5217434484213, 77.97782338697397, 77.97782338697397]}, "sampler_perf": {"mean_env_wait_ms": 11.10123468374269, "mean_raw_obs_processing_ms": 0.4667827771903296, "mean_inference_ms": 5.390444122206094, "mean_action_processing_ms": 0.13982798880741573}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 108000, "timers": {"sample_time_ms": 3605.453, "sample_throughput": 1109.431, "load_time_ms": 3.625, "load_throughput": 1103568.182, "learn_time_ms": 6749.763, "learn_throughput": 592.613, "update_time_ms": 12.622}, "info": {"learner": {"ue": {"cur_kl_coeff": 0.03750000149011612, "cur_lr": 4.999999873689376e-05, "total_loss": 195.45799255371094, "policy_loss": -0.0025138601195067167, "vf_loss": 195.4602508544922, "vf_explained_var": 0.03166080266237259, "kl": 0.0071355728432536125, "entropy": 0.5650027394294739, "entropy_coeff": 0.0, "model": {}}}, "num_steps_sampled": 108000, "num_steps_trained": 108000}, "done": false, "episodes_total": 1080, "training_iteration": 27, "experiment_id": "f0134eced79d425ca17ebe3d2d0a9c1b", "date": "2021-03-09_10-48-42", "timestamp": 1615283322, "time_this_iter_s": 10.424684047698975, "time_total_s": 295.33302569389343, "pid": 4108, "hostname": "ray02", "node_ip": "131.234.28.177", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "env_config": {"episode_length": 100, "seed": null, "map": "150x100map", "bs_list": ["A", "B"], "ue_list": ["1", "2"], "rand_episodes": false, "new_ue_interval": null, "reward": "sum", "log_metrics": true}, "env": "MultiAgentMobileEnv", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": true, "log_level": "WARN", "callbacks": "<class 'deepcomp.util.callbacks.CustomMetricCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"ue": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Dict(connected:MultiBinary(2), dr:Box(0.0, 1.0, (2,), float32), ues_at_bs:Box(0.0, 1.0, (2,), float32), utility:Box(-1.0, 1.0, (1,), float32))", "Discrete(3)", {}]}, "policy_mapping_fn": "<function create_env_config.<locals>.<lambda> at 0x7f6b553b7430>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 295.33302569389343, "timesteps_since_restore": 0, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 27.493333333333336, "ram_util_percent": 4.799999999999999}, "trial_id": "e359b_00000"}
{"episode_reward_max": 162.18106400564852, "episode_reward_min": 150.92007269593807, "episode_reward_mean": 156.81344749696484, "episode_len_mean": 100.0, "episodes_this_iter": 40, "policy_reward_min": {"ue": 74.6643200941944}, "policy_reward_max": {"ue": 81.09053200282405}, "policy_reward_mean": {"ue": 78.40672374848228}, "custom_metrics": {"sum_utility_mean": 16.387302810987745, "sum_utility_min": 8.79708413849351, "sum_utility_max": 21.310345226162607, "eps_sum_utility_mean": 1607.7131581384829, "eps_sum_utility_min": 1547.735742487196, "eps_sum_utility_max": 1662.3491723388686}, "hist_stats": {"episode_reward": [156.9537337040282, 157.59571448374697, 157.66196244864614, 152.63731135577376, 156.40966671193678, 157.85852413671194, 159.1635782260998, 158.0828282883162, 155.94385920054322, 154.91674350643973, 153.96454753957556, 155.24715400370167, 156.28296022672458, 156.8183241439428, 153.98354848871702, 158.211544756639, 157.0276464395236, 162.18106400564852, 155.59007588019108, 157.57767913124167, 157.50480406154526, 155.65765802462028, 157.58185241708742, 156.56025232513105, 155.57603550853798, 155.61837071047017, 152.86360125197137, 154.76862371469747, 152.8867393063781, 157.82081742685097, 156.18050182174733, 157.54893391723732, 155.73678082705788, 157.48603770829658, 158.79492462773044, 158.38548210333693, 158.03825594578382, 158.25839335315095, 154.97033054650922, 159.09739229313368, 156.2423337918283, 153.21089197475897, 159.44481738558954, 161.97284818865444, 157.76237618980485, 157.55535580281668, 155.15155011885957, 157.15909725977383, 159.1337547276982, 158.8651970331847, 158.65211443613214, 157.22690808505445, 160.59950351986157, 161.6511066341862, 154.55362323081715, 154.37260055033255, 159.14007932005472, 156.22620810589166, 161.04348689684292, 155.9556467739484, 160.7669016441506, 156.89762207322457, 157.07119048368764, 158.28278664730698, 158.21570038833988, 158.60124817991965, 156.7344861862003, 156.83308264175025, 158.0128040644123, 157.49638956703035, 157.19586924917138, 153.89507635848696, 150.92007269593807, 154.98743850294466, 158.7132240381403, 159.31908578002736, 157.14761624424557, 159.71504780869884, 153.0997430471375, 155.1930704453271, 153.74860993949432, 157.76370456774788, 158.22757188910083, 156.77037082563538, 151.4802809850736, 157.82141080201882, 157.2071661581195, 157.05113297278086, 155.33843009948754, 157.1576744144299, 153.00299485380435, 153.66637818021758, 155.90755689909605, 154.5544273697542, 155.47480268730567, 157.03323163724366, 155.28781430719437, 155.5108193006721, 161.08423860258227, 156.79392256307295], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_ue_reward": [78.47686685201397, 78.47686685201397, 78.79785724187327, 78.79785724187327, 78.83098122432287, 78.83098122432287, 76.9579561680654, 75.67935518770808, 78.20483335596832, 78.20483335596832, 78.92926206835588, 78.92926206835588, 79.58178911304968, 79.58178911304968, 79.04141414415797, 79.04141414415797, 77.97192960027145, 77.97192960027145, 77.45837175321972, 77.45837175321972, 76.98227376978771, 76.98227376978771, 78.4192932556252, 76.82786074807615, 78.93719636713669, 77.34576385958763, 78.40916207197127, 78.40916207197127, 76.19605799058385, 77.78749049813288, 79.10577237831927, 79.10577237831927, 78.51382321976159, 78.51382321976159, 81.09053200282405, 81.09053200282405, 77.79503794009543, 77.79503794009543, 78.78883956562068, 78.78883956562068, 78.75240203077249, 78.75240203077249, 78.46812950248864, 77.1895285221313, 78.7909262085435, 78.7909262085435, 78.28012616256532, 78.28012616256532, 77.1487172640901, 78.42731824444743, 77.80918535523492, 77.80918535523492, 77.22751687976017, 75.63608437221112, 77.38431185734858, 77.38431185734858, 76.44336965318885, 76.44336965318885, 78.91040871342531, 78.91040871342531, 78.09025091087354, 78.09025091087354, 78.77446695861852, 78.77446695861852, 77.86839041352877, 77.86839041352877, 78.74301885414813, 78.74301885414813, 79.39746231386499, 79.39746231386499, 79.19274105166828, 79.19274105166828, 79.01912797289175, 79.01912797289175, 79.1291966765753, 79.1291966765753, 77.48516527325442, 77.48516527325442, 79.54869614656666, 79.54869614656666, 78.12116689591394, 78.12116689591394, 76.60544598737928, 76.60544598737928, 79.72240869279462, 79.72240869279462, 80.9864240943271, 80.9864240943271, 78.88118809490226, 78.88118809490226, 78.77767790140821, 78.77767790140821, 77.57577505942963, 77.57577505942963, 78.57954862988679, 78.57954862988679, 79.56687736384903, 79.56687736384903, 79.4325985165922, 79.4325985165922, 79.32605721806584, 79.32605721806584, 78.61345404252708, 78.61345404252708, 80.29975175993061, 80.29975175993061, 80.82555331709288, 80.82555331709288, 78.07252786918296, 76.4810953616339, 76.39058402139165, 77.9820165289407, 79.57003966002718, 79.57003966002718, 78.11310405294572, 78.11310405294572, 80.5217434484213, 80.5217434484213, 77.97782338697397, 77.97782338697397, 80.38345082207513, 80.38345082207513, 78.44881103661216, 78.44881103661216, 78.53559524184372, 78.53559524184372, 79.14139332365328, 79.14139332365328, 79.10785019416984, 79.10785019416984, 79.30062408995965, 79.30062408995965, 78.3672430931, 78.3672430931, 78.41654132087494, 78.41654132087494, 79.00640203220603, 79.00640203220603, 78.74819478351499, 78.74819478351499, 78.59793462458559, 78.59793462458559, 76.94753817924334, 76.94753817924334, 76.25575260174345, 74.6643200941944, 77.49371925147221, 77.49371925147221, 79.35661201907, 79.35661201907, 79.65954289001355, 79.65954289001355, 78.57380812212259, 78.57380812212259, 79.8575239043493, 79.8575239043493, 76.54987152356867, 76.54987152356867, 78.39225147643796, 76.8008189688889, 76.87430496974707, 76.87430496974707, 78.88185228387381, 78.88185228387381, 79.11378594455024, 79.11378594455024, 78.38518541281753, 78.38518541281753, 74.94442423876212, 76.53585674631118, 78.9107054010092, 78.9107054010092, 78.60358307905956, 78.60358307905956, 78.52556648639028, 78.52556648639028, 78.4649313035181, 76.87349879596904, 78.57883720721482, 78.57883720721482, 76.50149742690212, 76.50149742690212, 78.42462159765772, 75.24175658255959, 77.95377844954787, 77.95377844954787, 77.27721368487695, 77.27721368487695, 77.7374013436527, 77.7374013436527, 78.51661581862172, 78.51661581862172, 77.643907153597, 77.643907153597, 77.75540965033584, 77.75540965033584, 80.54211930129092, 80.54211930129092, 78.39696128153638, 78.39696128153638]}, "sampler_perf": {"mean_env_wait_ms": 11.095606952735967, "mean_raw_obs_processing_ms": 0.4664119607680267, "mean_inference_ms": 5.368173778783489, "mean_action_processing_ms": 0.13841769921246128}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 112000, "timers": {"sample_time_ms": 3597.011, "sample_throughput": 1112.034, "load_time_ms": 3.565, "load_throughput": 1122041.679, "learn_time_ms": 6711.037, "learn_throughput": 596.033, "update_time_ms": 11.835}, "info": {"learner": {"ue": {"cur_kl_coeff": 0.03750000149011612, "cur_lr": 4.999999873689376e-05, "total_loss": 195.3311309814453, "policy_loss": -0.0036871000193059444, "vf_loss": 195.3346405029297, "vf_explained_var": 0.034006476402282715, "kl": 0.005422229878604412, "entropy": 0.6017858982086182, "entropy_coeff": 0.0, "model": {}}}, "num_steps_sampled": 112000, "num_steps_trained": 112000}, "done": false, "episodes_total": 1120, "training_iteration": 28, "experiment_id": "f0134eced79d425ca17ebe3d2d0a9c1b", "date": "2021-03-09_10-48-52", "timestamp": 1615283332, "time_this_iter_s": 10.051663398742676, "time_total_s": 305.3846890926361, "pid": 4108, "hostname": "ray02", "node_ip": "131.234.28.177", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "env_config": {"episode_length": 100, "seed": null, "map": "150x100map", "bs_list": ["A", "B"], "ue_list": ["1", "2"], "rand_episodes": false, "new_ue_interval": null, "reward": "sum", "log_metrics": true}, "env": "MultiAgentMobileEnv", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": true, "log_level": "WARN", "callbacks": "<class 'deepcomp.util.callbacks.CustomMetricCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"ue": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Dict(connected:MultiBinary(2), dr:Box(0.0, 1.0, (2,), float32), ues_at_bs:Box(0.0, 1.0, (2,), float32), utility:Box(-1.0, 1.0, (1,), float32))", "Discrete(3)", {}]}, "policy_mapping_fn": "<function create_env_config.<locals>.<lambda> at 0x7f6b55430e50>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 305.3846890926361, "timesteps_since_restore": 0, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 29.407142857142855, "ram_util_percent": 4.799999999999999}, "trial_id": "e359b_00000"}
{"episode_reward_max": 162.18106400564852, "episode_reward_min": 151.4802809850736, "episode_reward_mean": 156.71846374868903, "episode_len_mean": 100.0, "episodes_this_iter": 40, "policy_reward_min": {"ue": 74.94442423876212}, "policy_reward_max": {"ue": 81.09053200282405}, "policy_reward_mean": {"ue": 78.35923187434437}, "custom_metrics": {"sum_utility_mean": 16.15141570750147, "sum_utility_min": 8.79708413849351, "sum_utility_max": 21.310345226162607, "eps_sum_utility_mean": 1605.4944709874708, "eps_sum_utility_min": 1551.4327024285142, "eps_sum_utility_max": 1656.9219255809705}, "hist_stats": {"episode_reward": [159.97257634195518, 153.2494513538743, 157.90666360463678, 160.33616569590896, 157.5012566333345, 152.262098139711, 159.24667113756163, 157.30162400853186, 158.78555503949582, 158.6848080602207, 159.51875386832364, 158.25012063618595, 157.05497154996408, 154.3747823740399, 158.0678139498258, 160.64440910051047, 157.94418220588557, 161.43012351286472, 155.22260614615578, 156.8734225393253, 153.73940708994098, 154.23346412681877, 158.64004371422283, 155.01451816890795, 159.00386359558223, 155.45430840765783, 156.01417993881853, 154.8789864207206, 158.05496292034604, 159.4537751656601, 157.04541765294567, 157.93050170622985, 158.02003620045264, 155.48762099507223, 154.15464603570348, 156.02191459123304, 154.6884466334177, 152.85478717967374, 158.89080560973218, 161.3098391932017, 153.74860993949432, 157.76370456774788, 158.22757188910083, 156.77037082563538, 151.4802809850736, 157.82141080201882, 157.2071661581195, 157.05113297278086, 155.33843009948754, 157.1576744144299, 153.00299485380435, 153.66637818021758, 155.90755689909605, 154.5544273697542, 155.47480268730567, 157.03323163724366, 155.28781430719437, 155.5108193006721, 161.08423860258227, 156.79392256307295, 156.9537337040282, 157.59571448374697, 157.66196244864614, 152.63731135577376, 156.40966671193678, 157.85852413671194, 159.1635782260998, 158.0828282883162, 155.94385920054322, 154.91674350643973, 153.96454753957556, 155.24715400370167, 156.28296022672458, 156.8183241439428, 153.98354848871702, 158.211544756639, 157.0276464395236, 162.18106400564852, 155.59007588019108, 157.57767913124167, 157.50480406154526, 155.65765802462028, 157.58185241708742, 156.56025232513105, 155.57603550853798, 155.61837071047017, 152.86360125197137, 154.76862371469747, 152.8867393063781, 157.82081742685097, 156.18050182174733, 157.54893391723732, 155.73678082705788, 157.48603770829658, 158.79492462773044, 158.38548210333693, 158.03825594578382, 158.25839335315095, 154.97033054650922, 159.09739229313368], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_ue_reward": [79.98628817097747, 79.98628817097747, 76.62472567693703, 76.62472567693703, 78.95333180231827, 78.95333180231827, 80.16808284795428, 80.16808284795428, 78.75062831666708, 78.75062831666708, 76.13104906985538, 76.13104906985538, 79.62333556878065, 79.62333556878065, 78.65081200426576, 78.65081200426576, 79.39277751974775, 79.39277751974775, 79.34240403011016, 79.34240403011016, 79.75937693416166, 79.75937693416166, 78.48575982791408, 79.76436080827139, 78.52748577498194, 78.52748577498194, 77.18739118701978, 77.18739118701978, 79.03390697491265, 79.03390697491265, 80.32220455025507, 80.32220455025507, 78.97209110294264, 78.97209110294264, 80.71506175643216, 80.71506175643216, 77.61130307307774, 77.61130307307774, 78.43671126966258, 78.43671126966258, 76.86970354497048, 76.86970354497048, 77.11673206340924, 77.11673206340924, 79.32002185711124, 79.32002185711124, 76.71154283067929, 78.30297533822835, 79.50193179779096, 79.50193179779096, 78.5228704576033, 76.93143795005423, 78.00708996940908, 78.00708996940908, 77.43949321036024, 77.43949321036024, 79.02748146017281, 79.02748146017281, 79.72688758282983, 79.72688758282983, 78.52270882647262, 78.52270882647262, 78.96525085311472, 78.96525085311472, 79.01001810022613, 79.01001810022613, 77.74381049753595, 77.74381049753595, 77.07732301785161, 77.07732301785161, 78.01095729561649, 78.01095729561649, 78.13993957048329, 76.54850706293423, 76.42739358983685, 76.42739358983685, 79.44540280486596, 79.44540280486596, 80.65491959660065, 80.65491959660065, 76.87430496974707, 76.87430496974707, 78.88185228387381, 78.88185228387381, 79.11378594455024, 79.11378594455024, 78.38518541281753, 78.38518541281753, 74.94442423876212, 76.53585674631118, 78.9107054010092, 78.9107054010092, 78.60358307905956, 78.60358307905956, 78.52556648639028, 78.52556648639028, 78.4649313035181, 76.87349879596904, 78.57883720721482, 78.57883720721482, 76.50149742690212, 76.50149742690212, 78.42462159765772, 75.24175658255959, 77.95377844954787, 77.95377844954787, 77.27721368487695, 77.27721368487695, 77.7374013436527, 77.7374013436527, 78.51661581862172, 78.51661581862172, 77.643907153597, 77.643907153597, 77.75540965033584, 77.75540965033584, 80.54211930129092, 80.54211930129092, 78.39696128153638, 78.39696128153638, 78.47686685201397, 78.47686685201397, 78.79785724187327, 78.79785724187327, 78.83098122432287, 78.83098122432287, 76.9579561680654, 75.67935518770808, 78.20483335596832, 78.20483335596832, 78.92926206835588, 78.92926206835588, 79.58178911304968, 79.58178911304968, 79.04141414415797, 79.04141414415797, 77.97192960027145, 77.97192960027145, 77.45837175321972, 77.45837175321972, 76.98227376978771, 76.98227376978771, 78.4192932556252, 76.82786074807615, 78.93719636713669, 77.34576385958763, 78.40916207197127, 78.40916207197127, 76.19605799058385, 77.78749049813288, 79.10577237831927, 79.10577237831927, 78.51382321976159, 78.51382321976159, 81.09053200282405, 81.09053200282405, 77.79503794009543, 77.79503794009543, 78.78883956562068, 78.78883956562068, 78.75240203077249, 78.75240203077249, 78.46812950248864, 77.1895285221313, 78.7909262085435, 78.7909262085435, 78.28012616256532, 78.28012616256532, 77.1487172640901, 78.42731824444743, 77.80918535523492, 77.80918535523492, 77.22751687976017, 75.63608437221112, 77.38431185734858, 77.38431185734858, 76.44336965318885, 76.44336965318885, 78.91040871342531, 78.91040871342531, 78.09025091087354, 78.09025091087354, 78.77446695861852, 78.77446695861852, 77.86839041352877, 77.86839041352877, 78.74301885414813, 78.74301885414813, 79.39746231386499, 79.39746231386499, 79.19274105166828, 79.19274105166828, 79.01912797289175, 79.01912797289175, 79.1291966765753, 79.1291966765753, 77.48516527325442, 77.48516527325442, 79.54869614656666, 79.54869614656666]}, "sampler_perf": {"mean_env_wait_ms": 11.078357553048308, "mean_raw_obs_processing_ms": 0.4664302359494097, "mean_inference_ms": 5.3507972657908525, "mean_action_processing_ms": 0.13695836472979717}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 116000, "timers": {"sample_time_ms": 3555.191, "sample_throughput": 1125.115, "load_time_ms": 3.287, "load_throughput": 1216824.851, "learn_time_ms": 6656.47, "learn_throughput": 600.919, "update_time_ms": 10.091}, "info": {"learner": {"ue": {"cur_kl_coeff": 0.03750000149011612, "cur_lr": 4.999999873689376e-05, "total_loss": 198.28431701660156, "policy_loss": -0.0038969661109149456, "vf_loss": 198.2879638671875, "vf_explained_var": 0.030421890318393707, "kl": 0.005474756937474012, "entropy": 0.5751044750213623, "entropy_coeff": 0.0, "model": {}}}, "num_steps_sampled": 116000, "num_steps_trained": 116000}, "done": false, "episodes_total": 1160, "training_iteration": 29, "experiment_id": "f0134eced79d425ca17ebe3d2d0a9c1b", "date": "2021-03-09_10-49-02", "timestamp": 1615283342, "time_this_iter_s": 10.106802225112915, "time_total_s": 315.491491317749, "pid": 4108, "hostname": "ray02", "node_ip": "131.234.28.177", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "env_config": {"episode_length": 100, "seed": null, "map": "150x100map", "bs_list": ["A", "B"], "ue_list": ["1", "2"], "rand_episodes": false, "new_ue_interval": null, "reward": "sum", "log_metrics": true}, "env": "MultiAgentMobileEnv", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": true, "log_level": "WARN", "callbacks": "<class 'deepcomp.util.callbacks.CustomMetricCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"ue": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Dict(connected:MultiBinary(2), dr:Box(0.0, 1.0, (2,), float32), ues_at_bs:Box(0.0, 1.0, (2,), float32), utility:Box(-1.0, 1.0, (1,), float32))", "Discrete(3)", {}]}, "policy_mapping_fn": "<function create_env_config.<locals>.<lambda> at 0x7f6a94b53700>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 315.491491317749, "timesteps_since_restore": 0, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 28.728571428571428, "ram_util_percent": 4.799999999999999}, "trial_id": "e359b_00000"}
{"episode_reward_max": 162.06494096933102, "episode_reward_min": 152.262098139711, "episode_reward_mean": 157.09980182425636, "episode_len_mean": 100.0, "episodes_this_iter": 40, "policy_reward_min": {"ue": 75.63608437221112}, "policy_reward_max": {"ue": 81.03247048466527}, "policy_reward_mean": {"ue": 78.54990091212804}, "custom_metrics": {"sum_utility_mean": 15.901910968188028, "sum_utility_min": 8.79708413849351, "sum_utility_max": 21.310345226162607, "eps_sum_utility_mean": 1607.3024936996874, "eps_sum_utility_min": 1551.241442296072, "eps_sum_utility_max": 1656.9219255809705}, "hist_stats": {"episode_reward": [157.71535026756698, 153.830653289836, 155.5640230130124, 160.4366457102788, 156.1174416999475, 158.36035859122296, 158.73658688418033, 156.75108103921696, 156.51075775561924, 156.80767831041425, 154.2826275012509, 158.69579971494744, 158.0109662988367, 158.19576489190075, 158.17758187031478, 155.55031340025107, 158.46913849407554, 157.92574880450792, 158.8597189375679, 158.11140880667614, 159.20757484760895, 155.82329680343855, 158.13166349569468, 157.57115445090972, 155.13354116034867, 158.78758920039786, 156.30820520985327, 158.1965099381814, 160.2554713586813, 152.92123910353934, 156.36987496877623, 156.88138206750153, 159.35455656826156, 159.80282543667602, 154.97550976134352, 156.9823486168508, 153.11675253414052, 158.21482336812824, 155.91590814842573, 162.06494096933102, 157.50480406154526, 155.65765802462028, 157.58185241708742, 156.56025232513105, 155.57603550853798, 155.61837071047017, 152.86360125197137, 154.76862371469747, 152.8867393063781, 157.82081742685097, 156.18050182174733, 157.54893391723732, 155.73678082705788, 157.48603770829658, 158.79492462773044, 158.38548210333693, 158.03825594578382, 158.25839335315095, 154.97033054650922, 159.09739229313368, 159.97257634195518, 153.2494513538743, 157.90666360463678, 160.33616569590896, 157.5012566333345, 152.262098139711, 159.24667113756163, 157.30162400853186, 158.78555503949582, 158.6848080602207, 159.51875386832364, 158.25012063618595, 157.05497154996408, 154.3747823740399, 158.0678139498258, 160.64440910051047, 157.94418220588557, 161.43012351286472, 155.22260614615578, 156.8734225393253, 153.73940708994098, 154.23346412681877, 158.64004371422283, 155.01451816890795, 159.00386359558223, 155.45430840765783, 156.01417993881853, 154.8789864207206, 158.05496292034604, 159.4537751656601, 157.04541765294567, 157.93050170622985, 158.02003620045264, 155.48762099507223, 154.15464603570348, 156.02191459123304, 154.6884466334177, 152.85478717967374, 158.89080560973218, 161.3098391932017], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_ue_reward": [78.85767513378337, 78.85767513378337, 76.91532664491787, 76.91532664491787, 77.78201150650608, 77.78201150650608, 80.2183228551392, 80.2183228551392, 78.0587208499736, 78.0587208499736, 79.18017929561124, 79.18017929561124, 79.36829344208999, 79.36829344208999, 78.37554051960835, 78.37554051960835, 78.25537887780948, 78.25537887780948, 78.40383915520707, 78.40383915520707, 77.14131375062532, 77.14131375062532, 79.34789985747359, 79.34789985747359, 79.00548314941818, 79.00548314941818, 79.0978824459503, 79.0978824459503, 79.08879093515722, 79.08879093515722, 77.77515670012532, 77.77515670012532, 79.23456924703763, 79.23456924703763, 78.96287440225376, 78.96287440225376, 79.42985946878387, 79.42985946878387, 79.05570440333791, 79.05570440333791, 79.60378742380432, 79.60378742380432, 77.91164840171922, 77.91164840171922, 79.06583174784711, 79.06583174784711, 78.78557722545467, 78.78557722545467, 77.5667705801742, 77.5667705801742, 79.39379460019872, 79.39379460019872, 78.15410260492645, 78.15410260492645, 79.09825496909053, 79.09825496909053, 80.12773567934059, 80.12773567934059, 76.46061955176953, 76.46061955176953, 78.18493748438799, 78.18493748438799, 78.44069103375064, 78.44069103375064, 79.67727828413065, 79.67727828413065, 79.90141271833782, 79.90141271833782, 78.28347113444617, 76.6920386268971, 78.49117430842522, 78.49117430842522, 76.55837626707012, 76.55837626707012, 79.10741168406389, 79.10741168406389, 77.95795407421272, 77.95795407421272, 81.03247048466527, 81.03247048466527, 78.75240203077249, 78.75240203077249, 78.46812950248864, 77.1895285221313, 78.7909262085435, 78.7909262085435, 78.28012616256532, 78.28012616256532, 77.1487172640901, 78.42731824444743, 77.80918535523492, 77.80918535523492, 77.22751687976017, 75.63608437221112, 77.38431185734858, 77.38431185734858, 76.44336965318885, 76.44336965318885, 78.91040871342531, 78.91040871342531, 78.09025091087354, 78.09025091087354, 78.77446695861852, 78.77446695861852, 77.86839041352877, 77.86839041352877, 78.74301885414813, 78.74301885414813, 79.39746231386499, 79.39746231386499, 79.19274105166828, 79.19274105166828, 79.01912797289175, 79.01912797289175, 79.1291966765753, 79.1291966765753, 77.48516527325442, 77.48516527325442, 79.54869614656666, 79.54869614656666, 79.98628817097747, 79.98628817097747, 76.62472567693703, 76.62472567693703, 78.95333180231827, 78.95333180231827, 80.16808284795428, 80.16808284795428, 78.75062831666708, 78.75062831666708, 76.13104906985538, 76.13104906985538, 79.62333556878065, 79.62333556878065, 78.65081200426576, 78.65081200426576, 79.39277751974775, 79.39277751974775, 79.34240403011016, 79.34240403011016, 79.75937693416166, 79.75937693416166, 78.48575982791408, 79.76436080827139, 78.52748577498194, 78.52748577498194, 77.18739118701978, 77.18739118701978, 79.03390697491265, 79.03390697491265, 80.32220455025507, 80.32220455025507, 78.97209110294264, 78.97209110294264, 80.71506175643216, 80.71506175643216, 77.61130307307774, 77.61130307307774, 78.43671126966258, 78.43671126966258, 76.86970354497048, 76.86970354497048, 77.11673206340924, 77.11673206340924, 79.32002185711124, 79.32002185711124, 76.71154283067929, 78.30297533822835, 79.50193179779096, 79.50193179779096, 78.5228704576033, 76.93143795005423, 78.00708996940908, 78.00708996940908, 77.43949321036024, 77.43949321036024, 79.02748146017281, 79.02748146017281, 79.72688758282983, 79.72688758282983, 78.52270882647262, 78.52270882647262, 78.96525085311472, 78.96525085311472, 79.01001810022613, 79.01001810022613, 77.74381049753595, 77.74381049753595, 77.07732301785161, 77.07732301785161, 78.01095729561649, 78.01095729561649, 78.13993957048329, 76.54850706293423, 76.42739358983685, 76.42739358983685, 79.44540280486596, 79.44540280486596, 80.65491959660065, 80.65491959660065]}, "sampler_perf": {"mean_env_wait_ms": 11.059739737850489, "mean_raw_obs_processing_ms": 0.4650761151699473, "mean_inference_ms": 5.3384067280220595, "mean_action_processing_ms": 0.13577436180300445}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 120000, "timers": {"sample_time_ms": 3555.923, "sample_throughput": 1124.884, "load_time_ms": 3.469, "load_throughput": 1153112.89, "learn_time_ms": 6640.39, "learn_throughput": 602.374, "update_time_ms": 10.284}, "info": {"learner": {"ue": {"cur_kl_coeff": 0.03750000149011612, "cur_lr": 4.999999873689376e-05, "total_loss": 197.30279541015625, "policy_loss": -0.003547697328031063, "vf_loss": 197.3060760498047, "vf_explained_var": 0.031078433617949486, "kl": 0.007539450656622648, "entropy": 0.5754488706588745, "entropy_coeff": 0.0, "model": {}}}, "num_steps_sampled": 120000, "num_steps_trained": 120000}, "done": false, "episodes_total": 1200, "training_iteration": 30, "experiment_id": "f0134eced79d425ca17ebe3d2d0a9c1b", "date": "2021-03-09_10-49-13", "timestamp": 1615283353, "time_this_iter_s": 10.365756034851074, "time_total_s": 325.8572473526001, "pid": 4108, "hostname": "ray02", "node_ip": "131.234.28.177", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "env_config": {"episode_length": 100, "seed": null, "map": "150x100map", "bs_list": ["A", "B"], "ue_list": ["1", "2"], "rand_episodes": false, "new_ue_interval": null, "reward": "sum", "log_metrics": true}, "env": "MultiAgentMobileEnv", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": true, "log_level": "WARN", "callbacks": "<class 'deepcomp.util.callbacks.CustomMetricCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"ue": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Dict(connected:MultiBinary(2), dr:Box(0.0, 1.0, (2,), float32), ues_at_bs:Box(0.0, 1.0, (2,), float32), utility:Box(-1.0, 1.0, (1,), float32))", "Discrete(3)", {}]}, "policy_mapping_fn": "<function create_env_config.<locals>.<lambda> at 0x7f6b553b7550>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 325.8572473526001, "timesteps_since_restore": 0, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 27.642857142857142, "ram_util_percent": 4.799999999999999}, "trial_id": "e359b_00000"}
{"episode_reward_max": 162.06494096933102, "episode_reward_min": 152.85478717967374, "episode_reward_mean": 157.37829732035934, "episode_len_mean": 100.0, "episodes_this_iter": 40, "policy_reward_min": {"ue": 76.42739358983685}, "policy_reward_max": {"ue": 81.03247048466527}, "policy_reward_mean": {"ue": 78.68914866017951}, "custom_metrics": {"sum_utility_mean": 16.047994043601694, "sum_utility_min": 8.79708413849351, "sum_utility_max": 21.310345226162607, "eps_sum_utility_mean": 1610.0649627740113, "eps_sum_utility_min": 1551.241442296072, "eps_sum_utility_max": 1655.7190823843403}, "hist_stats": {"episode_reward": [159.10679831886773, 160.18782429105573, 158.43228032399117, 158.97406023581215, 158.90787430284598, 156.5788363285905, 157.80024856931635, 160.50707374187834, 153.43583066366824, 158.93555732102737, 160.46706708241953, 156.85083259242015, 155.50358038377715, 158.3383770385605, 156.52433989929682, 156.7294219417846, 158.57773366276678, 159.97721570667596, 158.93769751500184, 156.03040118423758, 157.95982805365549, 158.5468472807819, 156.32988196143032, 156.79914852210675, 160.32854740631768, 160.44949869875342, 156.85902547382415, 158.79910073939834, 155.7038623272078, 153.63306169719323, 159.72804846625445, 158.8861463926258, 160.5589639045981, 154.9844672551685, 156.60590549163715, 156.26516846688054, 158.26042722780733, 155.2081652457648, 158.7556741270883, 158.3485735573944, 153.73940708994098, 154.23346412681877, 158.64004371422283, 155.01451816890795, 159.00386359558223, 155.45430840765783, 156.01417993881853, 154.8789864207206, 158.05496292034604, 159.4537751656601, 157.04541765294567, 157.93050170622985, 158.02003620045264, 155.48762099507223, 154.15464603570348, 156.02191459123304, 154.6884466334177, 152.85478717967374, 158.89080560973218, 161.3098391932017, 157.71535026756698, 153.830653289836, 155.5640230130124, 160.4366457102788, 156.1174416999475, 158.36035859122296, 158.73658688418033, 156.75108103921696, 156.51075775561924, 156.80767831041425, 154.2826275012509, 158.69579971494744, 158.0109662988367, 158.19576489190075, 158.17758187031478, 155.55031340025107, 158.46913849407554, 157.92574880450792, 158.8597189375679, 158.11140880667614, 159.20757484760895, 155.82329680343855, 158.13166349569468, 157.57115445090972, 155.13354116034867, 158.78758920039786, 156.30820520985327, 158.1965099381814, 160.2554713586813, 152.92123910353934, 156.36987496877623, 156.88138206750153, 159.35455656826156, 159.80282543667602, 154.97550976134352, 156.9823486168508, 153.11675253414052, 158.21482336812824, 155.91590814842573, 162.06494096933102], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_ue_reward": [79.55339915943372, 79.55339915943372, 80.09391214552768, 80.09391214552768, 79.21614016199537, 79.21614016199537, 79.4870301179059, 79.4870301179059, 79.45393715142288, 79.45393715142288, 78.28941816429516, 78.28941816429516, 78.90012428465806, 78.90012428465806, 80.25353687093899, 80.25353687093899, 76.71791533183395, 76.71791533183395, 79.46777866051347, 79.46777866051347, 80.23353354120964, 80.23353354120964, 78.42541629620987, 78.42541629620987, 77.75179019188836, 77.75179019188836, 79.1691885192801, 79.1691885192801, 77.4664536958737, 79.05788620342275, 78.36471097089215, 78.36471097089215, 79.28886683138325, 79.28886683138325, 79.98860785333778, 79.98860785333778, 79.46884875750081, 79.46884875750081, 78.8109168458932, 77.21948433834415, 78.97991402682761, 78.97991402682761, 79.27342364039079, 79.27342364039079, 78.16494098071499, 78.16494098071499, 78.39957426105322, 78.39957426105322, 80.16427370315864, 80.16427370315864, 80.22474934937655, 80.22474934937655, 78.42951273691199, 78.42951273691199, 79.39955036969899, 79.39955036969899, 77.85193116360378, 77.85193116360378, 76.81653084859657, 76.81653084859657, 79.86402423312707, 79.86402423312707, 79.44307319631278, 79.44307319631278, 80.2794819522989, 80.2794819522989, 78.28794988135864, 76.69651737380957, 78.30295274581842, 78.30295274581842, 78.1325842334402, 78.1325842334402, 79.13021361390352, 79.13021361390352, 78.24338311306091, 76.96478213270359, 79.37783706354398, 79.37783706354398, 79.17428677869707, 79.17428677869707, 76.86970354497048, 76.86970354497048, 77.11673206340924, 77.11673206340924, 79.32002185711124, 79.32002185711124, 76.71154283067929, 78.30297533822835, 79.50193179779096, 79.50193179779096, 78.5228704576033, 76.93143795005423, 78.00708996940908, 78.00708996940908, 77.43949321036024, 77.43949321036024, 79.02748146017281, 79.02748146017281, 79.72688758282983, 79.72688758282983, 78.52270882647262, 78.52270882647262, 78.96525085311472, 78.96525085311472, 79.01001810022613, 79.01001810022613, 77.74381049753595, 77.74381049753595, 77.07732301785161, 77.07732301785161, 78.01095729561649, 78.01095729561649, 78.13993957048329, 76.54850706293423, 76.42739358983685, 76.42739358983685, 79.44540280486596, 79.44540280486596, 80.65491959660065, 80.65491959660065, 78.85767513378337, 78.85767513378337, 76.91532664491787, 76.91532664491787, 77.78201150650608, 77.78201150650608, 80.2183228551392, 80.2183228551392, 78.0587208499736, 78.0587208499736, 79.18017929561124, 79.18017929561124, 79.36829344208999, 79.36829344208999, 78.37554051960835, 78.37554051960835, 78.25537887780948, 78.25537887780948, 78.40383915520707, 78.40383915520707, 77.14131375062532, 77.14131375062532, 79.34789985747359, 79.34789985747359, 79.00548314941818, 79.00548314941818, 79.0978824459503, 79.0978824459503, 79.08879093515722, 79.08879093515722, 77.77515670012532, 77.77515670012532, 79.23456924703763, 79.23456924703763, 78.96287440225376, 78.96287440225376, 79.42985946878387, 79.42985946878387, 79.05570440333791, 79.05570440333791, 79.60378742380432, 79.60378742380432, 77.91164840171922, 77.91164840171922, 79.06583174784711, 79.06583174784711, 78.78557722545467, 78.78557722545467, 77.5667705801742, 77.5667705801742, 79.39379460019872, 79.39379460019872, 78.15410260492645, 78.15410260492645, 79.09825496909053, 79.09825496909053, 80.12773567934059, 80.12773567934059, 76.46061955176953, 76.46061955176953, 78.18493748438799, 78.18493748438799, 78.44069103375064, 78.44069103375064, 79.67727828413065, 79.67727828413065, 79.90141271833782, 79.90141271833782, 78.28347113444617, 76.6920386268971, 78.49117430842522, 78.49117430842522, 76.55837626707012, 76.55837626707012, 79.10741168406389, 79.10741168406389, 77.95795407421272, 77.95795407421272, 81.03247048466527, 81.03247048466527]}, "sampler_perf": {"mean_env_wait_ms": 11.048349203859548, "mean_raw_obs_processing_ms": 0.4667942774087194, "mean_inference_ms": 5.333615943125718, "mean_action_processing_ms": 0.13534961780336313}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 124000, "timers": {"sample_time_ms": 3574.006, "sample_throughput": 1119.192, "load_time_ms": 3.501, "load_throughput": 1142504.12, "learn_time_ms": 6803.609, "learn_throughput": 587.923, "update_time_ms": 12.337}, "info": {"learner": {"ue": {"cur_kl_coeff": 0.03750000149011612, "cur_lr": 4.999999873689376e-05, "total_loss": 198.9951629638672, "policy_loss": -0.0029730277601629496, "vf_loss": 198.9979248046875, "vf_explained_var": 0.03147697448730469, "kl": 0.006739658769220114, "entropy": 0.5393710732460022, "entropy_coeff": 0.0, "model": {}}}, "num_steps_sampled": 124000, "num_steps_trained": 124000}, "done": false, "episodes_total": 1240, "training_iteration": 31, "experiment_id": "f0134eced79d425ca17ebe3d2d0a9c1b", "date": "2021-03-09_10-49-25", "timestamp": 1615283365, "time_this_iter_s": 12.318618059158325, "time_total_s": 338.1758654117584, "pid": 4108, "hostname": "ray02", "node_ip": "131.234.28.177", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "env_config": {"episode_length": 100, "seed": null, "map": "150x100map", "bs_list": ["A", "B"], "ue_list": ["1", "2"], "rand_episodes": false, "new_ue_interval": null, "reward": "sum", "log_metrics": true}, "env": "MultiAgentMobileEnv", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": true, "log_level": "WARN", "callbacks": "<class 'deepcomp.util.callbacks.CustomMetricCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"ue": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Dict(connected:MultiBinary(2), dr:Box(0.0, 1.0, (2,), float32), ues_at_bs:Box(0.0, 1.0, (2,), float32), utility:Box(-1.0, 1.0, (1,), float32))", "Discrete(3)", {}]}, "policy_mapping_fn": "<function create_env_config.<locals>.<lambda> at 0x7f6b553b70d0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 338.1758654117584, "timesteps_since_restore": 0, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 24.7764705882353, "ram_util_percent": 4.8}, "trial_id": "e359b_00000"}
{"episode_reward_max": 162.06494096933102, "episode_reward_min": 152.92123910353934, "episode_reward_mean": 157.3902789937839, "episode_len_mean": 100.0, "episodes_this_iter": 40, "policy_reward_min": {"ue": 75.80772792966089}, "policy_reward_max": {"ue": 81.03247048466527}, "policy_reward_mean": {"ue": 78.6951394968918}, "custom_metrics": {"sum_utility_mean": 16.33609264679076, "sum_utility_min": 10.206592306948258, "sum_utility_max": 21.310345226162607, "eps_sum_utility_mean": 1607.4699573761377, "eps_sum_utility_min": 1551.241442296072, "eps_sum_utility_max": 1654.4114817776617}, "hist_stats": {"episode_reward": [159.36688664443705, 156.82703437004398, 158.39957187158006, 158.73882563162954, 155.22126076470016, 158.41543933246083, 156.18481370717478, 159.04804460991738, 159.0034741793806, 155.13876711938246, 156.93487337991837, 158.81777491389067, 159.94065044235526, 158.20183939071126, 160.486885326071, 155.50631677874162, 155.97786963690294, 154.6373353918504, 156.39162775082417, 158.47062400402325, 155.11540055755603, 156.8447062472061, 158.43424928071272, 159.21838635078785, 157.341181353296, 155.52739254451149, 156.237470620377, 153.32155289685494, 158.6654583753094, 153.63383946518718, 157.87098901264062, 153.20688836687106, 154.33734369811503, 155.39344898794474, 157.3691844540209, 154.70367270968364, 158.03716683509623, 157.65600070405185, 159.08882895332812, 155.4862613108716, 159.20757484760895, 155.82329680343855, 158.13166349569468, 157.57115445090972, 155.13354116034867, 158.78758920039786, 156.30820520985327, 158.1965099381814, 160.2554713586813, 152.92123910353934, 156.36987496877623, 156.88138206750153, 159.35455656826156, 159.80282543667602, 154.97550976134352, 156.9823486168508, 153.11675253414052, 158.21482336812824, 155.91590814842573, 162.06494096933102, 159.10679831886773, 160.18782429105573, 158.43228032399117, 158.97406023581215, 158.90787430284598, 156.5788363285905, 157.80024856931635, 160.50707374187834, 153.43583066366824, 158.93555732102737, 160.46706708241953, 156.85083259242015, 155.50358038377715, 158.3383770385605, 156.52433989929682, 156.7294219417846, 158.57773366276678, 159.97721570667596, 158.93769751500184, 156.03040118423758, 157.95982805365549, 158.5468472807819, 156.32988196143032, 156.79914852210675, 160.32854740631768, 160.44949869875342, 156.85902547382415, 158.79910073939834, 155.7038623272078, 153.63306169719323, 159.72804846625445, 158.8861463926258, 160.5589639045981, 154.9844672551685, 156.60590549163715, 156.26516846688054, 158.26042722780733, 155.2081652457648, 158.7556741270883, 158.3485735573944], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_ue_reward": [79.68344332221824, 79.68344332221824, 78.4135171850218, 78.4135171850218, 79.19978593578986, 79.19978593578986, 79.36941281581458, 79.36941281581458, 78.40634663612444, 76.81491412857538, 79.20771966623025, 79.20771966623025, 78.09240685358724, 78.09240685358724, 79.52402230495856, 79.52402230495856, 79.50173708969017, 79.50173708969017, 77.56938355969106, 77.56938355969106, 78.46743668995911, 78.46743668995911, 79.40888745694515, 79.40888745694515, 79.97032522117745, 79.97032522117745, 79.10091969535544, 79.10091969535544, 80.24344266303534, 80.24344266303534, 77.75315838937068, 77.75315838937068, 77.98893481845137, 77.98893481845137, 77.31866769592506, 77.31866769592506, 78.19581387541193, 78.19581387541193, 79.2353120020114, 79.2353120020114, 77.55770027877789, 77.55770027877789, 78.42235312360287, 78.42235312360287, 79.21712464035616, 79.21712464035616, 79.60919317539376, 79.60919317539376, 78.67059067664788, 78.67059067664788, 77.76369627225561, 77.76369627225561, 78.11873531018834, 78.11873531018834, 76.66077644842731, 76.66077644842731, 79.33272918765451, 79.33272918765451, 76.81691973259343, 76.81691973259343, 78.9354945063202, 78.9354945063202, 77.39916043720994, 75.80772792966089, 77.16867184905733, 77.16867184905733, 77.69672449397227, 77.69672449397227, 78.6845922270103, 78.6845922270103, 77.3518363548417, 77.3518363548417, 79.01858341754794, 79.01858341754794, 78.8280003520257, 78.8280003520257, 79.54441447666386, 79.54441447666386, 77.74313065543569, 77.74313065543569, 79.60378742380432, 79.60378742380432, 77.91164840171922, 77.91164840171922, 79.06583174784711, 79.06583174784711, 78.78557722545467, 78.78557722545467, 77.5667705801742, 77.5667705801742, 79.39379460019872, 79.39379460019872, 78.15410260492645, 78.15410260492645, 79.09825496909053, 79.09825496909053, 80.12773567934059, 80.12773567934059, 76.46061955176953, 76.46061955176953, 78.18493748438799, 78.18493748438799, 78.44069103375064, 78.44069103375064, 79.67727828413065, 79.67727828413065, 79.90141271833782, 79.90141271833782, 78.28347113444617, 76.6920386268971, 78.49117430842522, 78.49117430842522, 76.55837626707012, 76.55837626707012, 79.10741168406389, 79.10741168406389, 77.95795407421272, 77.95795407421272, 81.03247048466527, 81.03247048466527, 79.55339915943372, 79.55339915943372, 80.09391214552768, 80.09391214552768, 79.21614016199537, 79.21614016199537, 79.4870301179059, 79.4870301179059, 79.45393715142288, 79.45393715142288, 78.28941816429516, 78.28941816429516, 78.90012428465806, 78.90012428465806, 80.25353687093899, 80.25353687093899, 76.71791533183395, 76.71791533183395, 79.46777866051347, 79.46777866051347, 80.23353354120964, 80.23353354120964, 78.42541629620987, 78.42541629620987, 77.75179019188836, 77.75179019188836, 79.1691885192801, 79.1691885192801, 77.4664536958737, 79.05788620342275, 78.36471097089215, 78.36471097089215, 79.28886683138325, 79.28886683138325, 79.98860785333778, 79.98860785333778, 79.46884875750081, 79.46884875750081, 78.8109168458932, 77.21948433834415, 78.97991402682761, 78.97991402682761, 79.27342364039079, 79.27342364039079, 78.16494098071499, 78.16494098071499, 78.39957426105322, 78.39957426105322, 80.16427370315864, 80.16427370315864, 80.22474934937655, 80.22474934937655, 78.42951273691199, 78.42951273691199, 79.39955036969899, 79.39955036969899, 77.85193116360378, 77.85193116360378, 76.81653084859657, 76.81653084859657, 79.86402423312707, 79.86402423312707, 79.44307319631278, 79.44307319631278, 80.2794819522989, 80.2794819522989, 78.28794988135864, 76.69651737380957, 78.30295274581842, 78.30295274581842, 78.1325842334402, 78.1325842334402, 79.13021361390352, 79.13021361390352, 78.24338311306091, 76.96478213270359, 79.37783706354398, 79.37783706354398, 79.17428677869707, 79.17428677869707]}, "sampler_perf": {"mean_env_wait_ms": 11.084136083292483, "mean_raw_obs_processing_ms": 0.46954231184666395, "mean_inference_ms": 5.354015087507737, "mean_action_processing_ms": 0.1357546993540969}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 128000, "timers": {"sample_time_ms": 3686.788, "sample_throughput": 1084.955, "load_time_ms": 3.391, "load_throughput": 1179425.936, "learn_time_ms": 6958.859, "learn_throughput": 574.807, "update_time_ms": 21.314}, "info": {"learner": {"ue": {"cur_kl_coeff": 0.03750000149011612, "cur_lr": 4.999999873689376e-05, "total_loss": 195.7666015625, "policy_loss": -0.0032786857336759567, "vf_loss": 195.76962280273438, "vf_explained_var": 0.034098438918590546, "kl": 0.006708163768053055, "entropy": 0.587935209274292, "entropy_coeff": 0.0, "model": {}}}, "num_steps_sampled": 128000, "num_steps_trained": 128000}, "done": false, "episodes_total": 1280, "training_iteration": 32, "experiment_id": "f0134eced79d425ca17ebe3d2d0a9c1b", "date": "2021-03-09_10-49-38", "timestamp": 1615283378, "time_this_iter_s": 13.083897590637207, "time_total_s": 351.25976300239563, "pid": 4108, "hostname": "ray02", "node_ip": "131.234.28.177", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "env_config": {"episode_length": 100, "seed": null, "map": "150x100map", "bs_list": ["A", "B"], "ue_list": ["1", "2"], "rand_episodes": false, "new_ue_interval": null, "reward": "sum", "log_metrics": true}, "env": "MultiAgentMobileEnv", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": true, "log_level": "WARN", "callbacks": "<class 'deepcomp.util.callbacks.CustomMetricCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"ue": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Dict(connected:MultiBinary(2), dr:Box(0.0, 1.0, (2,), float32), ues_at_bs:Box(0.0, 1.0, (2,), float32), utility:Box(-1.0, 1.0, (1,), float32))", "Discrete(3)", {}]}, "policy_mapping_fn": "<function create_env_config.<locals>.<lambda> at 0x7f6b553b7a60>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 351.25976300239563, "timesteps_since_restore": 0, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 24.723529411764705, "ram_util_percent": 4.8}, "trial_id": "e359b_00000"}
{"episode_reward_max": 160.7568502548208, "episode_reward_min": 151.11720208150774, "episode_reward_mean": 157.18327809704, "episode_len_mean": 100.0, "episodes_this_iter": 40, "policy_reward_min": {"ue": 75.55860104075379}, "policy_reward_max": {"ue": 80.37842512741024}, "policy_reward_mean": {"ue": 78.59163904851984}, "custom_metrics": {"sum_utility_mean": 16.353064746177676, "sum_utility_min": 12.302978930327074, "sum_utility_max": 21.310345226162607, "eps_sum_utility_mean": 1609.0473478759968, "eps_sum_utility_min": 1556.011701475514, "eps_sum_utility_max": 1654.4114817776617}, "hist_stats": {"episode_reward": [151.11720208150774, 159.4180061062632, 158.04794083174465, 158.00747002926897, 153.8576828661869, 157.79203973037954, 157.7071889786659, 153.54924745811974, 158.42986205257483, 158.96167139035447, 152.67228756220123, 159.79430038618625, 157.4717691988718, 158.86625844622233, 160.51616525267139, 157.7180178497439, 158.23906323437996, 160.56484596311486, 157.58758167528094, 157.04311574435297, 152.32094942812984, 157.34951416569584, 156.7788384377884, 158.99614957833853, 157.86531373891256, 156.5540597067058, 155.8723067499668, 160.7568502548208, 156.2034702275223, 155.55436865052354, 159.5139201513137, 157.0879737749662, 156.85038406051098, 159.17477164155162, 155.41763434415373, 157.95148632696072, 155.9815107497293, 153.00713459442773, 157.2305207174457, 158.28925530013657, 157.95982805365549, 158.5468472807819, 156.32988196143032, 156.79914852210675, 160.32854740631768, 160.44949869875342, 156.85902547382415, 158.79910073939834, 155.7038623272078, 153.63306169719323, 159.72804846625445, 158.8861463926258, 160.5589639045981, 154.9844672551685, 156.60590549163715, 156.26516846688054, 158.26042722780733, 155.2081652457648, 158.7556741270883, 158.3485735573944, 159.36688664443705, 156.82703437004398, 158.39957187158006, 158.73882563162954, 155.22126076470016, 158.41543933246083, 156.18481370717478, 159.04804460991738, 159.0034741793806, 155.13876711938246, 156.93487337991837, 158.81777491389067, 159.94065044235526, 158.20183939071126, 160.486885326071, 155.50631677874162, 155.97786963690294, 154.6373353918504, 156.39162775082417, 158.47062400402325, 155.11540055755603, 156.8447062472061, 158.43424928071272, 159.21838635078785, 157.341181353296, 155.52739254451149, 156.237470620377, 153.32155289685494, 158.6654583753094, 153.63383946518718, 157.87098901264062, 153.20688836687106, 154.33734369811503, 155.39344898794474, 157.3691844540209, 154.70367270968364, 158.03716683509623, 157.65600070405185, 159.08882895332812, 155.4862613108716], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_ue_reward": [75.55860104075379, 75.55860104075379, 79.70900305313137, 79.70900305313137, 79.02397041587218, 79.02397041587218, 79.00373501463436, 79.00373501463436, 77.72455768686784, 76.13312517931878, 78.8960198651896, 78.8960198651896, 78.85359448933272, 78.85359448933272, 77.57033998283433, 75.97890747528527, 79.21493102628736, 79.21493102628736, 79.480835695177, 79.480835695177, 76.3361437811005, 76.3361437811005, 79.8971501930929, 79.8971501930929, 78.73588459943576, 78.73588459943576, 79.43312922311105, 79.43312922311105, 80.25808262633551, 80.25808262633551, 78.85900892487177, 78.85900892487177, 79.1195316171898, 79.1195316171898, 80.28242298155718, 80.28242298155718, 78.79379083764027, 78.79379083764027, 78.52155787217633, 78.52155787217633, 76.16047471406475, 76.16047471406475, 78.67475708284778, 78.67475708284778, 78.38941921889413, 78.38941921889413, 79.4980747891691, 79.4980747891691, 78.9326568694561, 78.9326568694561, 78.27702985335274, 78.27702985335274, 77.9361533749832, 77.9361533749832, 80.37842512741024, 80.37842512741024, 78.10173511376107, 78.10173511376107, 77.7771843252617, 77.7771843252617, 79.75696007565668, 79.75696007565668, 78.543986887483, 78.543986887483, 78.4251920302553, 78.4251920302553, 79.58738582077568, 79.58738582077568, 78.50453342585122, 76.91310091830218, 78.97574316348026, 78.97574316348026, 77.99075537486449, 77.99075537486449, 77.29928355098828, 75.70785104343922, 78.61526035872265, 78.61526035872265, 79.14462765006812, 79.14462765006812, 78.97991402682761, 78.97991402682761, 79.27342364039079, 79.27342364039079, 78.16494098071499, 78.16494098071499, 78.39957426105322, 78.39957426105322, 80.16427370315864, 80.16427370315864, 80.22474934937655, 80.22474934937655, 78.42951273691199, 78.42951273691199, 79.39955036969899, 79.39955036969899, 77.85193116360378, 77.85193116360378, 76.81653084859657, 76.81653084859657, 79.86402423312707, 79.86402423312707, 79.44307319631278, 79.44307319631278, 80.2794819522989, 80.2794819522989, 78.28794988135864, 76.69651737380957, 78.30295274581842, 78.30295274581842, 78.1325842334402, 78.1325842334402, 79.13021361390352, 79.13021361390352, 78.24338311306091, 76.96478213270359, 79.37783706354398, 79.37783706354398, 79.17428677869707, 79.17428677869707, 79.68344332221824, 79.68344332221824, 78.4135171850218, 78.4135171850218, 79.19978593578986, 79.19978593578986, 79.36941281581458, 79.36941281581458, 78.40634663612444, 76.81491412857538, 79.20771966623025, 79.20771966623025, 78.09240685358724, 78.09240685358724, 79.52402230495856, 79.52402230495856, 79.50173708969017, 79.50173708969017, 77.56938355969106, 77.56938355969106, 78.46743668995911, 78.46743668995911, 79.40888745694515, 79.40888745694515, 79.97032522117745, 79.97032522117745, 79.10091969535544, 79.10091969535544, 80.24344266303534, 80.24344266303534, 77.75315838937068, 77.75315838937068, 77.98893481845137, 77.98893481845137, 77.31866769592506, 77.31866769592506, 78.19581387541193, 78.19581387541193, 79.2353120020114, 79.2353120020114, 77.55770027877789, 77.55770027877789, 78.42235312360287, 78.42235312360287, 79.21712464035616, 79.21712464035616, 79.60919317539376, 79.60919317539376, 78.67059067664788, 78.67059067664788, 77.76369627225561, 77.76369627225561, 78.11873531018834, 78.11873531018834, 76.66077644842731, 76.66077644842731, 79.33272918765451, 79.33272918765451, 76.81691973259343, 76.81691973259343, 78.9354945063202, 78.9354945063202, 77.39916043720994, 75.80772792966089, 77.16867184905733, 77.16867184905733, 77.69672449397227, 77.69672449397227, 78.6845922270103, 78.6845922270103, 77.3518363548417, 77.3518363548417, 79.01858341754794, 79.01858341754794, 78.8280003520257, 78.8280003520257, 79.54441447666386, 79.54441447666386, 77.74313065543569, 77.74313065543569]}, "sampler_perf": {"mean_env_wait_ms": 11.14716083320197, "mean_raw_obs_processing_ms": 0.471649576208032, "mean_inference_ms": 5.395161600029097, "mean_action_processing_ms": 0.13667802535325357}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 132000, "timers": {"sample_time_ms": 3720.487, "sample_throughput": 1075.128, "load_time_ms": 3.313, "load_throughput": 1207263.203, "learn_time_ms": 7066.346, "learn_throughput": 566.063, "update_time_ms": 21.82}, "info": {"learner": {"ue": {"cur_kl_coeff": 0.03750000149011612, "cur_lr": 4.999999873689376e-05, "total_loss": 198.34048461914062, "policy_loss": -0.004919037688523531, "vf_loss": 198.34507751464844, "vf_explained_var": 0.0315866582095623, "kl": 0.009396474808454514, "entropy": 0.5925626158714294, "entropy_coeff": 0.0, "model": {}}}, "num_steps_sampled": 132000, "num_steps_trained": 132000}, "done": false, "episodes_total": 1320, "training_iteration": 33, "experiment_id": "f0134eced79d425ca17ebe3d2d0a9c1b", "date": "2021-03-09_10-49-51", "timestamp": 1615283391, "time_this_iter_s": 12.515222787857056, "time_total_s": 363.7749857902527, "pid": 4108, "hostname": "ray02", "node_ip": "131.234.28.177", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "env_config": {"episode_length": 100, "seed": null, "map": "150x100map", "bs_list": ["A", "B"], "ue_list": ["1", "2"], "rand_episodes": false, "new_ue_interval": null, "reward": "sum", "log_metrics": true}, "env": "MultiAgentMobileEnv", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": true, "log_level": "WARN", "callbacks": "<class 'deepcomp.util.callbacks.CustomMetricCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"ue": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Dict(connected:MultiBinary(2), dr:Box(0.0, 1.0, (2,), float32), ues_at_bs:Box(0.0, 1.0, (2,), float32), utility:Box(-1.0, 1.0, (1,), float32))", "Discrete(3)", {}]}, "policy_mapping_fn": "<function create_env_config.<locals>.<lambda> at 0x7f6b55430d30>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 363.7749857902527, "timesteps_since_restore": 0, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 24.594117647058823, "ram_util_percent": 4.8}, "trial_id": "e359b_00000"}
{"episode_reward_max": 160.7568502548208, "episode_reward_min": 150.0989945087042, "episode_reward_mean": 156.855703039778, "episode_len_mean": 100.0, "episodes_this_iter": 40, "policy_reward_min": {"ue": 75.04949725435195}, "policy_reward_max": {"ue": 80.37842512741024}, "policy_reward_mean": {"ue": 78.42785151988888}, "custom_metrics": {"sum_utility_mean": 16.15089598826617, "sum_utility_min": 8.79708413849351, "sum_utility_max": 21.310345226162607, "eps_sum_utility_mean": 1614.4509848535768, "eps_sum_utility_min": 1564.6837822073105, "eps_sum_utility_max": 1660.555980914369}, "hist_stats": {"episode_reward": [153.90301869192984, 156.6135925940161, 156.43635537307688, 157.68607288054335, 158.11489103070647, 155.62830484701226, 158.27899182033093, 158.9161371262482, 153.27494610717497, 150.0989945087042, 157.8101726623533, 157.19124505873015, 156.4701378216073, 159.90165540065806, 156.84270260977627, 158.55788180743792, 156.80749498661925, 155.5988926602352, 157.42894406890883, 159.6726589218992, 154.71117761747792, 158.6187513594054, 158.0397753015655, 157.96539452820014, 153.87880759235878, 160.25836946826416, 155.88582977166118, 156.05615722710792, 160.5633075377326, 154.95903159452422, 155.32477675060886, 158.338655898787, 158.53627026004125, 155.755042381563, 154.28027804262268, 156.66153108400107, 156.34476686556633, 154.03064559015343, 158.77061497468463, 157.75047699139407, 155.11540055755603, 156.8447062472061, 158.43424928071272, 159.21838635078785, 157.341181353296, 155.52739254451149, 156.237470620377, 153.32155289685494, 158.6654583753094, 153.63383946518718, 157.87098901264062, 153.20688836687106, 154.33734369811503, 155.39344898794474, 157.3691844540209, 154.70367270968364, 158.03716683509623, 157.65600070405185, 159.08882895332812, 155.4862613108716, 151.11720208150774, 159.4180061062632, 158.04794083174465, 158.00747002926897, 153.8576828661869, 157.79203973037954, 157.7071889786659, 153.54924745811974, 158.42986205257483, 158.96167139035447, 152.67228756220123, 159.79430038618625, 157.4717691988718, 158.86625844622233, 160.51616525267139, 157.7180178497439, 158.23906323437996, 160.56484596311486, 157.58758167528094, 157.04311574435297, 152.32094942812984, 157.34951416569584, 156.7788384377884, 158.99614957833853, 157.86531373891256, 156.5540597067058, 155.8723067499668, 160.7568502548208, 156.2034702275223, 155.55436865052354, 159.5139201513137, 157.0879737749662, 156.85038406051098, 159.17477164155162, 155.41763434415373, 157.95148632696072, 155.9815107497293, 153.00713459442773, 157.2305207174457, 158.28925530013657], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_ue_reward": [77.74722559973931, 76.15579309219025, 78.30679629700798, 78.30679629700798, 78.21817768653827, 78.21817768653827, 78.84303644027153, 78.84303644027153, 79.05744551535315, 79.05744551535315, 77.814152423506, 77.814152423506, 79.1394959101653, 79.1394959101653, 79.458068563124, 79.458068563124, 76.63747305358739, 76.63747305358739, 75.04949725435195, 75.04949725435196, 78.90508633117655, 78.90508633117655, 78.59562252936499, 78.59562252936499, 78.23506891080362, 78.23506891080362, 79.95082770032886, 79.95082770032886, 78.42135130488796, 78.42135130488796, 79.27894090371885, 79.27894090371885, 78.40374749330947, 78.40374749330947, 77.79944633011743, 77.79944633011743, 78.71447203445426, 78.71447203445426, 79.83632946094947, 79.83632946094947, 77.35558880873883, 77.35558880873883, 79.30937567970254, 79.30937567970254, 79.0198876507826, 79.0198876507826, 78.98269726409995, 78.98269726409995, 76.14368754240473, 77.73512004995379, 80.12918473413188, 80.12918473413188, 77.94291488583042, 77.94291488583042, 77.38877812337508, 78.66737910373242, 80.28165376886615, 80.28165376886615, 77.47951579726195, 77.47951579726195, 78.42876769063142, 76.89600905997736, 79.16932794939349, 79.16932794939349, 79.26813513002047, 79.26813513002047, 77.08180493700688, 78.67323744455592, 77.14013902131117, 77.14013902131117, 78.33076554200046, 78.33076554200046, 78.17238343278304, 78.17238343278304, 77.01532279507661, 77.01532279507661, 79.38530748734222, 79.38530748734222, 78.87523849569692, 78.87523849569692, 77.55770027877789, 77.55770027877789, 78.42235312360287, 78.42235312360287, 79.21712464035616, 79.21712464035616, 79.60919317539376, 79.60919317539376, 78.67059067664788, 78.67059067664788, 77.76369627225561, 77.76369627225561, 78.11873531018834, 78.11873531018834, 76.66077644842731, 76.66077644842731, 79.33272918765451, 79.33272918765451, 76.81691973259343, 76.81691973259343, 78.9354945063202, 78.9354945063202, 77.39916043720994, 75.80772792966089, 77.16867184905733, 77.16867184905733, 77.69672449397227, 77.69672449397227, 78.6845922270103, 78.6845922270103, 77.3518363548417, 77.3518363548417, 79.01858341754794, 79.01858341754794, 78.8280003520257, 78.8280003520257, 79.54441447666386, 79.54441447666386, 77.74313065543569, 77.74313065543569, 75.55860104075379, 75.55860104075379, 79.70900305313137, 79.70900305313137, 79.02397041587218, 79.02397041587218, 79.00373501463436, 79.00373501463436, 77.72455768686784, 76.13312517931878, 78.8960198651896, 78.8960198651896, 78.85359448933272, 78.85359448933272, 77.57033998283433, 75.97890747528527, 79.21493102628736, 79.21493102628736, 79.480835695177, 79.480835695177, 76.3361437811005, 76.3361437811005, 79.8971501930929, 79.8971501930929, 78.73588459943576, 78.73588459943576, 79.43312922311105, 79.43312922311105, 80.25808262633551, 80.25808262633551, 78.85900892487177, 78.85900892487177, 79.1195316171898, 79.1195316171898, 80.28242298155718, 80.28242298155718, 78.79379083764027, 78.79379083764027, 78.52155787217633, 78.52155787217633, 76.16047471406475, 76.16047471406475, 78.67475708284778, 78.67475708284778, 78.38941921889413, 78.38941921889413, 79.4980747891691, 79.4980747891691, 78.9326568694561, 78.9326568694561, 78.27702985335274, 78.27702985335274, 77.9361533749832, 77.9361533749832, 80.37842512741024, 80.37842512741024, 78.10173511376107, 78.10173511376107, 77.7771843252617, 77.7771843252617, 79.75696007565668, 79.75696007565668, 78.543986887483, 78.543986887483, 78.4251920302553, 78.4251920302553, 79.58738582077568, 79.58738582077568, 78.50453342585122, 76.91310091830218, 78.97574316348026, 78.97574316348026, 77.99075537486449, 77.99075537486449, 77.29928355098828, 75.70785104343922, 78.61526035872265, 78.61526035872265, 79.14462765006812, 79.14462765006812]}, "sampler_perf": {"mean_env_wait_ms": 11.200043068290817, "mean_raw_obs_processing_ms": 0.4726573217451401, "mean_inference_ms": 5.451056160900422, "mean_action_processing_ms": 0.13754643774529296}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 136000, "timers": {"sample_time_ms": 3779.227, "sample_throughput": 1058.417, "load_time_ms": 3.314, "load_throughput": 1207028.691, "learn_time_ms": 7215.262, "learn_throughput": 554.38, "update_time_ms": 21.814}, "info": {"learner": {"ue": {"cur_kl_coeff": 0.03750000149011612, "cur_lr": 4.999999873689376e-05, "total_loss": 196.0950164794922, "policy_loss": -0.0006917106220498681, "vf_loss": 196.09535217285156, "vf_explained_var": 0.03310568630695343, "kl": 0.009158742614090443, "entropy": 0.5421727299690247, "entropy_coeff": 0.0, "model": {}}}, "num_steps_sampled": 136000, "num_steps_trained": 136000}, "done": false, "episodes_total": 1360, "training_iteration": 34, "experiment_id": "f0134eced79d425ca17ebe3d2d0a9c1b", "date": "2021-03-09_10-50-04", "timestamp": 1615283404, "time_this_iter_s": 12.84057068824768, "time_total_s": 376.61555647850037, "pid": 4108, "hostname": "ray02", "node_ip": "131.234.28.177", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "env_config": {"episode_length": 100, "seed": null, "map": "150x100map", "bs_list": ["A", "B"], "ue_list": ["1", "2"], "rand_episodes": false, "new_ue_interval": null, "reward": "sum", "log_metrics": true}, "env": "MultiAgentMobileEnv", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": true, "log_level": "WARN", "callbacks": "<class 'deepcomp.util.callbacks.CustomMetricCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"ue": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Dict(connected:MultiBinary(2), dr:Box(0.0, 1.0, (2,), float32), ues_at_bs:Box(0.0, 1.0, (2,), float32), utility:Box(-1.0, 1.0, (1,), float32))", "Discrete(3)", {}]}, "policy_mapping_fn": "<function create_env_config.<locals>.<lambda> at 0x7f6b553b7280>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 376.61555647850037, "timesteps_since_restore": 0, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 23.3, "ram_util_percent": 4.8}, "trial_id": "e359b_00000"}
{"episode_reward_max": 160.7568502548208, "episode_reward_min": 150.0989945087042, "episode_reward_mean": 157.15172299071872, "episode_len_mean": 100.0, "episodes_this_iter": 40, "policy_reward_min": {"ue": 75.04949725435195}, "policy_reward_max": {"ue": 80.37842512741024}, "policy_reward_mean": {"ue": 78.57586149535923}, "custom_metrics": {"sum_utility_mean": 16.337195816874154, "sum_utility_min": 8.79708413849351, "sum_utility_max": 21.310345226162607, "eps_sum_utility_mean": 1622.048425047182, "eps_sum_utility_min": 1572.9768231367375, "eps_sum_utility_max": 1660.555980914369}, "hist_stats": {"episode_reward": [155.84181399586896, 156.4042022684328, 155.12462325949514, 157.60607716877104, 157.5046708273623, 159.1694078657216, 158.1864453932787, 158.65831257516015, 156.02232639939717, 159.3099763288442, 157.73611997199987, 157.1537856165927, 159.55257460617008, 154.34614380900325, 160.20200243822688, 156.2587589731623, 154.37454388956962, 157.37113653938314, 158.25047904572813, 154.33162711802805, 154.86587413815948, 160.48849023495836, 157.2479818077873, 159.85084947976662, 157.94009149211922, 160.36300794015716, 156.35302449673543, 157.93204345397373, 156.40033847346507, 155.91878938664883, 159.3482011661875, 156.70570820348337, 160.46472845008174, 157.8912109329462, 157.42879239779614, 160.0984931231286, 156.56321720446448, 158.04839092922435, 157.87852444390683, 159.26034881139526, 152.32094942812984, 157.34951416569584, 156.7788384377884, 158.99614957833853, 157.86531373891256, 156.5540597067058, 155.8723067499668, 160.7568502548208, 156.2034702275223, 155.55436865052354, 159.5139201513137, 157.0879737749662, 156.85038406051098, 159.17477164155162, 155.41763434415373, 157.95148632696072, 155.9815107497293, 153.00713459442773, 157.2305207174457, 158.28925530013657, 153.90301869192984, 156.6135925940161, 156.43635537307688, 157.68607288054335, 158.11489103070647, 155.62830484701226, 158.27899182033093, 158.9161371262482, 153.27494610717497, 150.0989945087042, 157.8101726623533, 157.19124505873015, 156.4701378216073, 159.90165540065806, 156.84270260977627, 158.55788180743792, 156.80749498661925, 155.5988926602352, 157.42894406890883, 159.6726589218992, 154.71117761747792, 158.6187513594054, 158.0397753015655, 157.96539452820014, 153.87880759235878, 160.25836946826416, 155.88582977166118, 156.05615722710792, 160.5633075377326, 154.95903159452422, 155.32477675060886, 158.338655898787, 158.53627026004125, 155.755042381563, 154.28027804262268, 156.66153108400107, 156.34476686556633, 154.03064559015343, 158.77061497468463, 157.75047699139407], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_ue_reward": [77.28160650775571, 78.56020748811304, 78.20210113421636, 78.20210113421636, 77.56231162974734, 77.56231162974734, 78.80303858438539, 78.80303858438539, 78.75233541368108, 78.75233541368108, 79.58470393286059, 79.58470393286059, 79.0932226966392, 79.0932226966392, 79.32915628758, 79.32915628758, 78.0111631996985, 78.0111631996985, 79.65498816442197, 79.65498816442197, 78.86805998599985, 78.86805998599985, 78.57689280829635, 78.57689280829635, 79.77628730308486, 79.77628730308486, 77.17307190450151, 77.17307190450151, 80.10100121911331, 80.10100121911331, 78.12937948658112, 78.12937948658112, 77.18727194478467, 77.18727194478467, 78.68556826969142, 78.68556826969142, 79.12523952286385, 79.12523952286385, 77.16581355901391, 77.16581355901391, 77.43293706907963, 77.43293706907963, 80.24424511747905, 80.24424511747905, 78.62399090389357, 78.62399090389357, 79.92542473988324, 79.92542473988324, 78.97004574605953, 78.97004574605953, 80.18150397007842, 80.18150397007842, 77.38079599459313, 78.97222850214217, 78.96602172698678, 78.96602172698678, 78.20016923673239, 78.20016923673239, 77.9593946933244, 77.9593946933244, 79.67410058309365, 79.67410058309365, 78.35285410174157, 78.35285410174157, 80.2323642250408, 80.2323642250408, 78.94560546647311, 78.94560546647311, 78.71439619889787, 78.71439619889787, 80.04924656156413, 80.04924656156413, 78.28160860223208, 78.28160860223208, 79.02419546461209, 79.02419546461209, 78.93926222195337, 78.93926222195337, 79.63017440569746, 79.63017440569746, 76.16047471406475, 76.16047471406475, 78.67475708284778, 78.67475708284778, 78.38941921889413, 78.38941921889413, 79.4980747891691, 79.4980747891691, 78.9326568694561, 78.9326568694561, 78.27702985335274, 78.27702985335274, 77.9361533749832, 77.9361533749832, 80.37842512741024, 80.37842512741024, 78.10173511376107, 78.10173511376107, 77.7771843252617, 77.7771843252617, 79.75696007565668, 79.75696007565668, 78.543986887483, 78.543986887483, 78.4251920302553, 78.4251920302553, 79.58738582077568, 79.58738582077568, 78.50453342585122, 76.91310091830218, 78.97574316348026, 78.97574316348026, 77.99075537486449, 77.99075537486449, 77.29928355098828, 75.70785104343922, 78.61526035872265, 78.61526035872265, 79.14462765006812, 79.14462765006812, 77.74722559973931, 76.15579309219025, 78.30679629700798, 78.30679629700798, 78.21817768653827, 78.21817768653827, 78.84303644027153, 78.84303644027153, 79.05744551535315, 79.05744551535315, 77.814152423506, 77.814152423506, 79.1394959101653, 79.1394959101653, 79.458068563124, 79.458068563124, 76.63747305358739, 76.63747305358739, 75.04949725435195, 75.04949725435196, 78.90508633117655, 78.90508633117655, 78.59562252936499, 78.59562252936499, 78.23506891080362, 78.23506891080362, 79.95082770032886, 79.95082770032886, 78.42135130488796, 78.42135130488796, 79.27894090371885, 79.27894090371885, 78.40374749330947, 78.40374749330947, 77.79944633011743, 77.79944633011743, 78.71447203445426, 78.71447203445426, 79.83632946094947, 79.83632946094947, 77.35558880873883, 77.35558880873883, 79.30937567970254, 79.30937567970254, 79.0198876507826, 79.0198876507826, 78.98269726409995, 78.98269726409995, 76.14368754240473, 77.73512004995379, 80.12918473413188, 80.12918473413188, 77.94291488583042, 77.94291488583042, 77.38877812337508, 78.66737910373242, 80.28165376886615, 80.28165376886615, 77.47951579726195, 77.47951579726195, 78.42876769063142, 76.89600905997736, 79.16932794939349, 79.16932794939349, 79.26813513002047, 79.26813513002047, 77.08180493700688, 78.67323744455592, 77.14013902131117, 77.14013902131117, 78.33076554200046, 78.33076554200046, 78.17238343278304, 78.17238343278304, 77.01532279507661, 77.01532279507661, 79.38530748734222, 79.38530748734222, 78.87523849569692, 78.87523849569692]}, "sampler_perf": {"mean_env_wait_ms": 11.226685351810794, "mean_raw_obs_processing_ms": 0.4746960330408505, "mean_inference_ms": 5.5116339776354835, "mean_action_processing_ms": 0.13857630080849606}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 140000, "timers": {"sample_time_ms": 3836.171, "sample_throughput": 1042.706, "load_time_ms": 3.294, "load_throughput": 1214473.014, "learn_time_ms": 7315.782, "learn_throughput": 546.763, "update_time_ms": 21.572}, "info": {"learner": {"ue": {"cur_kl_coeff": 0.03750000149011612, "cur_lr": 4.999999873689376e-05, "total_loss": 198.81044006347656, "policy_loss": -0.002070346614345908, "vf_loss": 198.81234741210938, "vf_explained_var": 0.032324615865945816, "kl": 0.004806844983249903, "entropy": 0.5299332737922668, "entropy_coeff": 0.0, "model": {}}}, "num_steps_sampled": 140000, "num_steps_trained": 140000}, "done": false, "episodes_total": 1400, "training_iteration": 35, "experiment_id": "f0134eced79d425ca17ebe3d2d0a9c1b", "date": "2021-03-09_10-50-16", "timestamp": 1615283416, "time_this_iter_s": 12.40372896194458, "time_total_s": 389.01928544044495, "pid": 4108, "hostname": "ray02", "node_ip": "131.234.28.177", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "env_config": {"episode_length": 100, "seed": null, "map": "150x100map", "bs_list": ["A", "B"], "ue_list": ["1", "2"], "rand_episodes": false, "new_ue_interval": null, "reward": "sum", "log_metrics": true}, "env": "MultiAgentMobileEnv", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": true, "log_level": "WARN", "callbacks": "<class 'deepcomp.util.callbacks.CustomMetricCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"ue": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Dict(connected:MultiBinary(2), dr:Box(0.0, 1.0, (2,), float32), ues_at_bs:Box(0.0, 1.0, (2,), float32), utility:Box(-1.0, 1.0, (1,), float32))", "Discrete(3)", {}]}, "policy_mapping_fn": "<function create_env_config.<locals>.<lambda> at 0x7f6b553b7d30>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 389.01928544044495, "timesteps_since_restore": 0, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 24.25, "ram_util_percent": 4.8}, "trial_id": "e359b_00000"}
{"episode_reward_max": 161.42464513100236, "episode_reward_min": 152.42618937941864, "episode_reward_mean": 157.41343728468922, "episode_len_mean": 100.0, "episodes_this_iter": 40, "policy_reward_min": {"ue": 75.44671537438217}, "policy_reward_max": {"ue": 80.71232256550108}, "policy_reward_mean": {"ue": 78.70671864234447}, "custom_metrics": {"sum_utility_mean": 16.120917619332825, "sum_utility_min": 8.79708413849351, "sum_utility_max": 21.310345226162607, "eps_sum_utility_mean": 1624.5591926138568, "eps_sum_utility_min": 1567.782190160198, "eps_sum_utility_max": 1664.3655660790826}, "hist_stats": {"episode_reward": [155.8470319080755, 160.98945703668824, 158.6133233534012, 156.36628268531064, 154.8744187547896, 160.65521105672389, 158.28470714016618, 156.4113071683597, 159.60026271636332, 157.59619306166184, 154.62256910386895, 158.0846528983189, 157.00271064259744, 156.5540594204603, 154.27639737629528, 157.86021214317043, 158.98859981528955, 152.42618937941864, 159.38598673234173, 158.72512797436883, 157.52611959111033, 159.6992676577152, 156.71821136872768, 153.64494895328335, 155.44726344335226, 160.08463105646905, 156.44973731532423, 158.26006346621864, 160.31380705919457, 158.68083166624098, 156.82712167994111, 158.29056652047478, 157.91241851744343, 157.82446327749489, 158.64082783260437, 161.42464513100236, 157.3090914097957, 156.1309893118455, 154.2317412616111, 157.57948608709955, 154.71117761747792, 158.6187513594054, 158.0397753015655, 157.96539452820014, 153.87880759235878, 160.25836946826416, 155.88582977166118, 156.05615722710792, 160.5633075377326, 154.95903159452422, 155.32477675060886, 158.338655898787, 158.53627026004125, 155.755042381563, 154.28027804262268, 156.66153108400107, 156.34476686556633, 154.03064559015343, 158.77061497468463, 157.75047699139407, 155.84181399586896, 156.4042022684328, 155.12462325949514, 157.60607716877104, 157.5046708273623, 159.1694078657216, 158.1864453932787, 158.65831257516015, 156.02232639939717, 159.3099763288442, 157.73611997199987, 157.1537856165927, 159.55257460617008, 154.34614380900325, 160.20200243822688, 156.2587589731623, 154.37454388956962, 157.37113653938314, 158.25047904572813, 154.33162711802805, 154.86587413815948, 160.48849023495836, 157.2479818077873, 159.85084947976662, 157.94009149211922, 160.36300794015716, 156.35302449673543, 157.93204345397373, 156.40033847346507, 155.91878938664883, 159.3482011661875, 156.70570820348337, 160.46472845008174, 157.8912109329462, 157.42879239779614, 160.0984931231286, 156.56321720446448, 158.04839092922435, 157.87852444390683, 159.26034881139526], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_ue_reward": [77.92351595403755, 77.92351595403755, 80.49472851834396, 80.49472851834396, 79.30666167670037, 79.30666167670037, 78.18314134265522, 78.18314134265522, 77.43720937739468, 77.43720937739468, 80.32760552836181, 80.32760552836181, 79.14235357008295, 79.14235357008295, 78.20565358417977, 78.20565358417977, 79.80013135818156, 79.80013135818156, 78.79809653083078, 78.79809653083078, 77.31128455193434, 77.31128455193434, 79.04232644915936, 79.04232644915936, 78.50135532129856, 78.50135532129856, 78.27702971022998, 78.27702971022998, 77.13819868814751, 77.13819868814751, 78.93010607158513, 78.93010607158513, 79.49429990764462, 79.49429990764462, 76.97947400503625, 75.44671537438217, 79.69299336617075, 79.69299336617075, 79.36256398718422, 79.36256398718422, 78.76305979555505, 78.76305979555505, 79.84963382885753, 79.84963382885753, 78.35910568436375, 78.35910568436375, 76.82247447664149, 76.82247447664149, 77.72363172167601, 77.72363172167601, 80.04231552823434, 80.04231552823434, 78.22486865766204, 78.22486865766204, 79.13003173310922, 79.13003173310922, 80.15690352959716, 80.15690352959716, 79.3404158331203, 79.3404158331203, 78.41356083997039, 78.41356083997039, 79.14528326023725, 79.14528326023725, 78.9562092587215, 78.9562092587215, 78.91223163874734, 78.91223163874734, 79.32041391630204, 79.32041391630204, 80.71232256550108, 80.71232256550108, 78.65454570489767, 78.65454570489767, 78.06549465592259, 78.06549465592259, 77.11587063080556, 77.11587063080556, 78.78974304354969, 78.78974304354969, 77.35558880873883, 77.35558880873883, 79.30937567970254, 79.30937567970254, 79.0198876507826, 79.0198876507826, 78.98269726409995, 78.98269726409995, 76.14368754240473, 77.73512004995379, 80.12918473413188, 80.12918473413188, 77.94291488583042, 77.94291488583042, 77.38877812337508, 78.66737910373242, 80.28165376886615, 80.28165376886615, 77.47951579726195, 77.47951579726195, 78.42876769063142, 76.89600905997736, 79.16932794939349, 79.16932794939349, 79.26813513002047, 79.26813513002047, 77.08180493700688, 78.67323744455592, 77.14013902131117, 77.14013902131117, 78.33076554200046, 78.33076554200046, 78.17238343278304, 78.17238343278304, 77.01532279507661, 77.01532279507661, 79.38530748734222, 79.38530748734222, 78.87523849569692, 78.87523849569692, 77.28160650775571, 78.56020748811304, 78.20210113421636, 78.20210113421636, 77.56231162974734, 77.56231162974734, 78.80303858438539, 78.80303858438539, 78.75233541368108, 78.75233541368108, 79.58470393286059, 79.58470393286059, 79.0932226966392, 79.0932226966392, 79.32915628758, 79.32915628758, 78.0111631996985, 78.0111631996985, 79.65498816442197, 79.65498816442197, 78.86805998599985, 78.86805998599985, 78.57689280829635, 78.57689280829635, 79.77628730308486, 79.77628730308486, 77.17307190450151, 77.17307190450151, 80.10100121911331, 80.10100121911331, 78.12937948658112, 78.12937948658112, 77.18727194478467, 77.18727194478467, 78.68556826969142, 78.68556826969142, 79.12523952286385, 79.12523952286385, 77.16581355901391, 77.16581355901391, 77.43293706907963, 77.43293706907963, 80.24424511747905, 80.24424511747905, 78.62399090389357, 78.62399090389357, 79.92542473988324, 79.92542473988324, 78.97004574605953, 78.97004574605953, 80.18150397007842, 80.18150397007842, 77.38079599459313, 78.97222850214217, 78.96602172698678, 78.96602172698678, 78.20016923673239, 78.20016923673239, 77.9593946933244, 77.9593946933244, 79.67410058309365, 79.67410058309365, 78.35285410174157, 78.35285410174157, 80.2323642250408, 80.2323642250408, 78.94560546647311, 78.94560546647311, 78.71439619889787, 78.71439619889787, 80.04924656156413, 80.04924656156413, 78.28160860223208, 78.28160860223208, 79.02419546461209, 79.02419546461209, 78.93926222195337, 78.93926222195337, 79.63017440569746, 79.63017440569746]}, "sampler_perf": {"mean_env_wait_ms": 11.2407197983286, "mean_raw_obs_processing_ms": 0.4766178969559741, "mean_inference_ms": 5.568024716095303, "mean_action_processing_ms": 0.13879919132034058}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 144000, "timers": {"sample_time_ms": 3879.851, "sample_throughput": 1030.967, "load_time_ms": 3.329, "load_throughput": 1201599.725, "learn_time_ms": 7459.228, "learn_throughput": 536.249, "update_time_ms": 21.975}, "info": {"learner": {"ue": {"cur_kl_coeff": 0.01875000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 198.1243133544922, "policy_loss": -0.005439587403088808, "vf_loss": 198.12953186035156, "vf_explained_var": 0.03348230570554733, "kl": 0.010395769961178303, "entropy": 0.4998151361942291, "entropy_coeff": 0.0, "model": {}}}, "num_steps_sampled": 144000, "num_steps_trained": 144000}, "done": false, "episodes_total": 1440, "training_iteration": 36, "experiment_id": "f0134eced79d425ca17ebe3d2d0a9c1b", "date": "2021-03-09_10-50-29", "timestamp": 1615283429, "time_this_iter_s": 12.71305537223816, "time_total_s": 401.7323408126831, "pid": 4108, "hostname": "ray02", "node_ip": "131.234.28.177", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "env_config": {"episode_length": 100, "seed": null, "map": "150x100map", "bs_list": ["A", "B"], "ue_list": ["1", "2"], "rand_episodes": false, "new_ue_interval": null, "reward": "sum", "log_metrics": true}, "env": "MultiAgentMobileEnv", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": true, "log_level": "WARN", "callbacks": "<class 'deepcomp.util.callbacks.CustomMetricCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"ue": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Dict(connected:MultiBinary(2), dr:Box(0.0, 1.0, (2,), float32), ues_at_bs:Box(0.0, 1.0, (2,), float32), utility:Box(-1.0, 1.0, (1,), float32))", "Discrete(3)", {}]}, "policy_mapping_fn": "<function create_env_config.<locals>.<lambda> at 0x7f6b55430ee0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 401.7323408126831, "timesteps_since_restore": 0, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 22.461111111111112, "ram_util_percent": 4.8}, "trial_id": "e359b_00000"}
{"episode_reward_max": 161.42464513100236, "episode_reward_min": 152.42618937941864, "episode_reward_mean": 157.49846354201634, "episode_len_mean": 100.0, "episodes_this_iter": 40, "policy_reward_min": {"ue": 75.44671537438217}, "policy_reward_max": {"ue": 80.71232256550108}, "policy_reward_mean": {"ue": 78.74923177100806}, "custom_metrics": {"sum_utility_mean": 16.133463750348994, "sum_utility_min": 10.206592306948258, "sum_utility_max": 21.310345226162607, "eps_sum_utility_mean": 1616.9302875257415, "eps_sum_utility_min": 1552.6084966877663, "eps_sum_utility_max": 1664.3655660790826}, "hist_stats": {"episode_reward": [156.7802760644555, 157.20889899550218, 157.79159232768063, 158.82587495364396, 154.92505837844925, 155.06321155118223, 156.81975172710435, 158.70850464091683, 156.30155231940165, 157.15027569491252, 154.06535367796232, 159.64482423260523, 159.39048925427193, 157.659794270776, 157.27175515833585, 156.0642220055712, 156.9607861850601, 156.85008832892487, 157.90414277771424, 155.66589710604558, 159.7635041399206, 157.78896020899737, 156.89104195059332, 156.43705478131727, 159.52167232683172, 155.38305042214023, 153.85121416580313, 154.4915781012296, 157.90298485423875, 158.3903666927444, 157.5022220324742, 157.708114045453, 157.0246019395446, 159.34050001827154, 159.707568770433, 158.45568117310103, 156.20068819451774, 159.6497565030898, 156.78153167457833, 154.79287301483498, 154.86587413815948, 160.48849023495836, 157.2479818077873, 159.85084947976662, 157.94009149211922, 160.36300794015716, 156.35302449673543, 157.93204345397373, 156.40033847346507, 155.91878938664883, 159.3482011661875, 156.70570820348337, 160.46472845008174, 157.8912109329462, 157.42879239779614, 160.0984931231286, 156.56321720446448, 158.04839092922435, 157.87852444390683, 159.26034881139526, 155.8470319080755, 160.98945703668824, 158.6133233534012, 156.36628268531064, 154.8744187547896, 160.65521105672389, 158.28470714016618, 156.4113071683597, 159.60026271636332, 157.59619306166184, 154.62256910386895, 158.0846528983189, 157.00271064259744, 156.5540594204603, 154.27639737629528, 157.86021214317043, 158.98859981528955, 152.42618937941864, 159.38598673234173, 158.72512797436883, 157.52611959111033, 159.6992676577152, 156.71821136872768, 153.64494895328335, 155.44726344335226, 160.08463105646905, 156.44973731532423, 158.26006346621864, 160.31380705919457, 158.68083166624098, 156.82712167994111, 158.29056652047478, 157.91241851744343, 157.82446327749489, 158.64082783260437, 161.42464513100236, 157.3090914097957, 156.1309893118455, 154.2317412616111, 157.57948608709955], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_ue_reward": [78.39013803222758, 78.39013803222758, 78.604449497751, 78.604449497751, 78.89579616384019, 78.89579616384019, 79.41293747682184, 79.41293747682184, 77.46252918922453, 77.46252918922453, 77.53160577559103, 77.53160577559103, 78.40987586355212, 78.40987586355212, 79.35425232045831, 79.35425232045831, 78.15077615970075, 78.15077615970075, 78.57513784745616, 78.57513784745616, 77.03267683898103, 77.03267683898103, 79.82241211630249, 79.82241211630249, 79.6952446271359, 79.6952446271359, 78.82989713538788, 78.82989713538788, 78.63587757916783, 78.63587757916783, 77.39281051260689, 78.67141149296421, 78.48039309252997, 78.48039309252997, 78.42504416446226, 78.42504416446226, 78.95207138885696, 78.95207138885696, 77.8329485530226, 77.8329485530226, 79.88175206996014, 79.88175206996014, 78.89448010449853, 78.89448010449853, 78.44552097529657, 78.44552097529657, 78.21852739065858, 78.21852739065858, 79.7608361634157, 79.7608361634157, 77.69152521107, 77.69152521107, 76.2863065927228, 77.56490757308012, 78.04150530438919, 76.45007279684013, 78.95149242711926, 78.95149242711926, 79.19518334637205, 79.19518334637205, 78.751111016237, 78.751111016237, 78.85405702272635, 78.85405702272635, 77.87300047959351, 79.15160145995085, 79.67025000913551, 79.67025000913551, 79.8537843852165, 79.8537843852165, 79.22784058655049, 79.22784058655049, 78.10034409725874, 78.10034409725874, 79.82487825154475, 79.82487825154475, 78.39076583728901, 78.39076583728901, 76.60072025364283, 78.19215276119189, 77.43293706907963, 77.43293706907963, 80.24424511747905, 80.24424511747905, 78.62399090389357, 78.62399090389357, 79.92542473988324, 79.92542473988324, 78.97004574605953, 78.97004574605953, 80.18150397007842, 80.18150397007842, 77.38079599459313, 78.97222850214217, 78.96602172698678, 78.96602172698678, 78.20016923673239, 78.20016923673239, 77.9593946933244, 77.9593946933244, 79.67410058309365, 79.67410058309365, 78.35285410174157, 78.35285410174157, 80.2323642250408, 80.2323642250408, 78.94560546647311, 78.94560546647311, 78.71439619889787, 78.71439619889787, 80.04924656156413, 80.04924656156413, 78.28160860223208, 78.28160860223208, 79.02419546461209, 79.02419546461209, 78.93926222195337, 78.93926222195337, 79.63017440569746, 79.63017440569746, 77.92351595403755, 77.92351595403755, 80.49472851834396, 80.49472851834396, 79.30666167670037, 79.30666167670037, 78.18314134265522, 78.18314134265522, 77.43720937739468, 77.43720937739468, 80.32760552836181, 80.32760552836181, 79.14235357008295, 79.14235357008295, 78.20565358417977, 78.20565358417977, 79.80013135818156, 79.80013135818156, 78.79809653083078, 78.79809653083078, 77.31128455193434, 77.31128455193434, 79.04232644915936, 79.04232644915936, 78.50135532129856, 78.50135532129856, 78.27702971022998, 78.27702971022998, 77.13819868814751, 77.13819868814751, 78.93010607158513, 78.93010607158513, 79.49429990764462, 79.49429990764462, 76.97947400503625, 75.44671537438217, 79.69299336617075, 79.69299336617075, 79.36256398718422, 79.36256398718422, 78.76305979555505, 78.76305979555505, 79.84963382885753, 79.84963382885753, 78.35910568436375, 78.35910568436375, 76.82247447664149, 76.82247447664149, 77.72363172167601, 77.72363172167601, 80.04231552823434, 80.04231552823434, 78.22486865766204, 78.22486865766204, 79.13003173310922, 79.13003173310922, 80.15690352959716, 80.15690352959716, 79.3404158331203, 79.3404158331203, 78.41356083997039, 78.41356083997039, 79.14528326023725, 79.14528326023725, 78.9562092587215, 78.9562092587215, 78.91223163874734, 78.91223163874734, 79.32041391630204, 79.32041391630204, 80.71232256550108, 80.71232256550108, 78.65454570489767, 78.65454570489767, 78.06549465592259, 78.06549465592259, 77.11587063080556, 77.11587063080556, 78.78974304354969, 78.78974304354969]}, "sampler_perf": {"mean_env_wait_ms": 11.245521854708933, "mean_raw_obs_processing_ms": 0.4795162072253585, "mean_inference_ms": 5.621450234373275, "mean_action_processing_ms": 0.1384991865925209}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 148000, "timers": {"sample_time_ms": 3942.667, "sample_throughput": 1014.542, "load_time_ms": 3.359, "load_throughput": 1190802.47, "learn_time_ms": 7560.612, "learn_throughput": 529.058, "update_time_ms": 22.104}, "info": {"learner": {"ue": {"cur_kl_coeff": 0.01875000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 196.23802185058594, "policy_loss": -0.005540094804018736, "vf_loss": 196.2433319091797, "vf_explained_var": 0.04366428032517433, "kl": 0.011229190975427628, "entropy": 0.47560229897499084, "entropy_coeff": 0.0, "model": {}}}, "num_steps_sampled": 148000, "num_steps_trained": 148000}, "done": false, "episodes_total": 1480, "training_iteration": 37, "experiment_id": "f0134eced79d425ca17ebe3d2d0a9c1b", "date": "2021-03-09_10-50-41", "timestamp": 1615283441, "time_this_iter_s": 12.069865226745605, "time_total_s": 413.8022060394287, "pid": 4108, "hostname": "ray02", "node_ip": "131.234.28.177", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "env_config": {"episode_length": 100, "seed": null, "map": "150x100map", "bs_list": ["A", "B"], "ue_list": ["1", "2"], "rand_episodes": false, "new_ue_interval": null, "reward": "sum", "log_metrics": true}, "env": "MultiAgentMobileEnv", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": true, "log_level": "WARN", "callbacks": "<class 'deepcomp.util.callbacks.CustomMetricCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"ue": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Dict(connected:MultiBinary(2), dr:Box(0.0, 1.0, (2,), float32), ues_at_bs:Box(0.0, 1.0, (2,), float32), utility:Box(-1.0, 1.0, (1,), float32))", "Discrete(3)", {}]}, "policy_mapping_fn": "<function create_env_config.<locals>.<lambda> at 0x7f6b55430b80>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 413.8022060394287, "timesteps_since_restore": 0, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 24.1125, "ram_util_percent": 4.8}, "trial_id": "e359b_00000"}
{"episode_reward_max": 162.62387512737172, "episode_reward_min": 151.55228729066607, "episode_reward_mean": 157.88360152610235, "episode_len_mean": 100.0, "episodes_this_iter": 40, "policy_reward_min": {"ue": 75.77614364533288}, "policy_reward_max": {"ue": 81.31193756368567}, "policy_reward_mean": {"ue": 78.94180076305106}, "custom_metrics": {"sum_utility_mean": 15.707316914229988, "sum_utility_min": 10.206592306948258, "sum_utility_max": 21.310345226162607, "eps_sum_utility_mean": 1610.7030624517658, "eps_sum_utility_min": 1531.7500651268863, "eps_sum_utility_max": 1664.3655660790826}, "hist_stats": {"episode_reward": [161.72671781260146, 154.5544802011466, 162.0652542240204, 160.72390364003388, 157.0885547773463, 156.8534052297298, 161.58732385806815, 158.84244898026873, 159.40744660862572, 160.4593833024024, 156.53188485319794, 156.24357726840947, 157.57873821499697, 157.7071275567267, 158.06781190678868, 160.32131294099503, 161.66892793722047, 151.55228729066607, 157.77037971912057, 158.40858722086085, 154.24140236320494, 161.02404876167355, 160.33616839068958, 156.8172042235375, 160.68347740656776, 159.09963090954153, 162.62387512737172, 155.20688687394664, 161.00189138914476, 160.9438511339721, 159.75116064625735, 159.6247489123495, 159.9988724748257, 156.42620718706382, 159.3783684427505, 153.44014651215946, 159.91483373036442, 157.69294999189327, 157.99584657901738, 161.36548074309826, 157.52611959111033, 159.6992676577152, 156.71821136872768, 153.64494895328335, 155.44726344335226, 160.08463105646905, 156.44973731532423, 158.26006346621864, 160.31380705919457, 158.68083166624098, 156.82712167994111, 158.29056652047478, 157.91241851744343, 157.82446327749489, 158.64082783260437, 161.42464513100236, 157.3090914097957, 156.1309893118455, 154.2317412616111, 157.57948608709955, 156.7802760644555, 157.20889899550218, 157.79159232768063, 158.82587495364396, 154.92505837844925, 155.06321155118223, 156.81975172710435, 158.70850464091683, 156.30155231940165, 157.15027569491252, 154.06535367796232, 159.64482423260523, 159.39048925427193, 157.659794270776, 157.27175515833585, 156.0642220055712, 156.9607861850601, 156.85008832892487, 157.90414277771424, 155.66589710604558, 159.7635041399206, 157.78896020899737, 156.89104195059332, 156.43705478131727, 159.52167232683172, 155.38305042214023, 153.85121416580313, 154.4915781012296, 157.90298485423875, 158.3903666927444, 157.5022220324742, 157.708114045453, 157.0246019395446, 159.34050001827154, 159.707568770433, 158.45568117310103, 156.20068819451774, 159.6497565030898, 156.78153167457833, 154.79287301483498], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_ue_reward": [80.86335890630063, 80.86335890630063, 77.27724010057327, 77.27724010057327, 81.03262711201002, 81.03262711201002, 80.36195182001693, 80.36195182001693, 78.54427738867305, 78.54427738867305, 78.42670261486475, 78.42670261486475, 80.7936619290339, 80.7936619290339, 79.42122449013428, 79.42122449013428, 79.70372330431275, 79.70372330431275, 80.22969165120108, 80.22969165120108, 79.06165868037344, 77.47022617282438, 78.12178863420458, 78.12178863420458, 78.78936910749832, 78.78936910749832, 79.64928003213781, 78.05784752458875, 79.03390595339421, 79.03390595339421, 80.16065647049733, 80.16065647049733, 80.83446396861011, 80.83446396861011, 75.77614364533288, 75.77614364533288, 78.8851898595601, 78.8851898595601, 79.20429361043031, 79.20429361043031, 77.91641743537689, 76.32498492782783, 80.51202438083669, 80.51202438083669, 80.16808419534472, 80.16808419534472, 78.40860211176866, 78.40860211176866, 80.34173870328371, 80.34173870328371, 79.54981545477062, 79.54981545477062, 81.31193756368567, 81.31193756368567, 76.80772718319866, 78.39915969074772, 80.50094569457224, 80.50094569457224, 80.47192556698593, 80.47192556698593, 79.87558032312853, 79.87558032312853, 79.8123744561746, 79.8123744561746, 79.99943623741278, 79.99943623741278, 78.21310359353178, 78.21310359353178, 79.68918422137511, 79.68918422137511, 77.48645257140677, 75.95369394075271, 79.95741686518201, 79.95741686518201, 79.61285431127361, 78.08009568061955, 78.99792328950853, 78.99792328950853, 80.68274037154904, 80.68274037154904, 78.76305979555505, 78.76305979555505, 79.84963382885753, 79.84963382885753, 78.35910568436375, 78.35910568436375, 76.82247447664149, 76.82247447664149, 77.72363172167601, 77.72363172167601, 80.04231552823434, 80.04231552823434, 78.22486865766204, 78.22486865766204, 79.13003173310922, 79.13003173310922, 80.15690352959716, 80.15690352959716, 79.3404158331203, 79.3404158331203, 78.41356083997039, 78.41356083997039, 79.14528326023725, 79.14528326023725, 78.9562092587215, 78.9562092587215, 78.91223163874734, 78.91223163874734, 79.32041391630204, 79.32041391630204, 80.71232256550108, 80.71232256550108, 78.65454570489767, 78.65454570489767, 78.06549465592259, 78.06549465592259, 77.11587063080556, 77.11587063080556, 78.78974304354969, 78.78974304354969, 78.39013803222758, 78.39013803222758, 78.604449497751, 78.604449497751, 78.89579616384019, 78.89579616384019, 79.41293747682184, 79.41293747682184, 77.46252918922453, 77.46252918922453, 77.53160577559103, 77.53160577559103, 78.40987586355212, 78.40987586355212, 79.35425232045831, 79.35425232045831, 78.15077615970075, 78.15077615970075, 78.57513784745616, 78.57513784745616, 77.03267683898103, 77.03267683898103, 79.82241211630249, 79.82241211630249, 79.6952446271359, 79.6952446271359, 78.82989713538788, 78.82989713538788, 78.63587757916783, 78.63587757916783, 77.39281051260689, 78.67141149296421, 78.48039309252997, 78.48039309252997, 78.42504416446226, 78.42504416446226, 78.95207138885696, 78.95207138885696, 77.8329485530226, 77.8329485530226, 79.88175206996014, 79.88175206996014, 78.89448010449853, 78.89448010449853, 78.44552097529657, 78.44552097529657, 78.21852739065858, 78.21852739065858, 79.7608361634157, 79.7608361634157, 77.69152521107, 77.69152521107, 76.2863065927228, 77.56490757308012, 78.04150530438919, 76.45007279684013, 78.95149242711926, 78.95149242711926, 79.19518334637205, 79.19518334637205, 78.751111016237, 78.751111016237, 78.85405702272635, 78.85405702272635, 77.87300047959351, 79.15160145995085, 79.67025000913551, 79.67025000913551, 79.8537843852165, 79.8537843852165, 79.22784058655049, 79.22784058655049, 78.10034409725874, 78.10034409725874, 79.82487825154475, 79.82487825154475, 78.39076583728901, 78.39076583728901, 76.60072025364283, 78.19215276119189]}, "sampler_perf": {"mean_env_wait_ms": 11.254517188298054, "mean_raw_obs_processing_ms": 0.4809315515259622, "mean_inference_ms": 5.675511476338955, "mean_action_processing_ms": 0.13805708418751042}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 152000, "timers": {"sample_time_ms": 4020.071, "sample_throughput": 995.007, "load_time_ms": 3.415, "load_throughput": 1171241.596, "learn_time_ms": 7752.11, "learn_throughput": 515.989, "update_time_ms": 22.403}, "info": {"learner": {"ue": {"cur_kl_coeff": 0.01875000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 202.63438415527344, "policy_loss": -0.003522808663547039, "vf_loss": 202.63766479492188, "vf_explained_var": 0.03269006311893463, "kl": 0.013188027776777744, "entropy": 0.4266897439956665, "entropy_coeff": 0.0, "model": {}}}, "num_steps_sampled": 152000, "num_steps_trained": 152000}, "done": false, "episodes_total": 1520, "training_iteration": 38, "experiment_id": "f0134eced79d425ca17ebe3d2d0a9c1b", "date": "2021-03-09_10-50-54", "timestamp": 1615283454, "time_this_iter_s": 12.843432426452637, "time_total_s": 426.64563846588135, "pid": 4108, "hostname": "ray02", "node_ip": "131.234.28.177", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "env_config": {"episode_length": 100, "seed": null, "map": "150x100map", "bs_list": ["A", "B"], "ue_list": ["1", "2"], "rand_episodes": false, "new_ue_interval": null, "reward": "sum", "log_metrics": true}, "env": "MultiAgentMobileEnv", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": true, "log_level": "WARN", "callbacks": "<class 'deepcomp.util.callbacks.CustomMetricCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"ue": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Dict(connected:MultiBinary(2), dr:Box(0.0, 1.0, (2,), float32), ues_at_bs:Box(0.0, 1.0, (2,), float32), utility:Box(-1.0, 1.0, (1,), float32))", "Discrete(3)", {}]}, "policy_mapping_fn": "<function create_env_config.<locals>.<lambda> at 0x7f6b553b7700>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 426.64563846588135, "timesteps_since_restore": 0, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 23.070588235294117, "ram_util_percent": 4.8}, "trial_id": "e359b_00000"}
{"episode_reward_max": 164.97421003905822, "episode_reward_min": 151.55228729066607, "episode_reward_mean": 159.38607931605603, "episode_len_mean": 100.0, "episodes_this_iter": 40, "policy_reward_min": {"ue": 75.77614364533288}, "policy_reward_max": {"ue": 82.4871050195289}, "policy_reward_mean": {"ue": 79.69303965802789}, "custom_metrics": {"sum_utility_mean": 16.15939207652092, "sum_utility_min": 10.206592306948258, "sum_utility_max": 21.310345226162607, "eps_sum_utility_mean": 1618.8447860586905, "eps_sum_utility_min": 1531.7500651268863, "eps_sum_utility_max": 1665.9108801593736}, "hist_stats": {"episode_reward": [160.20832878737474, 161.527115711271, 163.03939469015222, 159.0868468410335, 162.12614221291773, 159.21793037512947, 160.70228735481948, 161.37477118879428, 162.92424264490757, 158.2457744768269, 158.08218820607766, 161.43652537161302, 161.45342960832858, 157.3112434040669, 161.03024313689025, 159.21966484941288, 160.59506889689237, 158.61869991451675, 161.67035078256447, 157.0010746377469, 163.4260688127041, 160.3754624863351, 163.90745618490246, 160.02513821526566, 162.95757323916695, 162.0661816200901, 164.32178060392255, 161.8977595892935, 160.20751775412867, 163.82212735181344, 161.4653663132696, 158.80810452300727, 163.01029887013232, 160.73651438022688, 159.08821656873926, 162.32901897070508, 164.97421003905822, 162.9403201532271, 160.16123483513434, 162.90468765037502, 159.7635041399206, 157.78896020899737, 156.89104195059332, 156.43705478131727, 159.52167232683172, 155.38305042214023, 153.85121416580313, 154.4915781012296, 157.90298485423875, 158.3903666927444, 157.5022220324742, 157.708114045453, 157.0246019395446, 159.34050001827154, 159.707568770433, 158.45568117310103, 156.20068819451774, 159.6497565030898, 156.78153167457833, 154.79287301483498, 161.72671781260146, 154.5544802011466, 162.0652542240204, 160.72390364003388, 157.0885547773463, 156.8534052297298, 161.58732385806815, 158.84244898026873, 159.40744660862572, 160.4593833024024, 156.53188485319794, 156.24357726840947, 157.57873821499697, 157.7071275567267, 158.06781190678868, 160.32131294099503, 161.66892793722047, 151.55228729066607, 157.77037971912057, 158.40858722086085, 154.24140236320494, 161.02404876167355, 160.33616839068958, 156.8172042235375, 160.68347740656776, 159.09963090954153, 162.62387512737172, 155.20688687394664, 161.00189138914476, 160.9438511339721, 159.75116064625735, 159.6247489123495, 159.9988724748257, 156.42620718706382, 159.3783684427505, 153.44014651215946, 159.91483373036442, 157.69294999189327, 157.99584657901738, 161.36548074309826], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_ue_reward": [80.1041643936872, 80.1041643936872, 80.76355785563534, 80.76355785563534, 81.51969734507594, 81.51969734507594, 79.54342342051659, 79.54342342051659, 81.06307110645868, 81.06307110645868, 79.60896518756465, 79.60896518756465, 80.35114367740964, 80.35114367740964, 80.68738559439701, 80.68738559439701, 81.46212132245354, 81.46212132245354, 79.12288723841344, 79.12288723841344, 79.04109410303862, 79.04109410303862, 80.71826268580634, 80.71826268580634, 80.72671480416409, 80.72671480416409, 78.65562170203329, 78.65562170203329, 80.51512156844497, 80.51512156844497, 79.60983242470633, 79.60983242470633, 80.29753444844607, 80.29753444844607, 79.3093499572582, 79.3093499572582, 80.83517539128205, 80.83517539128205, 78.50053731887326, 78.50053731887326, 81.71303440635201, 81.71303440635201, 80.18773124316735, 80.18773124316735, 81.95372809245102, 81.95372809245102, 80.01256910763267, 80.01256910763267, 81.47878661958332, 81.47878661958332, 81.0330908100448, 81.0330908100448, 82.16089030196112, 82.16089030196112, 80.94887979464663, 80.94887979464663, 80.10375887706407, 80.10375887706407, 81.91106367590656, 81.91106367590656, 80.73268315663465, 80.73268315663465, 79.40405226150347, 79.40405226150347, 81.50514943506595, 81.50514943506595, 80.36825719011331, 80.36825719011331, 79.54410828436946, 79.54410828436946, 81.16450948535234, 81.16450948535234, 82.4871050195289, 82.4871050195289, 81.47016007661342, 81.47016007661342, 80.08061741756705, 80.08061741756705, 81.45234382518734, 81.45234382518734, 79.88175206996014, 79.88175206996014, 78.89448010449853, 78.89448010449853, 78.44552097529657, 78.44552097529657, 78.21852739065858, 78.21852739065858, 79.7608361634157, 79.7608361634157, 77.69152521107, 77.69152521107, 76.2863065927228, 77.56490757308012, 78.04150530438919, 76.45007279684013, 78.95149242711926, 78.95149242711926, 79.19518334637205, 79.19518334637205, 78.751111016237, 78.751111016237, 78.85405702272635, 78.85405702272635, 77.87300047959351, 79.15160145995085, 79.67025000913551, 79.67025000913551, 79.8537843852165, 79.8537843852165, 79.22784058655049, 79.22784058655049, 78.10034409725874, 78.10034409725874, 79.82487825154475, 79.82487825154475, 78.39076583728901, 78.39076583728901, 76.60072025364283, 78.19215276119189, 80.86335890630063, 80.86335890630063, 77.27724010057327, 77.27724010057327, 81.03262711201002, 81.03262711201002, 80.36195182001693, 80.36195182001693, 78.54427738867305, 78.54427738867305, 78.42670261486475, 78.42670261486475, 80.7936619290339, 80.7936619290339, 79.42122449013428, 79.42122449013428, 79.70372330431275, 79.70372330431275, 80.22969165120108, 80.22969165120108, 79.06165868037344, 77.47022617282438, 78.12178863420458, 78.12178863420458, 78.78936910749832, 78.78936910749832, 79.64928003213781, 78.05784752458875, 79.03390595339421, 79.03390595339421, 80.16065647049733, 80.16065647049733, 80.83446396861011, 80.83446396861011, 75.77614364533288, 75.77614364533288, 78.8851898595601, 78.8851898595601, 79.20429361043031, 79.20429361043031, 77.91641743537689, 76.32498492782783, 80.51202438083669, 80.51202438083669, 80.16808419534472, 80.16808419534472, 78.40860211176866, 78.40860211176866, 80.34173870328371, 80.34173870328371, 79.54981545477062, 79.54981545477062, 81.31193756368567, 81.31193756368567, 76.80772718319866, 78.39915969074772, 80.50094569457224, 80.50094569457224, 80.47192556698593, 80.47192556698593, 79.87558032312853, 79.87558032312853, 79.8123744561746, 79.8123744561746, 79.99943623741278, 79.99943623741278, 78.21310359353178, 78.21310359353178, 79.68918422137511, 79.68918422137511, 77.48645257140677, 75.95369394075271, 79.95741686518201, 79.95741686518201, 79.61285431127361, 78.08009568061955, 78.99792328950853, 78.99792328950853, 80.68274037154904, 80.68274037154904]}, "sampler_perf": {"mean_env_wait_ms": 11.26894609130519, "mean_raw_obs_processing_ms": 0.4841441433321907, "mean_inference_ms": 5.72444829038558, "mean_action_processing_ms": 0.13800654529799805}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 156000, "timers": {"sample_time_ms": 4106.961, "sample_throughput": 973.956, "load_time_ms": 4.318, "load_throughput": 926324.345, "learn_time_ms": 7882.757, "learn_throughput": 507.437, "update_time_ms": 22.428}, "info": {"learner": {"ue": {"cur_kl_coeff": 0.01875000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 207.00624084472656, "policy_loss": -0.001917822053655982, "vf_loss": 207.00802612304688, "vf_explained_var": 0.03239639475941658, "kl": 0.00831628032028675, "entropy": 0.4158749282360077, "entropy_coeff": 0.0, "model": {}}}, "num_steps_sampled": 156000, "num_steps_trained": 156000}, "done": false, "episodes_total": 1560, "training_iteration": 39, "experiment_id": "f0134eced79d425ca17ebe3d2d0a9c1b", "date": "2021-03-09_10-51-06", "timestamp": 1615283466, "time_this_iter_s": 12.358536720275879, "time_total_s": 439.0041751861572, "pid": 4108, "hostname": "ray02", "node_ip": "131.234.28.177", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "env_config": {"episode_length": 100, "seed": null, "map": "150x100map", "bs_list": ["A", "B"], "ue_list": ["1", "2"], "rand_episodes": false, "new_ue_interval": null, "reward": "sum", "log_metrics": true}, "env": "MultiAgentMobileEnv", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": true, "log_level": "WARN", "callbacks": "<class 'deepcomp.util.callbacks.CustomMetricCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"ue": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Dict(connected:MultiBinary(2), dr:Box(0.0, 1.0, (2,), float32), ues_at_bs:Box(0.0, 1.0, (2,), float32), utility:Box(-1.0, 1.0, (1,), float32))", "Discrete(3)", {}]}, "policy_mapping_fn": "<function create_env_config.<locals>.<lambda> at 0x7f6b55430940>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 439.0041751861572, "timesteps_since_restore": 0, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 23.917647058823526, "ram_util_percent": 4.8}, "trial_id": "e359b_00000"}
{"episode_reward_max": 164.97421003905822, "episode_reward_min": 153.44014651215946, "episode_reward_mean": 160.43257447020483, "episode_len_mean": 100.0, "episodes_this_iter": 40, "policy_reward_min": {"ue": 75.95369394075271}, "policy_reward_max": {"ue": 82.4871050195289}, "policy_reward_mean": {"ue": 80.21628723510229}, "custom_metrics": {"sum_utility_mean": 16.446230195845896, "sum_utility_min": 10.206592306948258, "sum_utility_max": 18.926298722075135, "eps_sum_utility_mean": 1624.6918191177995, "eps_sum_utility_min": 1551.0393966543, "eps_sum_utility_max": 1665.9108801593736}, "hist_stats": {"episode_reward": [159.8666002915785, 157.7857099829186, 162.64542040155737, 161.02438171354476, 159.55293999350863, 159.96348928273426, 156.44962569031844, 161.16339234034922, 160.01623081105305, 163.04052209015538, 159.0458150988576, 158.7531822337367, 161.4849260456199, 161.9902268738071, 158.93609472840427, 161.01599774250184, 160.83805756442604, 164.27859579844477, 160.22881591579448, 160.13509199912676, 160.35350404870888, 161.6568068394535, 159.92371315068146, 162.63990508565564, 162.00820735188307, 159.31316175225766, 161.95568348164267, 162.64121659223935, 161.28028564073196, 158.09486280607126, 158.52100462793243, 161.9187424532331, 158.76495722405986, 160.2568654373447, 162.9518299354362, 161.24458432509215, 158.62080480020194, 161.61974944822038, 160.63398361984133, 158.77904874909427, 154.24140236320494, 161.02404876167355, 160.33616839068958, 156.8172042235375, 160.68347740656776, 159.09963090954153, 162.62387512737172, 155.20688687394664, 161.00189138914476, 160.9438511339721, 159.75116064625735, 159.6247489123495, 159.9988724748257, 156.42620718706382, 159.3783684427505, 153.44014651215946, 159.91483373036442, 157.69294999189327, 157.99584657901738, 161.36548074309826, 160.20832878737474, 161.527115711271, 163.03939469015222, 159.0868468410335, 162.12614221291773, 159.21793037512947, 160.70228735481948, 161.37477118879428, 162.92424264490757, 158.2457744768269, 158.08218820607766, 161.43652537161302, 161.45342960832858, 157.3112434040669, 161.03024313689025, 159.21966484941288, 160.59506889689237, 158.61869991451675, 161.67035078256447, 157.0010746377469, 163.4260688127041, 160.3754624863351, 163.90745618490246, 160.02513821526566, 162.95757323916695, 162.0661816200901, 164.32178060392255, 161.8977595892935, 160.20751775412867, 163.82212735181344, 161.4653663132696, 158.80810452300727, 163.01029887013232, 160.73651438022688, 159.08821656873926, 162.32901897070508, 164.97421003905822, 162.9403201532271, 160.16123483513434, 162.90468765037502], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_ue_reward": [79.93330014578913, 79.93330014578913, 78.89285499145913, 78.89285499145913, 81.32271020077849, 81.32271020077849, 80.5121908567722, 80.5121908567722, 79.77646999675419, 79.77646999675419, 79.98174464136709, 79.98174464136709, 78.22481284515922, 78.22481284515922, 80.58169617017451, 80.58169617017451, 80.00811540552638, 80.00811540552638, 81.52026104507762, 81.52026104507762, 79.52290754942874, 79.52290754942874, 79.37659111686821, 79.37659111686821, 80.74246302280976, 80.74246302280976, 80.99511343690348, 80.99511343690348, 79.46804736420198, 79.46804736420198, 80.50799887125076, 80.50799887125076, 80.41902878221279, 80.41902878221279, 82.13929789922224, 82.13929789922224, 80.11440795789711, 80.11440795789711, 80.06754599956314, 80.06754599956314, 80.17675202435437, 80.17675202435437, 80.82840341972653, 80.82840341972653, 79.96185657534062, 79.96185657534062, 81.31995254282774, 81.31995254282774, 81.00410367594131, 81.00410367594131, 79.65658087612877, 79.65658087612877, 80.9778417408212, 80.9778417408212, 81.32060829611963, 81.32060829611963, 80.64014282036588, 80.64014282036588, 78.25171514926092, 79.84314765680999, 79.26050231396607, 79.26050231396607, 80.95937122661645, 80.95937122661645, 79.38247861202979, 79.38247861202979, 80.12843271867217, 80.12843271867217, 81.47591496771797, 81.47591496771797, 80.6222921625459, 80.6222921625459, 79.31040240010088, 79.31040240010088, 80.80987472411009, 80.80987472411009, 80.31699180992051, 80.31699180992051, 79.38952437454707, 79.38952437454707, 77.91641743537689, 76.32498492782783, 80.51202438083669, 80.51202438083669, 80.16808419534472, 80.16808419534472, 78.40860211176866, 78.40860211176866, 80.34173870328371, 80.34173870328371, 79.54981545477062, 79.54981545477062, 81.31193756368567, 81.31193756368567, 76.80772718319866, 78.39915969074772, 80.50094569457224, 80.50094569457224, 80.47192556698593, 80.47192556698593, 79.87558032312853, 79.87558032312853, 79.8123744561746, 79.8123744561746, 79.99943623741278, 79.99943623741278, 78.21310359353178, 78.21310359353178, 79.68918422137511, 79.68918422137511, 77.48645257140677, 75.95369394075271, 79.95741686518201, 79.95741686518201, 79.61285431127361, 78.08009568061955, 78.99792328950853, 78.99792328950853, 80.68274037154904, 80.68274037154904, 80.1041643936872, 80.1041643936872, 80.76355785563534, 80.76355785563534, 81.51969734507594, 81.51969734507594, 79.54342342051659, 79.54342342051659, 81.06307110645868, 81.06307110645868, 79.60896518756465, 79.60896518756465, 80.35114367740964, 80.35114367740964, 80.68738559439701, 80.68738559439701, 81.46212132245354, 81.46212132245354, 79.12288723841344, 79.12288723841344, 79.04109410303862, 79.04109410303862, 80.71826268580634, 80.71826268580634, 80.72671480416409, 80.72671480416409, 78.65562170203329, 78.65562170203329, 80.51512156844497, 80.51512156844497, 79.60983242470633, 79.60983242470633, 80.29753444844607, 80.29753444844607, 79.3093499572582, 79.3093499572582, 80.83517539128205, 80.83517539128205, 78.50053731887326, 78.50053731887326, 81.71303440635201, 81.71303440635201, 80.18773124316735, 80.18773124316735, 81.95372809245102, 81.95372809245102, 80.01256910763267, 80.01256910763267, 81.47878661958332, 81.47878661958332, 81.0330908100448, 81.0330908100448, 82.16089030196112, 82.16089030196112, 80.94887979464663, 80.94887979464663, 80.10375887706407, 80.10375887706407, 81.91106367590656, 81.91106367590656, 80.73268315663465, 80.73268315663465, 79.40405226150347, 79.40405226150347, 81.50514943506595, 81.50514943506595, 80.36825719011331, 80.36825719011331, 79.54410828436946, 79.54410828436946, 81.16450948535234, 81.16450948535234, 82.4871050195289, 82.4871050195289, 81.47016007661342, 81.47016007661342, 80.08061741756705, 80.08061741756705, 81.45234382518734, 81.45234382518734]}, "sampler_perf": {"mean_env_wait_ms": 11.294467372818133, "mean_raw_obs_processing_ms": 0.4873703365880656, "mean_inference_ms": 5.763851870393748, "mean_action_processing_ms": 0.13875063019776307}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 160000, "timers": {"sample_time_ms": 4190.676, "sample_throughput": 954.5, "load_time_ms": 4.151, "load_throughput": 963587.576, "learn_time_ms": 7958.958, "learn_throughput": 502.578, "update_time_ms": 22.433}, "info": {"learner": {"ue": {"cur_kl_coeff": 0.01875000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 204.74758911132812, "policy_loss": 9.47545595408883e-06, "vf_loss": 204.7474822998047, "vf_explained_var": 0.03439244627952576, "kl": 0.004140717443078756, "entropy": 0.37627291679382324, "entropy_coeff": 0.0, "model": {}}}, "num_steps_sampled": 160000, "num_steps_trained": 160000}, "done": false, "episodes_total": 1600, "training_iteration": 40, "experiment_id": "f0134eced79d425ca17ebe3d2d0a9c1b", "date": "2021-03-09_10-51-19", "timestamp": 1615283479, "time_this_iter_s": 12.045491695404053, "time_total_s": 451.0496668815613, "pid": 4108, "hostname": "ray02", "node_ip": "131.234.28.177", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "env_config": {"episode_length": 100, "seed": null, "map": "150x100map", "bs_list": ["A", "B"], "ue_list": ["1", "2"], "rand_episodes": false, "new_ue_interval": null, "reward": "sum", "log_metrics": true}, "env": "MultiAgentMobileEnv", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": true, "log_level": "WARN", "callbacks": "<class 'deepcomp.util.callbacks.CustomMetricCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"ue": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Dict(connected:MultiBinary(2), dr:Box(0.0, 1.0, (2,), float32), ues_at_bs:Box(0.0, 1.0, (2,), float32), utility:Box(-1.0, 1.0, (1,), float32))", "Discrete(3)", {}]}, "policy_mapping_fn": "<function create_env_config.<locals>.<lambda> at 0x7f6b55430310>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 451.0496668815613, "timesteps_since_restore": 0, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 25.24375, "ram_util_percent": 4.8}, "trial_id": "e359b_00000"}
{"episode_reward_max": 165.07439432184196, "episode_reward_min": 156.44962569031844, "episode_reward_mean": 161.0530436303411, "episode_len_mean": 100.0, "episodes_this_iter": 40, "policy_reward_min": {"ue": 78.22481284515922}, "policy_reward_max": {"ue": 82.53719716092077}, "policy_reward_mean": {"ue": 80.5265218151704}, "custom_metrics": {"sum_utility_mean": 16.666500188830778, "sum_utility_min": 10.206592306948258, "sum_utility_max": 21.310345226162607, "eps_sum_utility_mean": 1628.5339857284303, "eps_sum_utility_min": 1583.8555566179639, "eps_sum_utility_max": 1665.9108801593736}, "hist_stats": {"episode_reward": [160.29528549380444, 157.32003840048844, 158.93274730412725, 159.89594649138996, 160.4237991323713, 161.45365730991205, 160.26867568895756, 165.07439432184196, 160.53799432710503, 162.06290193956983, 161.4488078977526, 160.57922304518877, 164.1014489994704, 158.3409398669897, 162.40849316130323, 162.18870157513447, 161.432245766449, 161.8253626009723, 161.73600825829743, 159.52428953315052, 162.84571824234126, 163.8320298958527, 162.32175709397802, 161.54301165258687, 161.73600825829766, 160.331386722287, 162.3805924850434, 160.83552591121287, 157.6157016353688, 161.86275401310706, 159.8421594473869, 161.7247496386653, 160.79735701732983, 164.2894937685561, 160.16267455183777, 160.29162170277039, 163.28659121706067, 156.70518272727668, 161.65278132986748, 160.5772324792901, 163.4260688127041, 160.3754624863351, 163.90745618490246, 160.02513821526566, 162.95757323916695, 162.0661816200901, 164.32178060392255, 161.8977595892935, 160.20751775412867, 163.82212735181344, 161.4653663132696, 158.80810452300727, 163.01029887013232, 160.73651438022688, 159.08821656873926, 162.32901897070508, 164.97421003905822, 162.9403201532271, 160.16123483513434, 162.90468765037502, 159.8666002915785, 157.7857099829186, 162.64542040155737, 161.02438171354476, 159.55293999350863, 159.96348928273426, 156.44962569031844, 161.16339234034922, 160.01623081105305, 163.04052209015538, 159.0458150988576, 158.7531822337367, 161.4849260456199, 161.9902268738071, 158.93609472840427, 161.01599774250184, 160.83805756442604, 164.27859579844477, 160.22881591579448, 160.13509199912676, 160.35350404870888, 161.6568068394535, 159.92371315068146, 162.63990508565564, 162.00820735188307, 159.31316175225766, 161.95568348164267, 162.64121659223935, 161.28028564073196, 158.09486280607126, 158.52100462793243, 161.9187424532331, 158.76495722405986, 160.2568654373447, 162.9518299354362, 161.24458432509215, 158.62080480020194, 161.61974944822038, 160.63398361984133, 158.77904874909427], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_ue_reward": [80.14764274690214, 80.14764274690214, 78.66001920024411, 78.66001920024411, 79.46637365206342, 79.46637365206342, 79.94797324569488, 79.94797324569488, 80.21189956618551, 80.21189956618551, 80.7268286549559, 80.7268286549559, 80.1343378444787, 80.1343378444787, 82.53719716092077, 82.53719716092077, 80.26899716355244, 80.26899716355244, 81.03145096978479, 81.03145096978479, 80.7244039488761, 80.7244039488761, 80.28961152259426, 80.28961152259426, 82.05072449973501, 82.05072449973501, 79.17046993349467, 79.17046993349467, 81.20424658065137, 81.20424658065137, 81.09435078756705, 81.09435078756705, 80.71612288322437, 80.71612288322437, 80.91268130048604, 80.91268130048604, 80.86800412914862, 80.86800412914862, 79.76214476657522, 79.76214476657522, 81.42285912117055, 81.42285912117055, 81.91601494792619, 81.91601494792619, 81.16087854698885, 81.16087854698885, 80.77150582629335, 80.77150582629335, 80.86800412914859, 80.86800412914859, 80.16569336114345, 80.16569336114345, 81.1902962425216, 81.1902962425216, 80.41776295560624, 80.41776295560624, 78.8078508176843, 78.8078508176843, 80.93137700655345, 80.93137700655345, 79.92107972369335, 79.92107972369335, 80.86237481933246, 80.86237481933246, 80.39867850866472, 80.39867850866472, 82.14474688427791, 82.14474688427791, 80.08133727591867, 80.08133727591867, 80.145810851385, 80.145810851385, 81.64329560853015, 81.64329560853015, 78.35259136363827, 78.35259136363827, 80.82639066493358, 80.82639066493358, 80.28861623964488, 80.28861623964488, 81.71303440635201, 81.71303440635201, 80.18773124316735, 80.18773124316735, 81.95372809245102, 81.95372809245102, 80.01256910763267, 80.01256910763267, 81.47878661958332, 81.47878661958332, 81.0330908100448, 81.0330908100448, 82.16089030196112, 82.16089030196112, 80.94887979464663, 80.94887979464663, 80.10375887706407, 80.10375887706407, 81.91106367590656, 81.91106367590656, 80.73268315663465, 80.73268315663465, 79.40405226150347, 79.40405226150347, 81.50514943506595, 81.50514943506595, 80.36825719011331, 80.36825719011331, 79.54410828436946, 79.54410828436946, 81.16450948535234, 81.16450948535234, 82.4871050195289, 82.4871050195289, 81.47016007661342, 81.47016007661342, 80.08061741756705, 80.08061741756705, 81.45234382518734, 81.45234382518734, 79.93330014578913, 79.93330014578913, 78.89285499145913, 78.89285499145913, 81.32271020077849, 81.32271020077849, 80.5121908567722, 80.5121908567722, 79.77646999675419, 79.77646999675419, 79.98174464136709, 79.98174464136709, 78.22481284515922, 78.22481284515922, 80.58169617017451, 80.58169617017451, 80.00811540552638, 80.00811540552638, 81.52026104507762, 81.52026104507762, 79.52290754942874, 79.52290754942874, 79.37659111686821, 79.37659111686821, 80.74246302280976, 80.74246302280976, 80.99511343690348, 80.99511343690348, 79.46804736420198, 79.46804736420198, 80.50799887125076, 80.50799887125076, 80.41902878221279, 80.41902878221279, 82.13929789922224, 82.13929789922224, 80.11440795789711, 80.11440795789711, 80.06754599956314, 80.06754599956314, 80.17675202435437, 80.17675202435437, 80.82840341972653, 80.82840341972653, 79.96185657534062, 79.96185657534062, 81.31995254282774, 81.31995254282774, 81.00410367594131, 81.00410367594131, 79.65658087612877, 79.65658087612877, 80.9778417408212, 80.9778417408212, 81.32060829611963, 81.32060829611963, 80.64014282036588, 80.64014282036588, 78.25171514926092, 79.84314765680999, 79.26050231396607, 79.26050231396607, 80.95937122661645, 80.95937122661645, 79.38247861202979, 79.38247861202979, 80.12843271867217, 80.12843271867217, 81.47591496771797, 81.47591496771797, 80.6222921625459, 80.6222921625459, 79.31040240010088, 79.31040240010088, 80.80987472411009, 80.80987472411009, 80.31699180992051, 80.31699180992051, 79.38952437454707, 79.38952437454707]}, "sampler_perf": {"mean_env_wait_ms": 11.310463965926225, "mean_raw_obs_processing_ms": 0.49039920866563347, "mean_inference_ms": 5.798203818501365, "mean_action_processing_ms": 0.13914428414786287}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 164000, "timers": {"sample_time_ms": 4227.322, "sample_throughput": 946.226, "load_time_ms": 4.179, "load_throughput": 957182.973, "learn_time_ms": 7908.761, "learn_throughput": 505.768, "update_time_ms": 20.058}, "info": {"learner": {"ue": {"cur_kl_coeff": 0.00937500037252903, "cur_lr": 4.999999873689376e-05, "total_loss": 203.82374572753906, "policy_loss": -0.003269164590165019, "vf_loss": 203.8269500732422, "vf_explained_var": 0.04428032040596008, "kl": 0.007872362621128559, "entropy": 0.40706565976142883, "entropy_coeff": 0.0, "model": {}}}, "num_steps_sampled": 164000, "num_steps_trained": 164000}, "done": false, "episodes_total": 1640, "training_iteration": 41, "experiment_id": "f0134eced79d425ca17ebe3d2d0a9c1b", "date": "2021-03-09_10-51-31", "timestamp": 1615283491, "time_this_iter_s": 12.118443965911865, "time_total_s": 463.16811084747314, "pid": 4108, "hostname": "ray02", "node_ip": "131.234.28.177", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "env_config": {"episode_length": 100, "seed": null, "map": "150x100map", "bs_list": ["A", "B"], "ue_list": ["1", "2"], "rand_episodes": false, "new_ue_interval": null, "reward": "sum", "log_metrics": true}, "env": "MultiAgentMobileEnv", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": true, "log_level": "WARN", "callbacks": "<class 'deepcomp.util.callbacks.CustomMetricCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"ue": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Dict(connected:MultiBinary(2), dr:Box(0.0, 1.0, (2,), float32), ues_at_bs:Box(0.0, 1.0, (2,), float32), utility:Box(-1.0, 1.0, (1,), float32))", "Discrete(3)", {}]}, "policy_mapping_fn": "<function create_env_config.<locals>.<lambda> at 0x7f6b553b74c0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 463.16811084747314, "timesteps_since_restore": 0, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 24.65, "ram_util_percent": 4.8}, "trial_id": "e359b_00000"}
{"episode_reward_max": 165.07439432184196, "episode_reward_min": 152.54696832152234, "episode_reward_mean": 160.6238641841826, "episode_len_mean": 100.0, "episodes_this_iter": 40, "policy_reward_min": {"ue": 76.27348416076111}, "policy_reward_max": {"ue": 82.53719716092077}, "policy_reward_mean": {"ue": 80.31193209209117}, "custom_metrics": {"sum_utility_mean": 16.38413749063589, "sum_utility_min": 10.206592306948258, "sum_utility_max": 21.310345226162607, "eps_sum_utility_mean": 1623.121151258256, "eps_sum_utility_min": 1568.0903736675475, "eps_sum_utility_max": 1661.3991158314982}, "hist_stats": {"episode_reward": [161.4973632238984, 162.99336215094945, 159.46973071922315, 157.81971335679953, 160.25269108246823, 161.11916880004162, 152.54696832152234, 160.07059137783818, 161.2246183051808, 157.80725852437604, 159.43055376918664, 161.98711393196822, 161.44506627245676, 158.34966790243953, 160.55394064427895, 162.19062518006155, 161.36927826485532, 157.24497382999044, 160.14653403757848, 159.4765639164267, 158.54768041974495, 161.82475157166004, 163.87862811257304, 158.83973497726674, 161.10937759476258, 160.26248228774722, 160.40795328066753, 162.6021018653567, 161.23710083525413, 156.1683448060714, 156.8560864640193, 158.64538044414695, 160.6216174525913, 159.71808234378489, 160.25171833460388, 162.9793688931441, 160.62711037653065, 161.71826050586867, 159.99096127947064, 161.43968468727763, 160.35350404870888, 161.6568068394535, 159.92371315068146, 162.63990508565564, 162.00820735188307, 159.31316175225766, 161.95568348164267, 162.64121659223935, 161.28028564073196, 158.09486280607126, 158.52100462793243, 161.9187424532331, 158.76495722405986, 160.2568654373447, 162.9518299354362, 161.24458432509215, 158.62080480020194, 161.61974944822038, 160.63398361984133, 158.77904874909427, 160.29528549380444, 157.32003840048844, 158.93274730412725, 159.89594649138996, 160.4237991323713, 161.45365730991205, 160.26867568895756, 165.07439432184196, 160.53799432710503, 162.06290193956983, 161.4488078977526, 160.57922304518877, 164.1014489994704, 158.3409398669897, 162.40849316130323, 162.18870157513447, 161.432245766449, 161.8253626009723, 161.73600825829743, 159.52428953315052, 162.84571824234126, 163.8320298958527, 162.32175709397802, 161.54301165258687, 161.73600825829766, 160.331386722287, 162.3805924850434, 160.83552591121287, 157.6157016353688, 161.86275401310706, 159.8421594473869, 161.7247496386653, 160.79735701732983, 164.2894937685561, 160.16267455183777, 160.29162170277039, 163.28659121706067, 156.70518272727668, 161.65278132986748, 160.5772324792901], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_ue_reward": [80.74868161194915, 80.74868161194915, 81.49668107547467, 81.49668107547467, 79.73486535961149, 79.73486535961149, 78.9098566783996, 78.9098566783996, 80.12634554123392, 80.12634554123392, 80.55958440002071, 80.55958440002071, 76.27348416076111, 76.27348416076111, 80.03529568891892, 80.03529568891892, 80.61230915259034, 80.61230915259034, 78.9036292621879, 78.9036292621879, 79.71527688459324, 79.71527688459324, 80.9935569659841, 80.9935569659841, 80.72253313622815, 80.72253313622815, 79.17483395121968, 79.17483395121968, 80.27697032213935, 80.27697032213935, 81.09531259003057, 81.09531259003057, 80.68463913242746, 80.68463913242746, 78.62248691499511, 78.62248691499511, 80.07326701878924, 80.07326701878924, 79.73828195821332, 79.73828195821332, 79.27384020987232, 79.27384020987232, 80.91237578582981, 80.91237578582981, 81.93931405628642, 81.93931405628642, 79.41986748863317, 79.41986748863317, 80.55468879738117, 80.55468879738117, 80.13124114387345, 80.13124114387345, 80.20397664033368, 80.20397664033368, 81.30105093267832, 81.30105093267832, 80.61855041762698, 80.61855041762698, 77.2884561492611, 78.87988865681015, 78.42804323200953, 78.42804323200953, 79.32269022207336, 79.32269022207336, 80.31080872629562, 80.31080872629562, 79.85904117189234, 79.85904117189234, 80.12585916730184, 80.12585916730184, 81.48968444657191, 81.48968444657191, 80.31355518826514, 80.31355518826514, 80.8591302529342, 80.8591302529342, 79.99548063973518, 79.99548063973518, 80.71984234363869, 80.71984234363869, 80.17675202435437, 80.17675202435437, 80.82840341972653, 80.82840341972653, 79.96185657534062, 79.96185657534062, 81.31995254282774, 81.31995254282774, 81.00410367594131, 81.00410367594131, 79.65658087612877, 79.65658087612877, 80.9778417408212, 80.9778417408212, 81.32060829611963, 81.32060829611963, 80.64014282036588, 80.64014282036588, 78.25171514926092, 79.84314765680999, 79.26050231396607, 79.26050231396607, 80.95937122661645, 80.95937122661645, 79.38247861202979, 79.38247861202979, 80.12843271867217, 80.12843271867217, 81.47591496771797, 81.47591496771797, 80.6222921625459, 80.6222921625459, 79.31040240010088, 79.31040240010088, 80.80987472411009, 80.80987472411009, 80.31699180992051, 80.31699180992051, 79.38952437454707, 79.38952437454707, 80.14764274690214, 80.14764274690214, 78.66001920024411, 78.66001920024411, 79.46637365206342, 79.46637365206342, 79.94797324569488, 79.94797324569488, 80.21189956618551, 80.21189956618551, 80.7268286549559, 80.7268286549559, 80.1343378444787, 80.1343378444787, 82.53719716092077, 82.53719716092077, 80.26899716355244, 80.26899716355244, 81.03145096978479, 81.03145096978479, 80.7244039488761, 80.7244039488761, 80.28961152259426, 80.28961152259426, 82.05072449973501, 82.05072449973501, 79.17046993349467, 79.17046993349467, 81.20424658065137, 81.20424658065137, 81.09435078756705, 81.09435078756705, 80.71612288322437, 80.71612288322437, 80.91268130048604, 80.91268130048604, 80.86800412914862, 80.86800412914862, 79.76214476657522, 79.76214476657522, 81.42285912117055, 81.42285912117055, 81.91601494792619, 81.91601494792619, 81.16087854698885, 81.16087854698885, 80.77150582629335, 80.77150582629335, 80.86800412914859, 80.86800412914859, 80.16569336114345, 80.16569336114345, 81.1902962425216, 81.1902962425216, 80.41776295560624, 80.41776295560624, 78.8078508176843, 78.8078508176843, 80.93137700655345, 80.93137700655345, 79.92107972369335, 79.92107972369335, 80.86237481933246, 80.86237481933246, 80.39867850866472, 80.39867850866472, 82.14474688427791, 82.14474688427791, 80.08133727591867, 80.08133727591867, 80.145810851385, 80.145810851385, 81.64329560853015, 81.64329560853015, 78.35259136363827, 78.35259136363827, 80.82639066493358, 80.82639066493358, 80.28861623964488, 80.28861623964488]}, "sampler_perf": {"mean_env_wait_ms": 11.317282199231377, "mean_raw_obs_processing_ms": 0.4953872365972745, "mean_inference_ms": 5.827630329672598, "mean_action_processing_ms": 0.1389547749687312}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 168000, "timers": {"sample_time_ms": 4171.928, "sample_throughput": 958.789, "load_time_ms": 4.156, "load_throughput": 962448.858, "learn_time_ms": 7850.702, "learn_throughput": 509.509, "update_time_ms": 9.216}, "info": {"learner": {"ue": {"cur_kl_coeff": 0.00937500037252903, "cur_lr": 4.999999873689376e-05, "total_loss": 203.9735565185547, "policy_loss": -0.0026653229724615812, "vf_loss": 203.9761505126953, "vf_explained_var": 0.03162146732211113, "kl": 0.008527437224984169, "entropy": 0.3794611096382141, "entropy_coeff": 0.0, "model": {}}}, "num_steps_sampled": 168000, "num_steps_trained": 168000}, "done": false, "episodes_total": 1680, "training_iteration": 42, "experiment_id": "f0134eced79d425ca17ebe3d2d0a9c1b", "date": "2021-03-09_10-51-43", "timestamp": 1615283503, "time_this_iter_s": 11.8213951587677, "time_total_s": 474.98950600624084, "pid": 4108, "hostname": "ray02", "node_ip": "131.234.28.177", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "env_config": {"episode_length": 100, "seed": null, "map": "150x100map", "bs_list": ["A", "B"], "ue_list": ["1", "2"], "rand_episodes": false, "new_ue_interval": null, "reward": "sum", "log_metrics": true}, "env": "MultiAgentMobileEnv", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": true, "log_level": "WARN", "callbacks": "<class 'deepcomp.util.callbacks.CustomMetricCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"ue": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Dict(connected:MultiBinary(2), dr:Box(0.0, 1.0, (2,), float32), ues_at_bs:Box(0.0, 1.0, (2,), float32), utility:Box(-1.0, 1.0, (1,), float32))", "Discrete(3)", {}]}, "policy_mapping_fn": "<function create_env_config.<locals>.<lambda> at 0x7f6b55430f70>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 474.98950600624084, "timesteps_since_restore": 0, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 24.581249999999997, "ram_util_percent": 4.8}, "trial_id": "e359b_00000"}
{"episode_reward_max": 165.28676937914446, "episode_reward_min": 152.54696832152234, "episode_reward_mean": 160.5403464469738, "episode_len_mean": 100.0, "episodes_this_iter": 40, "policy_reward_min": {"ue": 76.27348416076111}, "policy_reward_max": {"ue": 82.64338468957202}, "policy_reward_mean": {"ue": 80.2701732234868}, "custom_metrics": {"sum_utility_mean": 16.35741421836209, "sum_utility_min": 10.206592306948258, "sum_utility_max": 18.926298722075135, "eps_sum_utility_mean": 1619.9999035059225, "eps_sum_utility_min": 1568.0903736675475, "eps_sum_utility_max": 1664.878950675962}, "hist_stats": {"episode_reward": [160.34817283938787, 165.28676937914446, 161.37786930231067, 159.1332785583187, 160.01044921800667, 162.0794975753717, 162.0796975793055, 159.04074909765046, 160.37543196286282, 160.21929748226938, 161.44990281528857, 157.50417783067167, 159.4190893387722, 159.90370884145455, 161.60864947749735, 160.39606017072958, 155.64828839002678, 159.72601700013325, 161.58230794647312, 163.14414952486885, 159.8305660240676, 160.87208863595663, 159.3511465395602, 161.91874245323316, 162.2099348188657, 160.73174884842354, 159.61208701351353, 162.2258260223639, 160.81909473116866, 162.65247521187172, 157.1950951499647, 160.13946157311966, 162.5671463787827, 156.65157900706862, 162.23380998553927, 159.31051402246652, 163.61992761030405, 160.20783305185495, 162.20610931321346, 159.98935404130066, 162.84571824234126, 163.8320298958527, 162.32175709397802, 161.54301165258687, 161.73600825829766, 160.331386722287, 162.3805924850434, 160.83552591121287, 157.6157016353688, 161.86275401310706, 159.8421594473869, 161.7247496386653, 160.79735701732983, 164.2894937685561, 160.16267455183777, 160.29162170277039, 163.28659121706067, 156.70518272727668, 161.65278132986748, 160.5772324792901, 161.4973632238984, 162.99336215094945, 159.46973071922315, 157.81971335679953, 160.25269108246823, 161.11916880004162, 152.54696832152234, 160.07059137783818, 161.2246183051808, 157.80725852437604, 159.43055376918664, 161.98711393196822, 161.44506627245676, 158.34966790243953, 160.55394064427895, 162.19062518006155, 161.36927826485532, 157.24497382999044, 160.14653403757848, 159.4765639164267, 158.54768041974495, 161.82475157166004, 163.87862811257304, 158.83973497726674, 161.10937759476258, 160.26248228774722, 160.40795328066753, 162.6021018653567, 161.23710083525413, 156.1683448060714, 156.8560864640193, 158.64538044414695, 160.6216174525913, 159.71808234378489, 160.25171833460388, 162.9793688931441, 160.62711037653065, 161.71826050586867, 159.99096127947064, 161.43968468727763], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_ue_reward": [80.1740864196938, 80.1740864196938, 82.64338468957202, 82.64338468957202, 80.68893465115518, 80.68893465115518, 79.56663927915923, 79.56663927915923, 80.00522460900318, 80.00522460900318, 81.03974878768578, 81.03974878768578, 81.03984878965264, 81.03984878965264, 79.52037454882519, 79.52037454882519, 80.18771598143132, 80.18771598143132, 80.10964874113456, 80.10964874113456, 80.72495140764426, 80.72495140764426, 79.51846823066279, 77.98570960000872, 79.70954466938595, 79.70954466938595, 79.9518544207272, 79.9518544207272, 80.1650242485699, 81.44362522892722, 80.1980300853647, 80.1980300853647, 77.82414419501325, 77.82414419501325, 79.86300850006657, 79.86300850006657, 80.79115397323655, 80.79115397323655, 81.5720747624342, 81.5720747624342, 79.91528301203365, 79.91528301203365, 80.43604431797823, 80.43604431797823, 79.67557326978005, 79.67557326978005, 80.95937122661645, 80.95937122661645, 81.10496740943267, 81.10496740943267, 80.36587442421171, 80.36587442421171, 79.80604350675662, 79.80604350675662, 81.11291301118175, 81.11291301118175, 79.77024687540548, 81.0488478557628, 81.32623760593572, 81.32623760593572, 78.5975475749822, 78.5975475749822, 80.06973078655965, 80.06973078655965, 81.28357318939129, 81.28357318939129, 78.32578950353431, 78.32578950353431, 81.11690499276949, 81.11690499276949, 79.65525701123325, 79.65525701123325, 81.80996380515195, 81.80996380515195, 80.10391652592727, 80.10391652592727, 81.10305465660655, 81.10305465660655, 79.99467702065024, 79.99467702065024, 81.42285912117055, 81.42285912117055, 81.91601494792619, 81.91601494792619, 81.16087854698885, 81.16087854698885, 80.77150582629335, 80.77150582629335, 80.86800412914859, 80.86800412914859, 80.16569336114345, 80.16569336114345, 81.1902962425216, 81.1902962425216, 80.41776295560624, 80.41776295560624, 78.8078508176843, 78.8078508176843, 80.93137700655345, 80.93137700655345, 79.92107972369335, 79.92107972369335, 80.86237481933246, 80.86237481933246, 80.39867850866472, 80.39867850866472, 82.14474688427791, 82.14474688427791, 80.08133727591867, 80.08133727591867, 80.145810851385, 80.145810851385, 81.64329560853015, 81.64329560853015, 78.35259136363827, 78.35259136363827, 80.82639066493358, 80.82639066493358, 80.28861623964488, 80.28861623964488, 80.74868161194915, 80.74868161194915, 81.49668107547467, 81.49668107547467, 79.73486535961149, 79.73486535961149, 78.9098566783996, 78.9098566783996, 80.12634554123392, 80.12634554123392, 80.55958440002071, 80.55958440002071, 76.27348416076111, 76.27348416076111, 80.03529568891892, 80.03529568891892, 80.61230915259034, 80.61230915259034, 78.9036292621879, 78.9036292621879, 79.71527688459324, 79.71527688459324, 80.9935569659841, 80.9935569659841, 80.72253313622815, 80.72253313622815, 79.17483395121968, 79.17483395121968, 80.27697032213935, 80.27697032213935, 81.09531259003057, 81.09531259003057, 80.68463913242746, 80.68463913242746, 78.62248691499511, 78.62248691499511, 80.07326701878924, 80.07326701878924, 79.73828195821332, 79.73828195821332, 79.27384020987232, 79.27384020987232, 80.91237578582981, 80.91237578582981, 81.93931405628642, 81.93931405628642, 79.41986748863317, 79.41986748863317, 80.55468879738117, 80.55468879738117, 80.13124114387345, 80.13124114387345, 80.20397664033368, 80.20397664033368, 81.30105093267832, 81.30105093267832, 80.61855041762698, 80.61855041762698, 77.2884561492611, 78.87988865681015, 78.42804323200953, 78.42804323200953, 79.32269022207336, 79.32269022207336, 80.31080872629562, 80.31080872629562, 79.85904117189234, 79.85904117189234, 80.12585916730184, 80.12585916730184, 81.48968444657191, 81.48968444657191, 80.31355518826514, 80.31355518826514, 80.8591302529342, 80.8591302529342, 79.99548063973518, 79.99548063973518, 80.71984234363869, 80.71984234363869]}, "sampler_perf": {"mean_env_wait_ms": 11.332827189491649, "mean_raw_obs_processing_ms": 0.4986221736115549, "mean_inference_ms": 5.8559594514843285, "mean_action_processing_ms": 0.1393069218326977}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 172000, "timers": {"sample_time_ms": 4173.266, "sample_throughput": 958.482, "load_time_ms": 4.192, "load_throughput": 954172.553, "learn_time_ms": 7912.937, "learn_throughput": 505.501, "update_time_ms": 10.026}, "info": {"learner": {"ue": {"cur_kl_coeff": 0.00937500037252903, "cur_lr": 4.999999873689376e-05, "total_loss": 205.42861938476562, "policy_loss": -0.006209349259734154, "vf_loss": 205.4346923828125, "vf_explained_var": 0.03250603377819061, "kl": 0.013025633059442043, "entropy": 0.3620459735393524, "entropy_coeff": 0.0, "model": {}}}, "num_steps_sampled": 172000, "num_steps_trained": 172000}, "done": false, "episodes_total": 1720, "training_iteration": 43, "experiment_id": "f0134eced79d425ca17ebe3d2d0a9c1b", "date": "2021-03-09_10-51-56", "timestamp": 1615283516, "time_this_iter_s": 13.220070600509644, "time_total_s": 488.2095766067505, "pid": 4108, "hostname": "ray02", "node_ip": "131.234.28.177", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "env_config": {"episode_length": 100, "seed": null, "map": "150x100map", "bs_list": ["A", "B"], "ue_list": ["1", "2"], "rand_episodes": false, "new_ue_interval": null, "reward": "sum", "log_metrics": true}, "env": "MultiAgentMobileEnv", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": true, "log_level": "WARN", "callbacks": "<class 'deepcomp.util.callbacks.CustomMetricCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"ue": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Dict(connected:MultiBinary(2), dr:Box(0.0, 1.0, (2,), float32), ues_at_bs:Box(0.0, 1.0, (2,), float32), utility:Box(-1.0, 1.0, (1,), float32))", "Discrete(3)", {}]}, "policy_mapping_fn": "<function create_env_config.<locals>.<lambda> at 0x7f6b553b7dc0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 488.2095766067505, "timesteps_since_restore": 0, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 23.533333333333335, "ram_util_percent": 4.8}, "trial_id": "e359b_00000"}
{"episode_reward_max": 167.15309688649177, "episode_reward_min": 155.64828839002678, "episode_reward_mean": 161.6560428381947, "episode_len_mean": 100.0, "episodes_this_iter": 40, "policy_reward_min": {"ue": 77.2884561492611}, "policy_reward_max": {"ue": 83.57654844324566}, "policy_reward_mean": {"ue": 80.82802141909723}, "custom_metrics": {"sum_utility_mean": 16.729895198992587, "sum_utility_min": 10.206592306948258, "sum_utility_max": 18.926298722075135, "eps_sum_utility_mean": 1630.6692703786366, "eps_sum_utility_min": 1573.824965356432, "eps_sum_utility_max": 1682.3209600665223}, "hist_stats": {"episode_reward": [161.082621972651, 164.3129402557064, 162.2283772417171, 164.95646228662923, 163.74973036349235, 161.33703678128336, 166.91214413665148, 164.2894937685562, 161.1716216592531, 164.32544439495672, 164.69317059725654, 161.21611797131476, 162.55396415422354, 165.1397364998487, 166.68109393085047, 166.57948475968607, 162.71607720377148, 164.63302843742503, 163.89391224179127, 165.22154058293467, 162.38305610825392, 163.53057326762928, 161.26674169762106, 161.2604319335873, 166.1010614840361, 167.15309688649177, 162.19020834783413, 159.60451964036815, 159.67785689703754, 163.79366099803588, 163.60511044992495, 160.6976525727125, 164.61830998572475, 165.12711995280705, 162.43980724880538, 163.37192005014958, 164.25037982445866, 159.43380779047237, 162.24407424813018, 162.75636389966644, 158.54768041974495, 161.82475157166004, 163.87862811257304, 158.83973497726674, 161.10937759476258, 160.26248228774722, 160.40795328066753, 162.6021018653567, 161.23710083525413, 156.1683448060714, 156.8560864640193, 158.64538044414695, 160.6216174525913, 159.71808234378489, 160.25171833460388, 162.9793688931441, 160.62711037653065, 161.71826050586867, 159.99096127947064, 161.43968468727763, 160.34817283938787, 165.28676937914446, 161.37786930231067, 159.1332785583187, 160.01044921800667, 162.0794975753717, 162.0796975793055, 159.04074909765046, 160.37543196286282, 160.21929748226938, 161.44990281528857, 157.50417783067167, 159.4190893387722, 159.90370884145455, 161.60864947749735, 160.39606017072958, 155.64828839002678, 159.72601700013325, 161.58230794647312, 163.14414952486885, 159.8305660240676, 160.87208863595663, 159.3511465395602, 161.91874245323316, 162.2099348188657, 160.73174884842354, 159.61208701351353, 162.2258260223639, 160.81909473116866, 162.65247521187172, 157.1950951499647, 160.13946157311966, 162.5671463787827, 156.65157900706862, 162.23380998553927, 159.31051402246652, 163.61992761030405, 160.20783305185495, 162.20610931321346, 159.98935404130066], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_ue_reward": [80.54131098632537, 80.54131098632537, 82.15647012785303, 82.15647012785303, 81.11418862085843, 81.11418862085843, 82.4782311433145, 82.4782311433145, 81.87486518174597, 81.87486518174597, 80.66851839064151, 80.66851839064151, 83.45607206832557, 83.45607206832557, 82.14474688427791, 82.14474688427791, 80.58581082962635, 80.58581082962635, 82.16272219747826, 82.16272219747826, 82.3465852986281, 82.3465852986281, 80.60805898565712, 80.60805898565712, 81.27698207711161, 81.27698207711161, 82.56986824992414, 82.56986824992414, 83.34054696542512, 83.34054696542512, 83.28974237984282, 83.28974237984282, 81.35803860188548, 81.35803860188548, 82.31651421871234, 82.31651421871234, 81.94695612089552, 81.94695612089552, 82.6107702914672, 82.6107702914672, 81.19152805412689, 81.19152805412689, 81.7652866338145, 81.7652866338145, 80.63337084881036, 80.63337084881036, 80.63021596679341, 80.63021596679341, 83.05053074201793, 83.05053074201793, 83.57654844324566, 83.57654844324566, 81.0951041739169, 81.0951041739169, 80.56863913551096, 79.03588050485689, 79.83892844851864, 79.83892844851864, 81.89683049901782, 81.89683049901782, 81.8025552249624, 81.8025552249624, 80.3488262863561, 80.3488262863561, 82.3091549928622, 82.3091549928622, 82.56355997640344, 82.56355997640344, 81.21990362440255, 81.21990362440255, 81.68596002507462, 81.68596002507462, 82.12518991222927, 82.12518991222927, 79.71690389523611, 79.71690389523611, 81.12203712406497, 81.12203712406497, 81.3781819498331, 81.3781819498331, 79.27384020987232, 79.27384020987232, 80.91237578582981, 80.91237578582981, 81.93931405628642, 81.93931405628642, 79.41986748863317, 79.41986748863317, 80.55468879738117, 80.55468879738117, 80.13124114387345, 80.13124114387345, 80.20397664033368, 80.20397664033368, 81.30105093267832, 81.30105093267832, 80.61855041762698, 80.61855041762698, 77.2884561492611, 78.87988865681015, 78.42804323200953, 78.42804323200953, 79.32269022207336, 79.32269022207336, 80.31080872629562, 80.31080872629562, 79.85904117189234, 79.85904117189234, 80.12585916730184, 80.12585916730184, 81.48968444657191, 81.48968444657191, 80.31355518826514, 80.31355518826514, 80.8591302529342, 80.8591302529342, 79.99548063973518, 79.99548063973518, 80.71984234363869, 80.71984234363869, 80.1740864196938, 80.1740864196938, 82.64338468957202, 82.64338468957202, 80.68893465115518, 80.68893465115518, 79.56663927915923, 79.56663927915923, 80.00522460900318, 80.00522460900318, 81.03974878768578, 81.03974878768578, 81.03984878965264, 81.03984878965264, 79.52037454882519, 79.52037454882519, 80.18771598143132, 80.18771598143132, 80.10964874113456, 80.10964874113456, 80.72495140764426, 80.72495140764426, 79.51846823066279, 77.98570960000872, 79.70954466938595, 79.70954466938595, 79.9518544207272, 79.9518544207272, 80.1650242485699, 81.44362522892722, 80.1980300853647, 80.1980300853647, 77.82414419501325, 77.82414419501325, 79.86300850006657, 79.86300850006657, 80.79115397323655, 80.79115397323655, 81.5720747624342, 81.5720747624342, 79.91528301203365, 79.91528301203365, 80.43604431797823, 80.43604431797823, 79.67557326978005, 79.67557326978005, 80.95937122661645, 80.95937122661645, 81.10496740943267, 81.10496740943267, 80.36587442421171, 80.36587442421171, 79.80604350675662, 79.80604350675662, 81.11291301118175, 81.11291301118175, 79.77024687540548, 81.0488478557628, 81.32623760593572, 81.32623760593572, 78.5975475749822, 78.5975475749822, 80.06973078655965, 80.06973078655965, 81.28357318939129, 81.28357318939129, 78.32578950353431, 78.32578950353431, 81.11690499276949, 81.11690499276949, 79.65525701123325, 79.65525701123325, 81.80996380515195, 81.80996380515195, 80.10391652592727, 80.10391652592727, 81.10305465660655, 81.10305465660655, 79.99467702065024, 79.99467702065024]}, "sampler_perf": {"mean_env_wait_ms": 11.352778267810134, "mean_raw_obs_processing_ms": 0.5010692428224062, "mean_inference_ms": 5.880603699905601, "mean_action_processing_ms": 0.14027370641218537}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 176000, "timers": {"sample_time_ms": 4150.863, "sample_throughput": 963.655, "load_time_ms": 4.177, "load_throughput": 957614.585, "learn_time_ms": 7903.669, "learn_throughput": 506.094, "update_time_ms": 10.184}, "info": {"learner": {"ue": {"cur_kl_coeff": 0.00937500037252903, "cur_lr": 4.999999873689376e-05, "total_loss": 214.2910614013672, "policy_loss": -0.0019946976099163294, "vf_loss": 214.2930145263672, "vf_explained_var": 0.02783987671136856, "kl": 0.003912459127604961, "entropy": 0.3513178527355194, "entropy_coeff": 0.0, "model": {}}}, "num_steps_sampled": 176000, "num_steps_trained": 176000}, "done": false, "episodes_total": 1760, "training_iteration": 44, "experiment_id": "f0134eced79d425ca17ebe3d2d0a9c1b", "date": "2021-03-09_10-52-09", "timestamp": 1615283529, "time_this_iter_s": 12.531963109970093, "time_total_s": 500.7415397167206, "pid": 4108, "hostname": "ray02", "node_ip": "131.234.28.177", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "env_config": {"episode_length": 100, "seed": null, "map": "150x100map", "bs_list": ["A", "B"], "ue_list": ["1", "2"], "rand_episodes": false, "new_ue_interval": null, "reward": "sum", "log_metrics": true}, "env": "MultiAgentMobileEnv", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": true, "log_level": "WARN", "callbacks": "<class 'deepcomp.util.callbacks.CustomMetricCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"ue": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Dict(connected:MultiBinary(2), dr:Box(0.0, 1.0, (2,), float32), ues_at_bs:Box(0.0, 1.0, (2,), float32), utility:Box(-1.0, 1.0, (1,), float32))", "Discrete(3)", {}]}, "policy_mapping_fn": "<function create_env_config.<locals>.<lambda> at 0x7f6b553cc670>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 500.7415397167206, "timesteps_since_restore": 0, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 24.69375, "ram_util_percent": 4.8}, "trial_id": "e359b_00000"}
{"episode_reward_max": 167.3900241267459, "episode_reward_min": 156.65157900706862, "episode_reward_mean": 163.0593158850113, "episode_len_mean": 100.0, "episodes_this_iter": 40, "policy_reward_min": {"ue": 78.32578950353431}, "policy_reward_max": {"ue": 83.69501206337276}, "policy_reward_mean": {"ue": 81.52965794250551}, "custom_metrics": {"sum_utility_mean": 16.64907028230581, "sum_utility_min": 10.206592306948258, "sum_utility_max": 21.310345226162607, "eps_sum_utility_mean": 1646.840261567384, "eps_sum_utility_min": 1577.170962683768, "eps_sum_utility_max": 1690.0245747700035}, "hist_stats": {"episode_reward": [166.87142295438434, 166.19344512743947, 162.73267283957324, 162.35725840568398, 163.81898168826143, 162.87827784946177, 164.9157411043622, 161.62438203208637, 164.6483125666432, 163.04242399088082, 163.2071394184249, 166.474553382029, 161.6607159862159, 163.32532183342914, 163.07292704513674, 165.6796822547015, 164.34728364393715, 163.8690872870855, 164.42092615187653, 163.57109049093015, 161.8268534763189, 161.94195543195133, 162.97509407279745, 164.86785377302033, 164.42431717115682, 163.46776352562102, 163.580947683175, 164.07533493014313, 163.62480950493074, 165.29246230701716, 162.5146678603371, 164.67417732520966, 163.69478822183606, 165.31231777095337, 164.45841124862682, 163.59740456419104, 163.89829946992904, 165.74898112950643, 162.30918589873113, 167.3900241267459, 159.8305660240676, 160.87208863595663, 159.3511465395602, 161.91874245323316, 162.2099348188657, 160.73174884842354, 159.61208701351353, 162.2258260223639, 160.81909473116866, 162.65247521187172, 157.1950951499647, 160.13946157311966, 162.5671463787827, 156.65157900706862, 162.23380998553927, 159.31051402246652, 163.61992761030405, 160.20783305185495, 162.20610931321346, 159.98935404130066, 161.082621972651, 164.3129402557064, 162.2283772417171, 164.95646228662923, 163.74973036349235, 161.33703678128336, 166.91214413665148, 164.2894937685562, 161.1716216592531, 164.32544439495672, 164.69317059725654, 161.21611797131476, 162.55396415422354, 165.1397364998487, 166.68109393085047, 166.57948475968607, 162.71607720377148, 164.63302843742503, 163.89391224179127, 165.22154058293467, 162.38305610825392, 163.53057326762928, 161.26674169762106, 161.2604319335873, 166.1010614840361, 167.15309688649177, 162.19020834783413, 159.60451964036815, 159.67785689703754, 163.79366099803588, 163.60511044992495, 160.6976525727125, 164.61830998572475, 165.12711995280705, 162.43980724880538, 163.37192005014958, 164.25037982445866, 159.43380779047237, 162.24407424813018, 162.75636389966644], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_ue_reward": [83.43571147719196, 83.43571147719196, 83.09672256371962, 83.09672256371962, 81.3663364197865, 81.3663364197865, 81.17862920284198, 81.17862920284198, 81.90949084413057, 81.90949084413057, 81.43913892473077, 81.43913892473077, 82.45787055218092, 82.45787055218092, 80.81219101604304, 80.81219101604304, 82.32415628332144, 82.32415628332144, 81.52121199544017, 81.52121199544017, 81.60356970921235, 81.60356970921235, 83.23727669101436, 83.23727669101436, 80.8303579931078, 80.8303579931078, 81.66266091671437, 81.66266091671437, 81.53646352256824, 81.53646352256824, 82.8398411273506, 82.8398411273506, 82.17364182196842, 82.17364182196842, 81.93454364354267, 81.93454364354267, 82.21046307593811, 82.21046307593811, 81.78554524546502, 81.78554524546502, 80.91342673815926, 80.91342673815926, 80.97097771597548, 80.97097771597548, 81.48754703639855, 81.48754703639855, 82.43392688651, 82.43392688651, 82.21215858557822, 82.21215858557822, 81.73388176281036, 81.73388176281036, 81.79047384158734, 81.79047384158734, 82.03766746507151, 82.03766746507151, 81.81240475246528, 81.81240475246528, 82.64623115350845, 82.64623115350845, 81.25733393016843, 81.25733393016843, 82.3370886626046, 82.3370886626046, 81.84739411091782, 81.84739411091782, 82.65615888547661, 82.65615888547661, 82.22920562431325, 82.22920562431325, 81.79870228209538, 81.79870228209538, 81.94914973496437, 81.94914973496437, 82.87449056475302, 82.87449056475302, 81.15459294936544, 81.15459294936544, 83.69501206337276, 83.69501206337276, 79.91528301203365, 79.91528301203365, 80.43604431797823, 80.43604431797823, 79.67557326978005, 79.67557326978005, 80.95937122661645, 80.95937122661645, 81.10496740943267, 81.10496740943267, 80.36587442421171, 80.36587442421171, 79.80604350675662, 79.80604350675662, 81.11291301118175, 81.11291301118175, 79.77024687540548, 81.0488478557628, 81.32623760593572, 81.32623760593572, 78.5975475749822, 78.5975475749822, 80.06973078655965, 80.06973078655965, 81.28357318939129, 81.28357318939129, 78.32578950353431, 78.32578950353431, 81.11690499276949, 81.11690499276949, 79.65525701123325, 79.65525701123325, 81.80996380515195, 81.80996380515195, 80.10391652592727, 80.10391652592727, 81.10305465660655, 81.10305465660655, 79.99467702065024, 79.99467702065024, 80.54131098632537, 80.54131098632537, 82.15647012785303, 82.15647012785303, 81.11418862085843, 81.11418862085843, 82.4782311433145, 82.4782311433145, 81.87486518174597, 81.87486518174597, 80.66851839064151, 80.66851839064151, 83.45607206832557, 83.45607206832557, 82.14474688427791, 82.14474688427791, 80.58581082962635, 80.58581082962635, 82.16272219747826, 82.16272219747826, 82.3465852986281, 82.3465852986281, 80.60805898565712, 80.60805898565712, 81.27698207711161, 81.27698207711161, 82.56986824992414, 82.56986824992414, 83.34054696542512, 83.34054696542512, 83.28974237984282, 83.28974237984282, 81.35803860188548, 81.35803860188548, 82.31651421871234, 82.31651421871234, 81.94695612089552, 81.94695612089552, 82.6107702914672, 82.6107702914672, 81.19152805412689, 81.19152805412689, 81.7652866338145, 81.7652866338145, 80.63337084881036, 80.63337084881036, 80.63021596679341, 80.63021596679341, 83.05053074201793, 83.05053074201793, 83.57654844324566, 83.57654844324566, 81.0951041739169, 81.0951041739169, 80.56863913551096, 79.03588050485689, 79.83892844851864, 79.83892844851864, 81.89683049901782, 81.89683049901782, 81.8025552249624, 81.8025552249624, 80.3488262863561, 80.3488262863561, 82.3091549928622, 82.3091549928622, 82.56355997640344, 82.56355997640344, 81.21990362440255, 81.21990362440255, 81.68596002507462, 81.68596002507462, 82.12518991222927, 82.12518991222927, 79.71690389523611, 79.71690389523611, 81.12203712406497, 81.12203712406497, 81.3781819498331, 81.3781819498331]}, "sampler_perf": {"mean_env_wait_ms": 11.387173357228527, "mean_raw_obs_processing_ms": 0.5031331156167258, "mean_inference_ms": 5.9024730099877525, "mean_action_processing_ms": 0.1411772244641546}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 180000, "timers": {"sample_time_ms": 4190.603, "sample_throughput": 954.517, "load_time_ms": 4.141, "load_throughput": 965884.236, "learn_time_ms": 7885.128, "learn_throughput": 507.284, "update_time_ms": 11.634}, "info": {"learner": {"ue": {"cur_kl_coeff": 0.004687500186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 213.71482849121094, "policy_loss": -0.0005959593108855188, "vf_loss": 213.71539306640625, "vf_explained_var": 0.03452835977077484, "kl": 0.005640028975903988, "entropy": 0.3406318724155426, "entropy_coeff": 0.0, "model": {}}}, "num_steps_sampled": 180000, "num_steps_trained": 180000}, "done": false, "episodes_total": 1800, "training_iteration": 45, "experiment_id": "f0134eced79d425ca17ebe3d2d0a9c1b", "date": "2021-03-09_10-52-21", "timestamp": 1615283541, "time_this_iter_s": 12.640689134597778, "time_total_s": 513.3822288513184, "pid": 4108, "hostname": "ray02", "node_ip": "131.234.28.177", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "env_config": {"episode_length": 100, "seed": null, "map": "150x100map", "bs_list": ["A", "B"], "ue_list": ["1", "2"], "rand_episodes": false, "new_ue_interval": null, "reward": "sum", "log_metrics": true}, "env": "MultiAgentMobileEnv", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": true, "log_level": "WARN", "callbacks": "<class 'deepcomp.util.callbacks.CustomMetricCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"ue": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Dict(connected:MultiBinary(2), dr:Box(0.0, 1.0, (2,), float32), ues_at_bs:Box(0.0, 1.0, (2,), float32), utility:Box(-1.0, 1.0, (1,), float32))", "Discrete(3)", {}]}, "policy_mapping_fn": "<function create_env_config.<locals>.<lambda> at 0x7f6b553b7d30>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 513.3822288513184, "timesteps_since_restore": 0, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 25.270588235294117, "ram_util_percent": 4.8}, "trial_id": "e359b_00000"}
{"episode_reward_max": 167.90156873200152, "episode_reward_min": 159.43380779047237, "episode_reward_mean": 163.79507728861938, "episode_len_mean": 100.0, "episodes_this_iter": 40, "policy_reward_min": {"ue": 79.03588050485689}, "policy_reward_max": {"ue": 83.95078436600062}, "policy_reward_mean": {"ue": 81.89753864430955}, "custom_metrics": {"sum_utility_mean": 16.712036775905958, "sum_utility_min": 10.206592306948258, "sum_utility_max": 21.310345226162607, "eps_sum_utility_mean": 1659.0132303783691, "eps_sum_utility_min": 1613.9455862397535, "eps_sum_utility_max": 1698.1525508980524}, "hist_stats": {"episode_reward": [162.89322400274585, 166.06479449087846, 163.12049907875235, 163.63742605197234, 163.4851495594982, 167.19392940751902, 163.58366061714634, 167.90156873200152, 164.99471482162244, 161.82108778062565, 162.44943809012136, 164.23239856359777, 163.52258930445385, 162.15826733366606, 165.24783480380967, 163.27643829322983, 163.4198073814914, 162.87461405842754, 165.94860088498166, 165.56242723576696, 161.13995063801622, 166.85577710661448, 163.41485447583585, 163.56930388399775, 164.62864120928737, 165.7811062502547, 166.32195876600645, 165.9067069509166, 162.88074147267247, 163.7709603399515, 162.50347522767044, 164.06599303955858, 165.27697817386542, 165.54583159996508, 161.83741347049585, 162.02360564568357, 165.9907449125928, 165.42821486247897, 160.79628273201325, 164.48766878326478, 162.38305610825392, 163.53057326762928, 161.26674169762106, 161.2604319335873, 166.1010614840361, 167.15309688649177, 162.19020834783413, 159.60451964036815, 159.67785689703754, 163.79366099803588, 163.60511044992495, 160.6976525727125, 164.61830998572475, 165.12711995280705, 162.43980724880538, 163.37192005014958, 164.25037982445866, 159.43380779047237, 162.24407424813018, 162.75636389966644, 166.87142295438434, 166.19344512743947, 162.73267283957324, 162.35725840568398, 163.81898168826143, 162.87827784946177, 164.9157411043622, 161.62438203208637, 164.6483125666432, 163.04242399088082, 163.2071394184249, 166.474553382029, 161.6607159862159, 163.32532183342914, 163.07292704513674, 165.6796822547015, 164.34728364393715, 163.8690872870855, 164.42092615187653, 163.57109049093015, 161.8268534763189, 161.94195543195133, 162.97509407279745, 164.86785377302033, 164.42431717115682, 163.46776352562102, 163.580947683175, 164.07533493014313, 163.62480950493074, 165.29246230701716, 162.5146678603371, 164.67417732520966, 163.69478822183606, 165.31231777095337, 164.45841124862682, 163.59740456419104, 163.89829946992904, 165.74898112950643, 162.30918589873113, 167.3900241267459], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_ue_reward": [81.44661200137269, 81.44661200137269, 83.03239724543897, 83.03239724543897, 81.56024953937597, 81.56024953937597, 81.81871302598597, 81.81871302598597, 81.74257477974888, 81.74257477974888, 83.59696470375933, 83.59696470375933, 81.791830308573, 81.791830308573, 83.95078436600062, 83.95078436600062, 82.49735741081116, 82.49735741081116, 80.91054389031271, 80.91054389031271, 81.22471904506055, 81.22471904506055, 82.11619928179871, 82.11619928179871, 81.76129465222675, 81.76129465222675, 81.07913366683293, 81.07913366683293, 82.62391740190468, 82.62391740190468, 81.63821914661476, 81.63821914661476, 81.70990369074555, 81.70990369074555, 81.43730702921364, 81.43730702921364, 82.97430044249062, 82.97430044249062, 82.78121361788337, 82.78121361788337, 80.569975319008, 80.569975319008, 83.42788855330703, 83.42788855330703, 81.70742723791774, 81.70742723791774, 81.78465194199872, 81.78465194199872, 82.3143206046435, 82.3143206046435, 82.89055312512723, 82.89055312512723, 83.16097938300298, 83.16097938300298, 82.95335347545807, 82.95335347545807, 81.44037073633608, 81.44037073633608, 81.88548016997562, 81.88548016997562, 81.25173761383512, 81.25173761383512, 82.03299651977916, 82.03299651977916, 82.63848908693248, 82.63848908693248, 82.77291579998236, 82.77291579998236, 80.91870673524778, 80.91870673524778, 81.01180282284157, 81.01180282284157, 82.99537245629617, 82.99537245629617, 82.71410743123927, 82.71410743123927, 81.16452068133358, 79.63176205067951, 82.24383439163219, 82.24383439163219, 81.19152805412689, 81.19152805412689, 81.7652866338145, 81.7652866338145, 80.63337084881036, 80.63337084881036, 80.63021596679341, 80.63021596679341, 83.05053074201793, 83.05053074201793, 83.57654844324566, 83.57654844324566, 81.0951041739169, 81.0951041739169, 80.56863913551096, 79.03588050485689, 79.83892844851864, 79.83892844851864, 81.89683049901782, 81.89683049901782, 81.8025552249624, 81.8025552249624, 80.3488262863561, 80.3488262863561, 82.3091549928622, 82.3091549928622, 82.56355997640344, 82.56355997640344, 81.21990362440255, 81.21990362440255, 81.68596002507462, 81.68596002507462, 82.12518991222927, 82.12518991222927, 79.71690389523611, 79.71690389523611, 81.12203712406497, 81.12203712406497, 81.3781819498331, 81.3781819498331, 83.43571147719196, 83.43571147719196, 83.09672256371962, 83.09672256371962, 81.3663364197865, 81.3663364197865, 81.17862920284198, 81.17862920284198, 81.90949084413057, 81.90949084413057, 81.43913892473077, 81.43913892473077, 82.45787055218092, 82.45787055218092, 80.81219101604304, 80.81219101604304, 82.32415628332144, 82.32415628332144, 81.52121199544017, 81.52121199544017, 81.60356970921235, 81.60356970921235, 83.23727669101436, 83.23727669101436, 80.8303579931078, 80.8303579931078, 81.66266091671437, 81.66266091671437, 81.53646352256824, 81.53646352256824, 82.8398411273506, 82.8398411273506, 82.17364182196842, 82.17364182196842, 81.93454364354267, 81.93454364354267, 82.21046307593811, 82.21046307593811, 81.78554524546502, 81.78554524546502, 80.91342673815926, 80.91342673815926, 80.97097771597548, 80.97097771597548, 81.48754703639855, 81.48754703639855, 82.43392688651, 82.43392688651, 82.21215858557822, 82.21215858557822, 81.73388176281036, 81.73388176281036, 81.79047384158734, 81.79047384158734, 82.03766746507151, 82.03766746507151, 81.81240475246528, 81.81240475246528, 82.64623115350845, 82.64623115350845, 81.25733393016843, 81.25733393016843, 82.3370886626046, 82.3370886626046, 81.84739411091782, 81.84739411091782, 82.65615888547661, 82.65615888547661, 82.22920562431325, 82.22920562431325, 81.79870228209538, 81.79870228209538, 81.94914973496437, 81.94914973496437, 82.87449056475302, 82.87449056475302, 81.15459294936544, 81.15459294936544, 83.69501206337276, 83.69501206337276]}, "sampler_perf": {"mean_env_wait_ms": 11.416503664601496, "mean_raw_obs_processing_ms": 0.5057075040831571, "mean_inference_ms": 5.9228566424429, "mean_action_processing_ms": 0.14138697567158967}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 184000, "timers": {"sample_time_ms": 4182.093, "sample_throughput": 956.459, "load_time_ms": 4.106, "load_throughput": 974196.126, "learn_time_ms": 7864.799, "learn_throughput": 508.595, "update_time_ms": 11.585}, "info": {"learner": {"ue": {"cur_kl_coeff": 0.004687500186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 215.8289337158203, "policy_loss": -0.0025738347321748734, "vf_loss": 215.83148193359375, "vf_explained_var": 0.027374224737286568, "kl": 0.0059098671190440655, "entropy": 0.3257955312728882, "entropy_coeff": 0.0, "model": {}}}, "num_steps_sampled": 184000, "num_steps_trained": 184000}, "done": false, "episodes_total": 1840, "training_iteration": 46, "experiment_id": "f0134eced79d425ca17ebe3d2d0a9c1b", "date": "2021-03-09_10-52-34", "timestamp": 1615283554, "time_this_iter_s": 12.38611650466919, "time_total_s": 525.7683453559875, "pid": 4108, "hostname": "ray02", "node_ip": "131.234.28.177", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "env_config": {"episode_length": 100, "seed": null, "map": "150x100map", "bs_list": ["A", "B"], "ue_list": ["1", "2"], "rand_episodes": false, "new_ue_interval": null, "reward": "sum", "log_metrics": true}, "env": "MultiAgentMobileEnv", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": true, "log_level": "WARN", "callbacks": "<class 'deepcomp.util.callbacks.CustomMetricCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"ue": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Dict(connected:MultiBinary(2), dr:Box(0.0, 1.0, (2,), float32), ues_at_bs:Box(0.0, 1.0, (2,), float32), utility:Box(-1.0, 1.0, (1,), float32))", "Discrete(3)", {}]}, "policy_mapping_fn": "<function create_env_config.<locals>.<lambda> at 0x7f6b55430670>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 525.7683453559875, "timesteps_since_restore": 0, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 24.2764705882353, "ram_util_percent": 4.8}, "trial_id": "e359b_00000"}
{"episode_reward_max": 168.67724658334834, "episode_reward_min": 160.79628273201325, "episode_reward_mean": 164.67378625750405, "episode_len_mean": 100.0, "episodes_this_iter": 40, "policy_reward_min": {"ue": 79.63176205067951}, "policy_reward_max": {"ue": 84.338623291674}, "policy_reward_mean": {"ue": 82.33689312875185}, "custom_metrics": {"sum_utility_mean": 16.845473844646747, "sum_utility_min": 10.206592306948258, "sum_utility_max": 21.310345226162607, "eps_sum_utility_mean": 1666.3324554073472, "eps_sum_utility_min": 1613.9455862397535, "eps_sum_utility_max": 1716.0818685226416}, "hist_stats": {"episode_reward": [165.28391662135635, 168.4716334305965, 166.09016273113969, 168.67724658334834, 164.6054383210742, 166.8055820598314, 165.80509777975203, 164.18008474079647, 166.15717813428176, 167.1709134517082, 167.7390063677592, 162.29939751927412, 166.59515299941842, 164.65561273268605, 163.3971067234068, 163.185160345628, 161.3966280919194, 166.3177143844494, 165.93553502324568, 164.3945393107955, 168.61097700927206, 164.37158042765537, 165.80206847902343, 163.13040162279134, 168.27764061602852, 163.8557433479084, 163.59236406239285, 168.66512577182692, 165.58559486269047, 165.0442547429289, 167.04753101852896, 166.98218884052227, 163.58636175082108, 167.07081500827604, 168.00173237961423, 164.98503997916708, 161.7697011140075, 164.15707567929496, 165.7873500273231, 166.60164213221486, 161.8268534763189, 161.94195543195133, 162.97509407279745, 164.86785377302033, 164.42431717115682, 163.46776352562102, 163.580947683175, 164.07533493014313, 163.62480950493074, 165.29246230701716, 162.5146678603371, 164.67417732520966, 163.69478822183606, 165.31231777095337, 164.45841124862682, 163.59740456419104, 163.89829946992904, 165.74898112950643, 162.30918589873113, 167.3900241267459, 162.89322400274585, 166.06479449087846, 163.12049907875235, 163.63742605197234, 163.4851495594982, 167.19392940751902, 163.58366061714634, 167.90156873200152, 164.99471482162244, 161.82108778062565, 162.44943809012136, 164.23239856359777, 163.52258930445385, 162.15826733366606, 165.24783480380967, 163.27643829322983, 163.4198073814914, 162.87461405842754, 165.94860088498166, 165.56242723576696, 161.13995063801622, 166.85577710661448, 163.41485447583585, 163.56930388399775, 164.62864120928737, 165.7811062502547, 166.32195876600645, 165.9067069509166, 162.88074147267247, 163.7709603399515, 162.50347522767044, 164.06599303955858, 165.27697817386542, 165.54583159996508, 161.83741347049585, 162.02360564568357, 165.9907449125928, 165.42821486247897, 160.79628273201325, 164.48766878326478], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_ue_reward": [82.64195831067799, 82.64195831067799, 84.23581671529803, 84.23581671529803, 83.04508136556957, 83.04508136556957, 84.338623291674, 84.338623291674, 82.3027191605368, 82.3027191605368, 83.4027910299155, 83.4027910299155, 82.90254888987579, 82.90254888987579, 82.09004237039811, 82.09004237039811, 83.07858906714068, 83.07858906714068, 83.58545672585397, 83.58545672585397, 83.86950318387949, 83.86950318387949, 81.14969875963698, 81.14969875963698, 83.29757649970902, 83.29757649970902, 82.32780636634278, 82.32780636634278, 81.69855336170336, 81.69855336170336, 81.59258017281378, 81.59258017281378, 80.69831404595953, 80.69831404595953, 82.51955670204583, 83.79815768240316, 82.9677675116227, 82.9677675116227, 82.19726965539755, 82.19726965539755, 84.30548850463582, 84.30548850463582, 82.18579021382754, 82.18579021382754, 82.90103423951155, 82.90103423951155, 81.56520081139561, 81.56520081139561, 84.13882030801405, 84.13882030801405, 81.92787167395399, 81.92787167395399, 81.79618203119621, 81.79618203119621, 84.3325628859132, 84.3325628859132, 82.79279743134511, 82.79279743134511, 82.52212737146426, 82.52212737146426, 83.5237655092643, 83.5237655092643, 83.49109442026094, 83.49109442026094, 81.79318087541036, 81.79318087541036, 83.53540750413777, 83.53540750413777, 84.00086618980696, 84.00086618980696, 82.49251998958334, 82.49251998958334, 80.2455500668249, 81.52415104718226, 82.87425409342183, 81.28282158587277, 82.8936750136614, 82.8936750136614, 83.30082106610729, 83.30082106610729, 80.91342673815926, 80.91342673815926, 80.97097771597548, 80.97097771597548, 81.48754703639855, 81.48754703639855, 82.43392688651, 82.43392688651, 82.21215858557822, 82.21215858557822, 81.73388176281036, 81.73388176281036, 81.79047384158734, 81.79047384158734, 82.03766746507151, 82.03766746507151, 81.81240475246528, 81.81240475246528, 82.64623115350845, 82.64623115350845, 81.25733393016843, 81.25733393016843, 82.3370886626046, 82.3370886626046, 81.84739411091782, 81.84739411091782, 82.65615888547661, 82.65615888547661, 82.22920562431325, 82.22920562431325, 81.79870228209538, 81.79870228209538, 81.94914973496437, 81.94914973496437, 82.87449056475302, 82.87449056475302, 81.15459294936544, 81.15459294936544, 83.69501206337276, 83.69501206337276, 81.44661200137269, 81.44661200137269, 83.03239724543897, 83.03239724543897, 81.56024953937597, 81.56024953937597, 81.81871302598597, 81.81871302598597, 81.74257477974888, 81.74257477974888, 83.59696470375933, 83.59696470375933, 81.791830308573, 81.791830308573, 83.95078436600062, 83.95078436600062, 82.49735741081116, 82.49735741081116, 80.91054389031271, 80.91054389031271, 81.22471904506055, 81.22471904506055, 82.11619928179871, 82.11619928179871, 81.76129465222675, 81.76129465222675, 81.07913366683293, 81.07913366683293, 82.62391740190468, 82.62391740190468, 81.63821914661476, 81.63821914661476, 81.70990369074555, 81.70990369074555, 81.43730702921364, 81.43730702921364, 82.97430044249062, 82.97430044249062, 82.78121361788337, 82.78121361788337, 80.569975319008, 80.569975319008, 83.42788855330703, 83.42788855330703, 81.70742723791774, 81.70742723791774, 81.78465194199872, 81.78465194199872, 82.3143206046435, 82.3143206046435, 82.89055312512723, 82.89055312512723, 83.16097938300298, 83.16097938300298, 82.95335347545807, 82.95335347545807, 81.44037073633608, 81.44037073633608, 81.88548016997562, 81.88548016997562, 81.25173761383512, 81.25173761383512, 82.03299651977916, 82.03299651977916, 82.63848908693248, 82.63848908693248, 82.77291579998236, 82.77291579998236, 80.91870673524778, 80.91870673524778, 81.01180282284157, 81.01180282284157, 82.99537245629617, 82.99537245629617, 82.71410743123927, 82.71410743123927, 81.16452068133358, 79.63176205067951, 82.24383439163219, 82.24383439163219]}, "sampler_perf": {"mean_env_wait_ms": 11.4385366835345, "mean_raw_obs_processing_ms": 0.5088077562477984, "mean_inference_ms": 5.940612298924955, "mean_action_processing_ms": 0.14148225015741078}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 188000, "timers": {"sample_time_ms": 4183.942, "sample_throughput": 956.036, "load_time_ms": 4.133, "load_throughput": 967856.747, "learn_time_ms": 7893.475, "learn_throughput": 506.748, "update_time_ms": 12.226}, "info": {"learner": {"ue": {"cur_kl_coeff": 0.004687500186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 219.6983642578125, "policy_loss": -0.0009346979204565287, "vf_loss": 219.69927978515625, "vf_explained_var": 0.0291298758238554, "kl": 0.002118297154083848, "entropy": 0.32496535778045654, "entropy_coeff": 0.0, "model": {}}}, "num_steps_sampled": 188000, "num_steps_trained": 188000}, "done": false, "episodes_total": 1880, "training_iteration": 47, "experiment_id": "f0134eced79d425ca17ebe3d2d0a9c1b", "date": "2021-03-09_10-52-46", "timestamp": 1615283566, "time_this_iter_s": 12.475186586380005, "time_total_s": 538.2435319423676, "pid": 4108, "hostname": "ray02", "node_ip": "131.234.28.177", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "env_config": {"episode_length": 100, "seed": null, "map": "150x100map", "bs_list": ["A", "B"], "ue_list": ["1", "2"], "rand_episodes": false, "new_ue_interval": null, "reward": "sum", "log_metrics": true}, "env": "MultiAgentMobileEnv", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": true, "log_level": "WARN", "callbacks": "<class 'deepcomp.util.callbacks.CustomMetricCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"ue": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Dict(connected:MultiBinary(2), dr:Box(0.0, 1.0, (2,), float32), ues_at_bs:Box(0.0, 1.0, (2,), float32), utility:Box(-1.0, 1.0, (1,), float32))", "Discrete(3)", {}]}, "policy_mapping_fn": "<function create_env_config.<locals>.<lambda> at 0x7f6b553d5670>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 538.2435319423676, "timesteps_since_restore": 0, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 24.111764705882354, "ram_util_percent": 4.8}, "trial_id": "e359b_00000"}
{"episode_reward_max": 168.67724658334834, "episode_reward_min": 160.79628273201325, "episode_reward_mean": 165.33409657452674, "episode_len_mean": 100.0, "episodes_this_iter": 40, "policy_reward_min": {"ue": 79.63176205067951}, "policy_reward_max": {"ue": 84.338623291674}, "policy_reward_mean": {"ue": 82.66704828726319}, "custom_metrics": {"sum_utility_mean": 16.6820625805059, "sum_utility_min": 10.206592306948258, "sum_utility_max": 21.310345226162607, "eps_sum_utility_mean": 1670.0293299759694, "eps_sum_utility_min": 1613.9455862397535, "eps_sum_utility_max": 1716.0818685226416}, "hist_stats": {"episode_reward": [162.4788995837256, 168.10426894684844, 165.3990026796356, 167.0806998981705, 168.46550601635164, 163.7488029674227, 165.88832470818193, 166.42356793717096, 166.16423294459628, 164.04413218140132, 163.98975571726282, 164.50964600424567, 165.32564884080347, 167.4226273288695, 168.00173237961434, 165.2471549617095, 164.35135450531754, 163.53164731074844, 166.7947727548937, 165.06085037873083, 164.90255887980283, 163.70267171954129, 168.21137104195225, 168.05364522054208, 166.4592004400231, 165.78122261307817, 166.59551471797, 166.43308637069595, 167.83107471343635, 165.19375124543535, 163.8686092057104, 167.12092138988527, 165.29016039842458, 163.87250069832828, 164.73575920174443, 164.92403562744636, 163.9836283030179, 165.62256939559853, 167.14084205800208, 167.3394004004395, 161.13995063801622, 166.85577710661448, 163.41485447583585, 163.56930388399775, 164.62864120928737, 165.7811062502547, 166.32195876600645, 165.9067069509166, 162.88074147267247, 163.7709603399515, 162.50347522767044, 164.06599303955858, 165.27697817386542, 165.54583159996508, 161.83741347049585, 162.02360564568357, 165.9907449125928, 165.42821486247897, 160.79628273201325, 164.48766878326478, 165.28391662135635, 168.4716334305965, 166.09016273113969, 168.67724658334834, 164.6054383210742, 166.8055820598314, 165.80509777975203, 164.18008474079647, 166.15717813428176, 167.1709134517082, 167.7390063677592, 162.29939751927412, 166.59515299941842, 164.65561273268605, 163.3971067234068, 163.185160345628, 161.3966280919194, 166.3177143844494, 165.93553502324568, 164.3945393107955, 168.61097700927206, 164.37158042765537, 165.80206847902343, 163.13040162279134, 168.27764061602852, 163.8557433479084, 163.59236406239285, 168.66512577182692, 165.58559486269047, 165.0442547429289, 167.04753101852896, 166.98218884052227, 163.58636175082108, 167.07081500827604, 168.00173237961423, 164.98503997916708, 161.7697011140075, 164.15707567929496, 165.7873500273231, 166.60164213221486], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_ue_reward": [81.23944979186258, 81.23944979186258, 84.05213447342403, 84.05213447342403, 82.69950133981754, 82.69950133981754, 83.54034994908507, 83.54034994908507, 84.2327530081756, 84.2327530081756, 81.87440148371115, 81.87440148371115, 82.94416235409084, 82.94416235409084, 83.21178396858527, 83.21178396858527, 83.08211647229791, 83.08211647229791, 82.02206609070039, 82.02206609070039, 81.99487785863123, 81.99487785863123, 82.25482300212269, 82.25482300212269, 82.66282442040152, 82.66282442040152, 83.71131366443457, 83.71131366443457, 84.00086618980694, 84.00086618980694, 82.62357748085455, 82.62357748085455, 82.17567725265867, 82.17567725265867, 81.76582365537404, 81.76582365537404, 83.39738637744662, 83.39738637744662, 82.53042518936526, 82.53042518936526, 82.45127943990124, 82.45127943990124, 81.85133585977049, 81.85133585977049, 84.10568552097588, 84.10568552097588, 84.02682261027081, 84.02682261027081, 83.22960022001132, 83.22960022001132, 82.89061130653899, 82.89061130653899, 83.29775735898487, 83.29775735898487, 83.2165431853478, 83.2165431853478, 83.91553735671802, 83.91553735671802, 82.59687562271746, 82.59687562271746, 81.93430460285508, 81.93430460285508, 83.56046069494252, 83.56046069494252, 82.64508019921212, 82.64508019921212, 81.936250349164, 81.936250349164, 82.36787960087197, 82.36787960087197, 82.46201781372291, 82.46201781372291, 81.9918141515088, 81.9918141515088, 82.8112846977991, 82.8112846977991, 83.5704210290008, 83.5704210290008, 83.66970020021952, 83.66970020021952, 80.569975319008, 80.569975319008, 83.42788855330703, 83.42788855330703, 81.70742723791774, 81.70742723791774, 81.78465194199872, 81.78465194199872, 82.3143206046435, 82.3143206046435, 82.89055312512723, 82.89055312512723, 83.16097938300298, 83.16097938300298, 82.95335347545807, 82.95335347545807, 81.44037073633608, 81.44037073633608, 81.88548016997562, 81.88548016997562, 81.25173761383512, 81.25173761383512, 82.03299651977916, 82.03299651977916, 82.63848908693248, 82.63848908693248, 82.77291579998236, 82.77291579998236, 80.91870673524778, 80.91870673524778, 81.01180282284157, 81.01180282284157, 82.99537245629617, 82.99537245629617, 82.71410743123927, 82.71410743123927, 81.16452068133358, 79.63176205067951, 82.24383439163219, 82.24383439163219, 82.64195831067799, 82.64195831067799, 84.23581671529803, 84.23581671529803, 83.04508136556957, 83.04508136556957, 84.338623291674, 84.338623291674, 82.3027191605368, 82.3027191605368, 83.4027910299155, 83.4027910299155, 82.90254888987579, 82.90254888987579, 82.09004237039811, 82.09004237039811, 83.07858906714068, 83.07858906714068, 83.58545672585397, 83.58545672585397, 83.86950318387949, 83.86950318387949, 81.14969875963698, 81.14969875963698, 83.29757649970902, 83.29757649970902, 82.32780636634278, 82.32780636634278, 81.69855336170336, 81.69855336170336, 81.59258017281378, 81.59258017281378, 80.69831404595953, 80.69831404595953, 82.51955670204583, 83.79815768240316, 82.9677675116227, 82.9677675116227, 82.19726965539755, 82.19726965539755, 84.30548850463582, 84.30548850463582, 82.18579021382754, 82.18579021382754, 82.90103423951155, 82.90103423951155, 81.56520081139561, 81.56520081139561, 84.13882030801405, 84.13882030801405, 81.92787167395399, 81.92787167395399, 81.79618203119621, 81.79618203119621, 84.3325628859132, 84.3325628859132, 82.79279743134511, 82.79279743134511, 82.52212737146426, 82.52212737146426, 83.5237655092643, 83.5237655092643, 83.49109442026094, 83.49109442026094, 81.79318087541036, 81.79318087541036, 83.53540750413777, 83.53540750413777, 84.00086618980696, 84.00086618980696, 82.49251998958334, 82.49251998958334, 80.2455500668249, 81.52415104718226, 82.87425409342183, 81.28282158587277, 82.8936750136614, 82.8936750136614, 83.30082106610729, 83.30082106610729]}, "sampler_perf": {"mean_env_wait_ms": 11.46480763132916, "mean_raw_obs_processing_ms": 0.5119323066992562, "mean_inference_ms": 5.95702007528027, "mean_action_processing_ms": 0.14228131460562637}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 192000, "timers": {"sample_time_ms": 4212.933, "sample_throughput": 949.457, "load_time_ms": 4.302, "load_throughput": 929908.102, "learn_time_ms": 7854.205, "learn_throughput": 509.281, "update_time_ms": 21.696}, "info": {"learner": {"ue": {"cur_kl_coeff": 0.0023437500931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 217.92747497558594, "policy_loss": -0.0013616419164463878, "vf_loss": 217.9288330078125, "vf_explained_var": 0.03287482634186745, "kl": 0.004437219817191362, "entropy": 0.3140110671520233, "entropy_coeff": 0.0, "model": {}}}, "num_steps_sampled": 192000, "num_steps_trained": 192000}, "done": false, "episodes_total": 1920, "training_iteration": 48, "experiment_id": "f0134eced79d425ca17ebe3d2d0a9c1b", "date": "2021-03-09_10-52-59", "timestamp": 1615283579, "time_this_iter_s": 12.790773153305054, "time_total_s": 551.0343050956726, "pid": 4108, "hostname": "ray02", "node_ip": "131.234.28.177", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "env_config": {"episode_length": 100, "seed": null, "map": "150x100map", "bs_list": ["A", "B"], "ue_list": ["1", "2"], "rand_episodes": false, "new_ue_interval": null, "reward": "sum", "log_metrics": true}, "env": "MultiAgentMobileEnv", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": true, "log_level": "WARN", "callbacks": "<class 'deepcomp.util.callbacks.CustomMetricCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"ue": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Dict(connected:MultiBinary(2), dr:Box(0.0, 1.0, (2,), float32), ues_at_bs:Box(0.0, 1.0, (2,), float32), utility:Box(-1.0, 1.0, (1,), float32))", "Discrete(3)", {}]}, "policy_mapping_fn": "<function create_env_config.<locals>.<lambda> at 0x7f6b553b74c0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 551.0343050956726, "timesteps_since_restore": 0, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 24.66111111111111, "ram_util_percent": 4.8}, "trial_id": "e359b_00000"}
{"episode_reward_max": 168.89301265993117, "episode_reward_min": 157.30878935049049, "episode_reward_mean": 165.46902639136272, "episode_len_mean": 100.0, "episodes_this_iter": 40, "policy_reward_min": {"ue": 78.65439467524521}, "policy_reward_max": {"ue": 84.44650632996536}, "policy_reward_mean": {"ue": 82.73451319568117}, "custom_metrics": {"sum_utility_mean": 16.395756597267894, "sum_utility_min": 8.79708413849351, "sum_utility_max": 21.310345226162607, "eps_sum_utility_mean": 1667.915787692816, "eps_sum_utility_min": 1594.3982387310682, "eps_sum_utility_max": 1716.0818685226416}, "hist_stats": {"episode_reward": [165.7572104484102, 164.66829922172548, 165.42611295781995, 163.9038306831839, 163.13652903703627, 165.30619035670873, 165.29536041659975, 166.52222784010957, 164.63736924473744, 166.6239810717475, 164.659142506752, 165.78678434980515, 164.4750522362234, 165.9329550372118, 165.57158395074038, 164.96672654922025, 162.4969201079083, 167.17828355974916, 168.57966292176968, 166.31892946527773, 164.29389758180758, 166.93120339566417, 165.26745974034026, 166.35420024957835, 168.89301265993117, 167.94561572936885, 166.36645507806793, 163.16531068854022, 157.30878935049049, 163.62687084261233, 165.78642263125346, 166.65319325459097, 164.15231808150497, 163.9771391702214, 165.21070859978903, 164.73054328621595, 166.29405808974684, 161.74246969344426, 164.55011680672135, 164.38936168458264, 168.61097700927206, 164.37158042765537, 165.80206847902343, 163.13040162279134, 168.27764061602852, 163.8557433479084, 163.59236406239285, 168.66512577182692, 165.58559486269047, 165.0442547429289, 167.04753101852896, 166.98218884052227, 163.58636175082108, 167.07081500827604, 168.00173237961423, 164.98503997916708, 161.7697011140075, 164.15707567929496, 165.7873500273231, 166.60164213221486, 162.4788995837256, 168.10426894684844, 165.3990026796356, 167.0806998981705, 168.46550601635164, 163.7488029674227, 165.88832470818193, 166.42356793717096, 166.16423294459628, 164.04413218140132, 163.98975571726282, 164.50964600424567, 165.32564884080347, 167.4226273288695, 168.00173237961434, 165.2471549617095, 164.35135450531754, 163.53164731074844, 166.7947727548937, 165.06085037873083, 164.90255887980283, 163.70267171954129, 168.21137104195225, 168.05364522054208, 166.4592004400231, 165.78122261307817, 166.59551471797, 166.43308637069595, 167.83107471343635, 165.19375124543535, 163.8686092057104, 167.12092138988527, 165.29016039842458, 163.87250069832828, 164.73575920174443, 164.92403562744636, 163.9836283030179, 165.62256939559853, 167.14084205800208, 167.3394004004395], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_ue_reward": [82.87860522420489, 82.87860522420489, 82.33414961086255, 82.33414961086255, 82.71305647890982, 82.71305647890982, 81.95191534159176, 81.95191534159176, 81.568264518518, 81.568264518518, 82.65309517835416, 82.65309517835416, 82.64768020829976, 82.64768020829976, 83.26111392005464, 83.26111392005464, 82.3186846223685, 82.3186846223685, 83.31199053587362, 83.31199053587362, 82.32957125337587, 82.32957125337587, 82.89339217490244, 82.89339217490244, 82.23752611811152, 82.23752611811152, 82.96647751860567, 82.96647751860567, 82.78579197537003, 82.78579197537003, 82.48336327460999, 82.48336327460999, 81.24846005395402, 81.24846005395402, 83.58914177987437, 83.58914177987437, 84.28983146088468, 84.28983146088468, 83.15946473263875, 83.15946473263875, 82.14694879090365, 82.14694879090365, 83.46560169783187, 83.46560169783187, 82.63372987016996, 82.63372987016996, 83.17710012478891, 83.17710012478891, 84.44650632996536, 84.44650632996536, 83.97280786468417, 83.97280786468417, 83.18322753903377, 83.18322753903377, 81.58265534426995, 81.58265534426995, 78.65439467524521, 78.65439467524521, 81.81343542130598, 81.81343542130598, 82.89321131562659, 82.89321131562659, 83.32659662729533, 83.32659662729533, 82.07615904075237, 82.07615904075237, 81.98856958511053, 81.98856958511053, 82.6053542998943, 82.6053542998943, 82.36527164310775, 82.36527164310775, 83.14702904487316, 83.14702904487316, 80.8712348467219, 80.8712348467219, 82.2750584033605, 82.2750584033605, 82.19468084229119, 82.19468084229119, 84.30548850463582, 84.30548850463582, 82.18579021382754, 82.18579021382754, 82.90103423951155, 82.90103423951155, 81.56520081139561, 81.56520081139561, 84.13882030801405, 84.13882030801405, 81.92787167395399, 81.92787167395399, 81.79618203119621, 81.79618203119621, 84.3325628859132, 84.3325628859132, 82.79279743134511, 82.79279743134511, 82.52212737146426, 82.52212737146426, 83.5237655092643, 83.5237655092643, 83.49109442026094, 83.49109442026094, 81.79318087541036, 81.79318087541036, 83.53540750413777, 83.53540750413777, 84.00086618980696, 84.00086618980696, 82.49251998958334, 82.49251998958334, 80.2455500668249, 81.52415104718226, 82.87425409342183, 81.28282158587277, 82.8936750136614, 82.8936750136614, 83.30082106610729, 83.30082106610729, 81.23944979186258, 81.23944979186258, 84.05213447342403, 84.05213447342403, 82.69950133981754, 82.69950133981754, 83.54034994908507, 83.54034994908507, 84.2327530081756, 84.2327530081756, 81.87440148371115, 81.87440148371115, 82.94416235409084, 82.94416235409084, 83.21178396858527, 83.21178396858527, 83.08211647229791, 83.08211647229791, 82.02206609070039, 82.02206609070039, 81.99487785863123, 81.99487785863123, 82.25482300212269, 82.25482300212269, 82.66282442040152, 82.66282442040152, 83.71131366443457, 83.71131366443457, 84.00086618980694, 84.00086618980694, 82.62357748085455, 82.62357748085455, 82.17567725265867, 82.17567725265867, 81.76582365537404, 81.76582365537404, 83.39738637744662, 83.39738637744662, 82.53042518936526, 82.53042518936526, 82.45127943990124, 82.45127943990124, 81.85133585977049, 81.85133585977049, 84.10568552097588, 84.10568552097588, 84.02682261027081, 84.02682261027081, 83.22960022001132, 83.22960022001132, 82.89061130653899, 82.89061130653899, 83.29775735898487, 83.29775735898487, 83.2165431853478, 83.2165431853478, 83.91553735671802, 83.91553735671802, 82.59687562271746, 82.59687562271746, 81.93430460285508, 81.93430460285508, 83.56046069494252, 83.56046069494252, 82.64508019921212, 82.64508019921212, 81.936250349164, 81.936250349164, 82.36787960087197, 82.36787960087197, 82.46201781372291, 82.46201781372291, 81.9918141515088, 81.9918141515088, 82.8112846977991, 82.8112846977991, 83.5704210290008, 83.5704210290008, 83.66970020021952, 83.66970020021952]}, "sampler_perf": {"mean_env_wait_ms": 11.490594700010691, "mean_raw_obs_processing_ms": 0.515960153724282, "mean_inference_ms": 5.9791506943668855, "mean_action_processing_ms": 0.14281674264547067}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 196000, "timers": {"sample_time_ms": 4205.677, "sample_throughput": 951.095, "load_time_ms": 3.476, "load_throughput": 1150826.977, "learn_time_ms": 7873.947, "learn_throughput": 508.004, "update_time_ms": 23.838}, "info": {"learner": {"ue": {"cur_kl_coeff": 0.0011718750465661287, "cur_lr": 4.999999873689376e-05, "total_loss": 217.4261474609375, "policy_loss": -0.0016170389717444777, "vf_loss": 217.42776489257812, "vf_explained_var": 0.03205939009785652, "kl": 0.003947974648326635, "entropy": 0.3365967869758606, "entropy_coeff": 0.0, "model": {}}}, "num_steps_sampled": 196000, "num_steps_trained": 196000}, "done": false, "episodes_total": 1960, "training_iteration": 49, "experiment_id": "f0134eced79d425ca17ebe3d2d0a9c1b", "date": "2021-03-09_10-53-12", "timestamp": 1615283592, "time_this_iter_s": 12.444403171539307, "time_total_s": 563.4787082672119, "pid": 4108, "hostname": "ray02", "node_ip": "131.234.28.177", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "env_config": {"episode_length": 100, "seed": null, "map": "150x100map", "bs_list": ["A", "B"], "ue_list": ["1", "2"], "rand_episodes": false, "new_ue_interval": null, "reward": "sum", "log_metrics": true}, "env": "MultiAgentMobileEnv", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": true, "log_level": "WARN", "callbacks": "<class 'deepcomp.util.callbacks.CustomMetricCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"ue": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Dict(connected:MultiBinary(2), dr:Box(0.0, 1.0, (2,), float32), ues_at_bs:Box(0.0, 1.0, (2,), float32), utility:Box(-1.0, 1.0, (1,), float32))", "Discrete(3)", {}]}, "policy_mapping_fn": "<function create_env_config.<locals>.<lambda> at 0x7f6b553b7e50>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 563.4787082672119, "timesteps_since_restore": 0, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 24.81764705882353, "ram_util_percent": 4.8}, "trial_id": "e359b_00000"}
{"episode_reward_max": 168.89301265993117, "episode_reward_min": 157.30878935049049, "episode_reward_mean": 164.98606557231327, "episode_len_mean": 100.0, "episodes_this_iter": 40, "policy_reward_min": {"ue": 78.65439467524521}, "policy_reward_max": {"ue": 84.44650632996536}, "policy_reward_mean": {"ue": 82.49303278615645}, "custom_metrics": {"sum_utility_mean": 16.15543806905456, "sum_utility_min": -9.344827386918697, "sum_utility_max": 18.926298722075135, "eps_sum_utility_mean": 1660.6002967042584, "eps_sum_utility_min": 1594.3982387310682, "eps_sum_utility_max": 1692.7688830326006}, "hist_stats": {"episode_reward": [163.73828832504012, 165.16820285362616, 164.86878116909008, 162.64641661041452, 163.63767536273298, 165.4822296080655, 162.77350536060044, 165.5311131482648, 161.13543124177536, 164.1701821967573, 164.11616745117078, 163.95138681944604, 166.113247499738, 165.76593848386005, 163.36579263590477, 162.61831012337285, 163.52654775804348, 163.1914711786925, 164.15082720615862, 163.88778482754645, 167.26019898159547, 163.70575217891292, 160.4083907063162, 163.26465043357928, 168.21842585226653, 166.95428816426272, 166.0531053399066, 163.27643829322977, 167.27715633594892, 166.35420024957824, 164.12663567272762, 163.98195507788245, 164.6551169971661, 162.09421602707198, 163.82343885839725, 165.69799568464845, 165.25520491185046, 164.9693941313971, 165.01945218018562, 164.42641907581572, 164.90255887980283, 163.70267171954129, 168.21137104195225, 168.05364522054208, 166.4592004400231, 165.78122261307817, 166.59551471797, 166.43308637069595, 167.83107471343635, 165.19375124543535, 163.8686092057104, 167.12092138988527, 165.29016039842458, 163.87250069832828, 164.73575920174443, 164.92403562744636, 163.9836283030179, 165.62256939559853, 167.14084205800208, 167.3394004004395, 165.7572104484102, 164.66829922172548, 165.42611295781995, 163.9038306831839, 163.13652903703627, 165.30619035670873, 165.29536041659975, 166.52222784010957, 164.63736924473744, 166.6239810717475, 164.659142506752, 165.78678434980515, 164.4750522362234, 165.9329550372118, 165.57158395074038, 164.96672654922025, 162.4969201079083, 167.17828355974916, 168.57966292176968, 166.31892946527773, 164.29389758180758, 166.93120339566417, 165.26745974034026, 166.35420024957835, 168.89301265993117, 167.94561572936885, 166.36645507806793, 163.16531068854022, 157.30878935049049, 163.62687084261233, 165.78642263125346, 166.65319325459097, 164.15231808150497, 163.9771391702214, 165.21070859978903, 164.73054328621595, 166.29405808974684, 161.74246969344426, 164.55011680672135, 164.38936168458264], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_ue_reward": [81.8691441625199, 81.8691441625199, 82.58410142681288, 82.58410142681288, 82.43439058454481, 82.43439058454481, 81.32320830520725, 81.32320830520725, 81.81883768136635, 81.81883768136635, 82.74111480403259, 82.74111480403259, 81.38675268030018, 81.38675268030018, 82.7655565741322, 82.7655565741322, 81.3340949362146, 79.80133630556054, 82.0850910983785, 82.0850910983785, 82.05808372558515, 82.05808372558515, 81.97569340972287, 81.97569340972287, 83.05662374986885, 83.05662374986885, 82.88296924192989, 82.88296924192989, 81.6828963179522, 81.6828963179522, 81.30915506168627, 81.30915506168627, 81.76327387902151, 81.76327387902151, 81.59573558934615, 81.59573558934615, 82.07541360307913, 82.07541360307913, 81.9438924137731, 81.9438924137731, 83.6300994907975, 83.6300994907975, 81.85287608945632, 81.85287608945632, 79.40847909938348, 80.99991160693254, 81.63232521678948, 81.63232521678948, 84.10921292613311, 84.10921292613311, 83.47714408213113, 83.47714408213113, 83.0265526699531, 83.0265526699531, 81.63821914661477, 81.63821914661477, 83.63857816797436, 83.63857816797436, 83.17710012478892, 83.17710012478892, 82.06331783636374, 82.06331783636374, 81.99097753894105, 81.99097753894105, 82.32755849858289, 82.32755849858289, 81.04710801353593, 81.04710801353593, 81.91171942919846, 81.91171942919846, 82.84899784232394, 82.84899784232394, 82.62760245592511, 82.62760245592511, 82.48469706569838, 82.48469706569838, 82.50972609009264, 82.50972609009264, 82.21320953790766, 82.21320953790766, 82.45127943990124, 82.45127943990124, 81.85133585977049, 81.85133585977049, 84.10568552097588, 84.10568552097588, 84.02682261027081, 84.02682261027081, 83.22960022001132, 83.22960022001132, 82.89061130653899, 82.89061130653899, 83.29775735898487, 83.29775735898487, 83.2165431853478, 83.2165431853478, 83.91553735671802, 83.91553735671802, 82.59687562271746, 82.59687562271746, 81.93430460285508, 81.93430460285508, 83.56046069494252, 83.56046069494252, 82.64508019921212, 82.64508019921212, 81.936250349164, 81.936250349164, 82.36787960087197, 82.36787960087197, 82.46201781372291, 82.46201781372291, 81.9918141515088, 81.9918141515088, 82.8112846977991, 82.8112846977991, 83.5704210290008, 83.5704210290008, 83.66970020021952, 83.66970020021952, 82.87860522420489, 82.87860522420489, 82.33414961086255, 82.33414961086255, 82.71305647890982, 82.71305647890982, 81.95191534159176, 81.95191534159176, 81.568264518518, 81.568264518518, 82.65309517835416, 82.65309517835416, 82.64768020829976, 82.64768020829976, 83.26111392005464, 83.26111392005464, 82.3186846223685, 82.3186846223685, 83.31199053587362, 83.31199053587362, 82.32957125337587, 82.32957125337587, 82.89339217490244, 82.89339217490244, 82.23752611811152, 82.23752611811152, 82.96647751860567, 82.96647751860567, 82.78579197537003, 82.78579197537003, 82.48336327460999, 82.48336327460999, 81.24846005395402, 81.24846005395402, 83.58914177987437, 83.58914177987437, 84.28983146088468, 84.28983146088468, 83.15946473263875, 83.15946473263875, 82.14694879090365, 82.14694879090365, 83.46560169783187, 83.46560169783187, 82.63372987016996, 82.63372987016996, 83.17710012478891, 83.17710012478891, 84.44650632996536, 84.44650632996536, 83.97280786468417, 83.97280786468417, 83.18322753903377, 83.18322753903377, 81.58265534426995, 81.58265534426995, 78.65439467524521, 78.65439467524521, 81.81343542130598, 81.81343542130598, 82.89321131562659, 82.89321131562659, 83.32659662729533, 83.32659662729533, 82.07615904075237, 82.07615904075237, 81.98856958511053, 81.98856958511053, 82.6053542998943, 82.6053542998943, 82.36527164310775, 82.36527164310775, 83.14702904487316, 83.14702904487316, 80.8712348467219, 80.8712348467219, 82.2750584033605, 82.2750584033605, 82.19468084229119, 82.19468084229119]}, "sampler_perf": {"mean_env_wait_ms": 11.520098838872414, "mean_raw_obs_processing_ms": 0.5184853655881217, "mean_inference_ms": 5.997549304924219, "mean_action_processing_ms": 0.14335761625770488}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 200000, "timers": {"sample_time_ms": 4217.151, "sample_throughput": 948.508, "load_time_ms": 3.501, "load_throughput": 1142465.22, "learn_time_ms": 8165.306, "learn_throughput": 489.878, "update_time_ms": 24.11}, "info": {"learner": {"ue": {"cur_kl_coeff": 0.0005859375232830644, "cur_lr": 4.999999873689376e-05, "total_loss": 217.1962432861328, "policy_loss": -0.0022687993478029966, "vf_loss": 217.19851684570312, "vf_explained_var": 0.027323788031935692, "kl": 0.00715578394010663, "entropy": 0.2986185848712921, "entropy_coeff": 0.0, "model": {}}}, "num_steps_sampled": 200000, "num_steps_trained": 200000}, "done": true, "episodes_total": 2000, "training_iteration": 50, "experiment_id": "f0134eced79d425ca17ebe3d2d0a9c1b", "date": "2021-03-09_10-53-27", "timestamp": 1615283607, "time_this_iter_s": 15.157704830169678, "time_total_s": 578.6364130973816, "pid": 4108, "hostname": "ray02", "node_ip": "131.234.28.177", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "env_config": {"episode_length": 100, "seed": null, "map": "150x100map", "bs_list": ["A", "B"], "ue_list": ["1", "2"], "rand_episodes": false, "new_ue_interval": null, "reward": "sum", "log_metrics": true}, "env": "MultiAgentMobileEnv", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": true, "log_level": "WARN", "callbacks": "<class 'deepcomp.util.callbacks.CustomMetricCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"ue": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Dict(connected:MultiBinary(2), dr:Box(0.0, 1.0, (2,), float32), ues_at_bs:Box(0.0, 1.0, (2,), float32), utility:Box(-1.0, 1.0, (1,), float32))", "Discrete(3)", {}]}, "policy_mapping_fn": "<function create_env_config.<locals>.<lambda> at 0x7f6b553b7160>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 578.6364130973816, "timesteps_since_restore": 0, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 22.799999999999997, "ram_util_percent": 4.799999999999999}, "trial_id": "e359b_00000"}
